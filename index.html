<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Kirang Haerang:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="神秘的世界">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="神秘的世界">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>神秘的世界</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">神秘的世界</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/09/01/Git%E7%9A%84%E5%AD%A6%E4%B9%A0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="神秘的世界">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/09/01/Git%E7%9A%84%E5%AD%A6%E4%B9%A0/" class="post-title-link" itemprop="url">Git的学习</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-09-01 16:17:01" itemprop="dateCreated datePublished" datetime="2022-09-01T16:17:01+08:00">2022-09-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-09-03 23:55:57" itemprop="dateModified" datetime="2022-09-03T23:55:57+08:00">2022-09-03</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="一、版本控制"><a href="#一、版本控制" class="headerlink" title="一、版本控制"></a>一、版本控制</h1><p>版本控制最主要的功能就是追踪文件的变更。它将什么时候、什么人更改了文件的什么内容等信息忠实地了记录下来。每一次文件的改变，文件的版本号都将增加。除了记录版本变更外，版本控制的另一个重要功能是并行开发。<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/3448966?fromModule=lemma_inlink">软件开发</a>往往是多人协同作业，版本控制可以有效地解决版本的同步以及不同开发者之间的开发通信问题，提高协同开发的效率。并行开发中最常见的不同版本软件的错误(Bug)修正问题也可以通过版本控制中分支与合并的方法有效地解决。</p>
<p>具体来说，在每一项开发任务中，都需要首先设定开发基线，确定各个配置项的开发初始版本，在开发过程中，开发人员基于开发基线的版本，开发出所需的目标版本。当发生需求变更时，通过对变更的评估，确定变更的影响范围，对被影响的配置项的版本进行修改，根据变更的性质使配置项的版本树继续延伸或产生新的分支，形成新的目标版本，而对于不受变更影响的配置项则不应发产生变动。同时，应能够将变更所产生的对版本的影响进行记录和跟踪。必要时还可以回退到以前的版本。例如当开发需求或需求变更被取消时，就需要有能力将版本回退到开发基线版本。在曾经出现过的季度升级包拆包和重新组包的过程中，其实就是将部分配置项的版本回退到开发基线，将对应不同需求的不同分支重新组合归并，形成新的升级包版本。</p>
<p>版本控制是软件配置管理的核心功能。所有置于配置库中的元素都应自动予以版本的标识，并保证版本命名的唯一性。版本在生成过程中，自动依照设定的使用模型自动分支、演进。除了系统自动记录的版本信息以外，为了配合软件开发流程的各个阶段。还需要定义、收集一些元数据来记录版本的辅助信息和规范开发流程，并为今后对软件过程的度量做好准备。当然如果选用的工具支持，这些辅助数据将能直接统计出过程数据，从而方便软件过程改进活动的进行。对于配置库中的各个基线控制项，应该根据其基线的位置和状态来设置相应的访问权限。一般来说，对于基线版本之前的各个版本都应处于被锁定的状态，如需要对它们进行变更，则应按照变更控制的流程来进行操作。</p>
<h2 id="1-1-版本控制的三种方式"><a href="#1-1-版本控制的三种方式" class="headerlink" title="1.1 版本控制的三种方式"></a>1.1 版本控制的三种方式</h2><h3 id="本地版本控制"><a href="#本地版本控制" class="headerlink" title="本地版本控制"></a>本地版本控制</h3><p>本地版本控制就是把版本信息放在你的自己的电脑里，可以对每一个版本做一个<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E5%BF%AB%E7%85%A7&spm=1001.2101.3001.7020">快照</a>。</p>
<p>要使用的时候，在你自己计算机上获取就可以了</p>
<h3 id="集中版本控制"><a href="#集中版本控制" class="headerlink" title="集中版本控制"></a>集中版本控制</h3><p>a电脑和b电脑可以理解成俩个人，这种集中式版本管理，它的特点在于：</p>
<p>所有的版本信息都存放在server （服务器）上，需要使用的是时候，a和b 两台电脑去服务器里拿就可以了，开发者从服务器上同步更新和上传自己放人修改</p>
<p>客户机要与服务器通信， 又因为所有的东西都存放在服务器上，所以会对服务器产生极大的压力，如果服务器陷入瘫痪，客户机将无法从服务器上获取版本信息，所以有很大的风险</p>
<h3 id="分布式版本控制"><a href="#分布式版本控制" class="headerlink" title="分布式版本控制"></a>分布式版本控制</h3><p>三台主机互相连接。</p>
<p>a 电脑和b 电脑与server上的版本信息是一致的，而且它们三个的版本信息可以相互同步，始终的数据会保持一致。在上面的三台主机当中，有任何一台主机的数据丢失，其它主机都可以对它进行恢复，这是分布式管理的好处</p>
<h2 id="1-2-Git-和-SVN-的区别"><a href="#1-2-Git-和-SVN-的区别" class="headerlink" title="1.2 Git 和 SVN 的区别"></a>1.2 Git 和 SVN 的区别</h2><p>Git 是发布式管理，SVN 是集中式管理</p>
<h1 id="二、Git-的环境配置"><a href="#二、Git-的环境配置" class="headerlink" title="二、Git 的环境配置"></a>二、Git 的环境配置</h1><p>配置用户名 和 配置邮箱</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 配置用户名</span><br><span class="line">git config --global user.name ``&quot;username&quot;`  `//（ &quot;username&quot;是自己的账户名，）</span><br><span class="line"># 配置邮箱</span><br><span class="line">git config --global user.email &quot;username@email.com&quot;  //(&quot;username@email.com&quot;注册账号时用的邮箱)</span><br></pre></td></tr></table></figure>



<p>生成 ssh</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa</span><br></pre></td></tr></table></figure>



<p>查看用户设置的配置</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --global --list</span><br></pre></td></tr></table></figure>



<p>查看系统配置</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --system --list</span><br></pre></td></tr></table></figure>



<h1 id="三、Git-的工作原理"><a href="#三、Git-的工作原理" class="headerlink" title="三、Git 的工作原理"></a>三、Git 的工作原理</h1><h2 id="3-1-Git-的工作区域"><a href="#3-1-Git-的工作区域" class="headerlink" title="3.1 Git 的工作区域"></a>3.1 Git 的工作区域</h2><p>大致可以分为 四个工作区域 ： Git 远程仓库 、 工作目录 、 暂存区 、 资源库</p>
<ul>
<li>Workspace：<strong>工作目录</strong>，就是你平时存放项目代码的地方</li>
<li>Repository：<strong>资源库</strong>（或本地仓库），就是安全存放数据的位置，这里面有你提交到所有版本的数据。其中HEAD指向最新放入仓库的版本</li>
<li>Index / Stage：<strong>暂存区</strong>，用于临时存放你的改动，事实上它只是一个文件，保存即将提交到文件列表信息</li>
<li>Remote：<strong>远程仓库</strong>，托管代码的服务器，可以简单的认为是你项目组中的一台电脑用于远程数据交换</li>
</ul>
<h2 id="3-2-Git-的工作流程"><a href="#3-2-Git-的工作流程" class="headerlink" title="3.2 Git 的工作流程"></a>3.2 Git 的工作流程</h2><ol>
<li>在工作目录中添加、修改、删除文件(modified)；</li>
<li>将需要进行版本管理的文件放入暂存区(staged)；</li>
<li>将暂存区域的文件提交git仓库(committed)；</li>
<li>将本地git仓库修改推送到远程仓库；因此，git管理的文件有三种状态：已修改(modified)、已暂存(staged)、已提交(committed)。</li>
</ol>
<h2 id="3-3-Git-的文件状态"><a href="#3-3-Git-的文件状态" class="headerlink" title="3.3 Git 的文件状态"></a>3.3 Git 的文件状态</h2><ol>
<li> <strong>untrack 未跟踪</strong> 当一个git项目当中新建了文件的时候，如果你用 <em>git status</em> 命令去查看 git 当中的状态，就会看到系统会提示你有些文件状态是 untrack。</li>
<li><strong>modified 被修改</strong> 当一个git项目中的被登记在案的文件在近期被修改后，这个文件的状态就会变成 modified 代表这个文件最近被修改过。如果你用 <em>git status</em> 命令去查看 git 当中的状态，就会看到系统会提示你有些文件状态是 modified 。</li>
<li><strong>staged 暂存</strong> 就是说我们把所有的改动都记录下来了，现在git系统当中记录的已经是这个文件最新的状态了。当我们创建了新的文件，或者是有了新的改动，执行git add之后，得到的状态就是staged。这个时候当我们执行git status，就会看到我们当下创建和更新了哪些文件。注意在所有的改动都暂存的情况下，git status是不会出现红色的提示的，只会有绿色的提示信息。</li>
<li><strong>committed 被提交</strong> 这个committed表示的已提交。前面说了staged只是暂存，还没有真正提交进git系统当中。只有通过命令git commit之后，<strong>才算是真正把暂存区的代码提交了</strong>。经过git commit命令之后，所有被提交的文件的状态就是committed。</li>
</ol>
<h1 id="四、Git-的项目搭建"><a href="#四、Git-的项目搭建" class="headerlink" title="四、Git 的项目搭建"></a>四、Git 的项目搭建</h1><p>初始化项目（会生成一个隐藏文件），在目标文件夹下执行 Git ，输入下方的命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git init</span><br></pre></td></tr></table></figure>



<p>克隆远程仓库（需要从 Gitee 或者 GitHub 上面获取对应项目的 URL ）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone url</span><br></pre></td></tr></table></figure>



<p>设置 SSH 公钥</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa // -t rsa 代表使用 rsa 加密算法来生成公钥</span><br></pre></td></tr></table></figure>



<h2 id="4-1-Git-的分支"><a href="#4-1-Git-的分支" class="headerlink" title="4.1 Git 的分支"></a>4.1 Git 的分支</h2><p>查看 Git 分支</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch</span><br></pre></td></tr></table></figure>



<p>查看 Git 远程分支</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch -r</span><br></pre></td></tr></table></figure>



<p>构建一个新的分支，但停留在当前分支</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch 【name】</span><br></pre></td></tr></table></figure>



<p>构建一个新的分支，并切换至该分支</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git checkout -b 【name】</span><br></pre></td></tr></table></figure>



<p>分支的合并，当两个或以上的开发者同时修改了一段代码时，会出现代码的冲突。此时就需要选择合并代码分支</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git merge 【name】</span><br></pre></td></tr></table></figure>



<p>切换分支</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git checkout 【name】</span><br></pre></td></tr></table></figure>



<p>将创建的分支 push 到远端</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push --set-upstream origin 【name】</span><br></pre></td></tr></table></figure>



<p>删除本地分支</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch -d 【name】</span><br></pre></td></tr></table></figure>



<p>删除远端分支</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git push origin --delete 【name】</span><br><span class="line">git branch -dr 【name】</span><br></pre></td></tr></table></figure>



<p>将远程指定分支 拉取到 本地指定分支上</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git pull origin &lt;远程分支名&gt;:&lt;本地分支名&gt;</span><br></pre></td></tr></table></figure>



<p>将远程指定分支 拉取到 本地当前分支上</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git pull origin &lt;远程分支名&gt;</span><br></pre></td></tr></table></figure>



<h1 id="Git-命令"><a href="#Git-命令" class="headerlink" title="Git 命令"></a>Git 命令</h1><p>将文件状态的未跟踪的文件登录在案（ 由工作目录上传到暂存区 ）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git add .</span><br></pre></td></tr></table></figure>



<p>将代码提交保存（由暂存区上传至本地仓库）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git commit -m  &quot;&quot; // -m “” 使用后，会同步上传“”中的信息</span><br></pre></td></tr></table></figure>



<p>拉取分支后，对本地进行保存</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git stash</span><br></pre></td></tr></table></figure>

<p>保存后，拉取的代码才会被更新</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/07/30/SpringBoot-%E7%9A%84%E5%AD%A6%E4%B9%A0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="神秘的世界">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/07/30/SpringBoot-%E7%9A%84%E5%AD%A6%E4%B9%A0/" class="post-title-link" itemprop="url">SpringBoot 的学习</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-07-30 09:51:06" itemprop="dateCreated datePublished" datetime="2022-07-30T09:51:06+08:00">2022-07-30</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-09-08 23:26:02" itemprop="dateModified" datetime="2022-09-08T23:26:02+08:00">2022-09-08</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="一、什么是SpringBoot"><a href="#一、什么是SpringBoot" class="headerlink" title="一、什么是SpringBoot"></a>一、什么是SpringBoot</h1><p>SpringBoot 属于 Java平台上的一种开源应用框架。</p>
<p>Spring Boot是由Pivotal团队提供的全新<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E6%A1%86%E6%9E%B6/1212667">框架</a>，其设计目的是用来<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E7%AE%80%E5%8C%96/3374416">简化</a>新<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/Spring/85061">Spring</a>应用的初始搭建以及开发过程。</p>
<p>该框架使用了特定的方式来进行配置，从而使开发人员不再需要定义样板化的配置。</p>
<p>通过这种方式，Spring Boot致力于在蓬勃发展的快速应用开发领域(rapid application development)成为领导者 – 摘自百度百科</p>
<h2 id="Spring-框架"><a href="#Spring-框架" class="headerlink" title="Spring 框架"></a>Spring 框架</h2><p>Spring框架是<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/Java%E5%B9%B3%E5%8F%B0/3793459">Java平台</a>上的一种开源应用框架，提供具有控制反转特性的容器。</p>
<p>尽管Spring框架自身对编程模型没有限制，但其在Java应用中的频繁使用让它备受青睐。</p>
<p>以至于后来让它作为 <a target="_blank" rel="noopener" href="https://baike.baidu.com/item/EJB/144195">EJB</a>（EnterpriseJavaBeans）模型的补充，甚至是替补。</p>
<p>Spring框架为开发提供了一系列的解决方案，比如利用控制反转的核心特性，并通过依赖注入实现控制反转来实现管理对象生命周期容器化，利用面向切面编程进行声明式的事务管理，整合多种持久化技术管理数据访问，提供大量优秀的Web框架方便开发等等。</p>
<p>Spring框架具有控制反转（IOC）特性，IOC旨在方便项目维护和测试，它提供了一种通过Java的反射机制对Java对象进行统一的配置和管理的方法。</p>
<p>Spring框架利用容器管理对象的生命周期，容器可以通过扫描XML文件或类上特定Java注解来配置对象，开发者可以通过依赖查找或依赖注入来获得对象。Spring框架具有<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E9%9D%A2%E5%90%91%E5%88%87%E9%9D%A2%E7%BC%96%E7%A8%8B/6016335">面向切面编程</a>（AOP）框架，SpringAOP框架基于代理模式，同时运行时可配置；</p>
<p>AOP框架主要针对模块之间的交叉关注点进行模块化。Spring框架的AOP框架仅提供基本的AOP特性，虽无法与AspectJ框架相比，但通过与AspectJ的集成，也可以满足基本需求。</p>
<h2 id="SpringBoot-的出现"><a href="#SpringBoot-的出现" class="headerlink" title="SpringBoot 的出现"></a>SpringBoot 的出现</h2><p>由于 SSM 框架日渐增长的配置，为了简化配置，出现了 SpingBoot。</p>
<p>不仅继承了Spring框架原有的优秀特性，而且还通过简化配置来进一步简化了Spring应用的整个搭建和开发过程。</p>
<p>另外SpringBoot通过集成大量的框架使得依赖包的版本冲突，以及引用的不稳定性等问题得到了很好的解决。 </p>
<h2 id="SpringBoot-的优点"><a href="#SpringBoot-的优点" class="headerlink" title="SpringBoot 的优点"></a>SpringBoot 的优点</h2><ul>
<li>为所有的Spring开发者提供更快的入门方式</li>
<li>开箱即用，提供各种默认配置来简化项目配置</li>
<li>内嵌式容器简化 Web 项目</li>
<li>没有冗余代码生成和 XML 配置</li>
</ul>
<h2 id="微服务"><a href="#微服务" class="headerlink" title="微服务"></a>微服务</h2><p>一种软件开发技术- 面向服务的体系结构（SOA）架构样式的一种变体。</p>
<p>它提倡将单一应用程序划分成一组小的服务，服务之间互相协调、互相配合，为用户提供最终价值。</p>
<p>每个服务运行在其独立的进程中，服务与服务间采用轻量级的通信机制互相沟通（通常是基于HTTP的RESTful API）。</p>
<p>每个服务都围绕着具体业务进行构建，并且能够独立地部署到生产环境、类生产环境等。另外，应尽量避免统一的、集中式的服务管理机制，对具体的一个服务而言，应根据上下文，选择合适的语言、工具对其进行构建。</p>
<h1 id="二、第一个-SpringBoot-程序"><a href="#二、第一个-SpringBoot-程序" class="headerlink" title="二、第一个 SpringBoot 程序"></a>二、第一个 SpringBoot 程序</h1><p>首先，我们需要创建一个基于 SpringBoot 的项目，在创建项目后在 pom.xml 文件中添加下面的代码，也就是 SpringBoot 内嵌 tomcat 的启动器：</p>
<figure class="highlight xml"><figcaption><span><dependency></dependency></span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在加入了 web 启动器之后，我们就可以使用 SpringBoot 内嵌的 tomcat 来进行开发。</p>
<p>书写程序时，我们需要在 SpringBootStudyDemoApplication 的同级下创建包，这样就可以使用内嵌的 tomcat 来书写程序。</p>
<p>对于 SpringBoot 的启动类而言，通过源码可以看出，这个类就是一个 Spring 的组件。</p>
<h2 id="修改启动端口"><a href="#修改启动端口" class="headerlink" title="修改启动端口"></a>修改启动端口</h2><p>修改启动端口，需要在 resources 目录下的 application.properties 文件中进行修改，在文件中写入以下代码：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">server.port=8081</span><br></pre></td></tr></table></figure>



<h2 id="修改启动动画（-Banner-）"><a href="#修改启动动画（-Banner-）" class="headerlink" title="修改启动动画（ Banner ）"></a>修改启动动画（ Banner ）</h2><p>首先要在 resources 目录下创建 banner.txt 文件，然后粘入自定义的 Banner 样式，这里以佛祖为例子 ：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">————————————————————————————————————————————————————————————————————</span><br><span class="line">//                          _ooOoo_                               //</span><br><span class="line">//                         o8888888o                              //</span><br><span class="line">//                         88&quot; . &quot;88                              //</span><br><span class="line">//                         (| ^_^ |)                              //</span><br><span class="line">//                         O  =  /O                              //</span><br><span class="line">//                      ____/`---&#x27;\____                           //</span><br><span class="line">//                    .&#x27;  \|     |//  `.                         //</span><br><span class="line">//                   /  \|||  :  |||//                          //</span><br><span class="line">//                  /  _||||| -:- |||||-                         //</span><br><span class="line">//                  |   | \  -  /// |   |                       //</span><br><span class="line">//                  | \_|  &#x27;&#x27;---/&#x27;&#x27;  |   |                       //</span><br><span class="line">//                    .-\__  `-`  ___/-. /                       //</span><br><span class="line">//                ___`. .&#x27;  /--.--  `. . ___                     //</span><br><span class="line">//              .&quot;&quot; &#x27;&lt;  `.___\_&lt;|&gt;_/___.&#x27;  &gt;&#x27;&quot;&quot;.                  //</span><br><span class="line">//            | | :  `- \`.;` _ /`;.`/ - ` : | |                 //</span><br><span class="line">//               `-.   \_ __ /__ _/   .-` /  /                 //</span><br><span class="line">//      ========`-.____`-.___\_____/___.-`____.-&#x27;========         //</span><br><span class="line">//                           `=---=&#x27;                              //</span><br><span class="line">//      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^        //</span><br><span class="line">//            佛祖保佑       永不宕机     永无BUG                  //</span><br><span class="line">————————————————————————————————————————————————————————————————————</span><br></pre></td></tr></table></figure>



<h1 id="三、SpringBoot-的自动装配原理"><a href="#三、SpringBoot-的自动装配原理" class="headerlink" title="三、SpringBoot 的自动装配原理"></a>三、SpringBoot 的自动装配原理</h1><h2 id="3-1-pom-xml-文件"><a href="#3-1-pom-xml-文件" class="headerlink" title="3.1 pom.xml 文件"></a>3.1 pom.xml 文件</h2><p>在 pom.xml 文件中有一部分的代码，负责控制代码中导入 jar 包的版本</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.7.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">relativePath</span>/&gt;</span> <span class="comment">&lt;!-- lookup parent from repository --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>我们在使用一些 Jar 包时，不需要填入版本，就是因为版本在上方的父工程中已经配置了版本</p>
<h2 id="3-2-启动器"><a href="#3-2-启动器" class="headerlink" title="3.2 启动器"></a>3.2 启动器</h2><p>启动器是 SpringBoot 的启动场景。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>SpringBoot 会将场景，变成一个个启动器，比如 spring-boot-starter-web 就会自动帮助我们导入 web 场景依赖</p>
<p>如果我们需要使用什么功能，就只需要使用对应的启动器即可</p>
<h2 id="3-3-结论"><a href="#3-3-结论" class="headerlink" title="3.3 结论"></a>3.3 结论</h2><ol>
<li>SpringBoot 在启动的时候，从类路径下获取指定的值</li>
<li>将自动配置的类导入容器，自动配置就会生效</li>
<li>以前需要配置的东西，现在由 SpringBoot 来完成</li>
<li>整合 JavaEE，解决方案和自动装配的东西都在 spring-boot-autoconfigure 的包下</li>
<li>她会导入所有需要的组件，以类名的方式返回，这些组件就会被添加到容器</li>
<li>容器中也会存在非常多的 xxxAutoConfiguration 的文件，就是这些类给容器中导入了这个场景需要的所有组件</li>
</ol>
<h1 id="四、SpringBoot配置"><a href="#四、SpringBoot配置" class="headerlink" title="四、SpringBoot配置"></a>四、SpringBoot配置</h1><p>官方推荐使用 yaml 文件作为 SpringBoot 的配置文件，文件名为 application.yaml ，在 IDEA 中新建即可，若出现叶子图标，即为创建成功</p>
<h2 id="4-1-yaml"><a href="#4-1-yaml" class="headerlink" title="4.1 yaml"></a>4.1 yaml</h2><p>和 properties 文件不同，yaml 文件的书写格式是 （ 以修改端口号为例子 ）：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span> 			<span class="comment"># 父级目录</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8081</span>		<span class="comment"># 子级属性 key ： value（这里 value 的值前有一个空格）</span></span><br></pre></td></tr></table></figure>



<p>yaml 对空格十分敏感，因此在书写 yaml 文件时，需要时刻注意空格是否多打</p>
<p>yaml 除了存储键值对外，还可以存储 对象 和 数组：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"># 存储对象 方式一</span><br><span class="line"># 对象名：</span><br><span class="line">#	对象属性： 值</span><br><span class="line">studentOne: </span><br><span class="line">  name: studentName</span><br><span class="line">  age: 18</span><br><span class="line"></span><br><span class="line"># 存储对象 方式二</span><br><span class="line"># 对象名：&#123; 对象属性： 值 &#125;</span><br><span class="line">studentTwo: &#123; name: studentName, age: 18 &#125;</span><br><span class="line"></span><br><span class="line"># 存储数组 方式一</span><br><span class="line">studentOne:</span><br><span class="line">  -one :</span><br><span class="line">    name: studentName</span><br><span class="line">    age: 18</span><br><span class="line">  </span><br><span class="line">  -two :</span><br><span class="line">    name: studentName</span><br><span class="line">    age: 18</span><br><span class="line"></span><br><span class="line"># 存储数组 方式二</span><br><span class="line">studentTwo: [ &#123; name: studentName, age: 18 &#125;, &#123; name: studentName, age: 19 &#125; ]</span><br></pre></td></tr></table></figure>



<h2 id="4-2-yaml-向类中注入值"><a href="#4-2-yaml-向类中注入值" class="headerlink" title="4.2 yaml 向类中注入值"></a>4.2 yaml 向类中注入值</h2><p>yaml 文件支持向实体类中注入值，这需要用到 @ConfigurationProperties 注解</p>
<p>实体类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Component(&quot;DogOne&quot;)</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;dog&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Dog</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String code;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> HashMap&lt; Integer, Object &gt; map;</span><br><span class="line">    <span class="keyword">private</span> ArrayList&lt; Object &gt; list;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>yaml文件</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">dog:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">wangcai</span></span><br><span class="line">  <span class="attr">code:</span> <span class="number">1</span></span><br><span class="line">  <span class="attr">map:</span> &#123; <span class="attr">1:</span> <span class="string">aa</span> , <span class="attr">2:</span> <span class="string">bb</span> &#125;</span><br><span class="line">  <span class="attr">list:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="number">1</span></span><br><span class="line">    <span class="bullet">-</span> <span class="number">2</span></span><br><span class="line">    <span class="bullet">-</span> <span class="number">3</span></span><br></pre></td></tr></table></figure>

<p>我们需要使用 @ConfigurationProperties 来绑定 yaml 文件和 实体类之间的联系，绑定之后，就可以在测试类中进行测试了</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SpringBootStudyDemoApplicationTests</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="meta">@Qualifier(&quot;DogOne&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Dog dog;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">contextLoads</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(dog.toString());</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>另外，为了处理爆红，可以加入以下依赖：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-configuration-processor<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="4-3-JSR303校验"><a href="#4-3-JSR303校验" class="headerlink" title="4.3 JSR303校验"></a>4.3 JSR303校验</h2><p>JSR303 数据校验，这个就是我们可以在字段是增加一层过滤器验证，可以保证数据的合法性</p>
<p>要使用 JSR303 数据校验，需要提前在对应类中加上 @Validated 注解</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Component(&quot;DogOne&quot;)</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;dog&quot;)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Validated</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Dog</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotNull(message = &quot;姓名不能为空&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String code;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> HashMap&lt; Integer, Object &gt; map;</span><br><span class="line">    <span class="keyword">private</span> ArrayList&lt; Object &gt; list;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在加上了 @Validated 注解后，就可以使用 JSR303 校验相关的注解了，如 @NotNull 代表对应的字段不能为空，其中，message 属性表示 当对应的属性为空时，报告的错误内容</p>
<p>除此之外还有许多和校验有关的注解：</p>
<p><img src="/2022/07/30/SpringBoot-%E7%9A%84%E5%AD%A6%E4%B9%A0/20200525161753312.png"></p>
<h2 id="4-4-多套环境的配置和切换"><a href="#4-4-多套环境的配置和切换" class="headerlink" title="4.4 多套环境的配置和切换"></a>4.4 多套环境的配置和切换</h2><p>多套环境的切换需要提前配置多套 application 文件</p>
<p>后面用 - 来标注环境的作用，如开发环境 application-dev，测试环境 application-test，或者使用下方代码来命名环境：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">dev</span></span><br></pre></td></tr></table></figure>

<p>通过下方的代码来完成不同环境间的切换：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">profiles:</span></span><br><span class="line">    <span class="attr">active:</span> <span class="string">dev</span></span><br></pre></td></tr></table></figure>

<p>上方的代码代表将环境切换至 dev 环境</p>
<h1 id="五、Web-开发-和-静态资源的导入"><a href="#五、Web-开发-和-静态资源的导入" class="headerlink" title="五、Web 开发 和 静态资源的导入"></a>五、Web 开发 和 静态资源的导入</h1><p>在创建 SpringBoot 项目时，需要勾选 Web 选项</p>
<h2 id="5-1-导入静态资源"><a href="#5-1-导入静态资源" class="headerlink" title="5.1 导入静态资源"></a>5.1 导入静态资源</h2><p>要在 SpringBoot 中导入静态资源，可以看看其相应的配置源码 ： WebMvcAutoConfiguration</p>
<p>在这个类中，定义了有关 SpringBoot 的静态资源的导入的有关方式，比如：</p>
<p> 启用过滤器 : 在 yaml 文件中设置属性 spring.mvc.hiddenmethod.filter = true</p>
<p>书回正题，在 WebMvcAutoConfiguration 中我们可以找到这个函数 ：WebMvcAutoConfigurationAdapter</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">WebMvcAutoConfigurationAdapter</span><span class="params">(WebProperties webProperties, WebMvcProperties mvcProperties, ListableBeanFactory beanFactory, ObjectProvider&lt;HttpMessageConverters&gt; messageConvertersProvider, ObjectProvider&lt;WebMvcAutoConfiguration.ResourceHandlerRegistrationCustomizer&gt; resourceHandlerRegistrationCustomizerProvider, ObjectProvider&lt;DispatcherServletPath&gt; dispatcherServletPath, ObjectProvider&lt;ServletRegistrationBean&lt;?&gt;&gt; servletRegistrations)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.resourceProperties = webProperties.getResources();</span><br><span class="line">    <span class="keyword">this</span>.mvcProperties = mvcProperties;</span><br><span class="line">    <span class="keyword">this</span>.beanFactory = beanFactory;</span><br><span class="line">    <span class="keyword">this</span>.messageConvertersProvider = messageConvertersProvider;</span><br><span class="line">    <span class="keyword">this</span>.resourceHandlerRegistrationCustomizer = (WebMvcAutoConfiguration.ResourceHandlerRegistrationCustomizer)resourceHandlerRegistrationCustomizerProvider.getIfAvailable();</span><br><span class="line">    <span class="keyword">this</span>.dispatcherServletPath = dispatcherServletPath;</span><br><span class="line">    <span class="keyword">this</span>.servletRegistrations = servletRegistrations;</span><br><span class="line">    <span class="keyword">this</span>.mvcProperties.checkConfiguration();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在其中，我们点入WebProperties 下的类，就可以看见一些不一样的东西：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String[] CLASSPATH_RESOURCE_LOCATIONS = <span class="keyword">new</span> String[]&#123;</span><br><span class="line">			 <span class="string">&quot;classpath:/META-INF/resources/&quot;</span>, </span><br><span class="line">			 <span class="string">&quot;classpath:/resources/&quot;</span>, </span><br><span class="line">			 <span class="string">&quot;classpath:/static/&quot;</span>, </span><br><span class="line">			 <span class="string">&quot;classpath:/public/&quot;</span></span><br><span class="line">&#125;;</span><br><span class="line">     </span><br></pre></td></tr></table></figure>

<p>可以看见，SpringBoot 对静态资源早有设置，只要静态资源在这四个目录下，就都可以被 SpringBoot 识别</p>
<p>另外，通过源码的排序可以猜测出，若四个目录下同时存在同名文件，访问顺序为 ： </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/META-INF/resources &gt; resources &gt; static &gt; public</span><br></pre></td></tr></table></figure>



<h2 id="5-2-关于首页的定制"><a href="#5-2-关于首页的定制" class="headerlink" title="5.2 关于首页的定制"></a>5.2 关于首页的定制</h2><p>关于 index 的生成和定制</p>
<p>同样我们可以在 WebMvcAutoConfiguration 中找到相关的函数 getIndexHtml 和 WelcomePageHandlerMapping</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> Resource <span class="title">getIndexHtml</span><span class="params">(Resource location)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        Resource resource = location.createRelative(<span class="string">&quot;index.html&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (resource.exists() &amp;&amp; resource.getURL() != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> resource;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception var3) &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> WelcomePageHandlerMapping <span class="title">welcomePageHandlerMapping</span><span class="params">(ApplicationContext applicationContext, FormattingConversionService mvcConversionService, ResourceUrlProvider mvcResourceUrlProvider)</span> </span>&#123;</span><br><span class="line">    WelcomePageHandlerMapping welcomePageHandlerMapping = <span class="keyword">new</span> WelcomePageHandlerMapping(<span class="keyword">new</span> TemplateAvailabilityProviders(applicationContext), applicationContext, <span class="keyword">this</span>.getWelcomePage(), <span class="keyword">this</span>.mvcProperties.getStaticPathPattern());</span><br><span class="line">    welcomePageHandlerMapping.setInterceptors(<span class="keyword">this</span>.getInterceptors(mvcConversionService, mvcResourceUrlProvider));</span><br><span class="line">    welcomePageHandlerMapping.setCorsConfigurations(<span class="keyword">this</span>.getCorsConfigurations());</span><br><span class="line">    <span class="keyword">return</span> welcomePageHandlerMapping;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里由于展不开源码，导致不好阅读，可以在 IDEA 中去阅读源码</p>
<p>这两段代码说明，首页的读取会选择在之前的四个目录下的任意目录中的名为 “ index.jsp ” 的文件来作为首页启动 </p>
<h1 id="六、thymeleaf-模板引擎"><a href="#六、thymeleaf-模板引擎" class="headerlink" title="六、thymeleaf 模板引擎"></a>六、thymeleaf 模板引擎</h1><p> SpringBoot默认不支持JSP，因为jsp相对于一些<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E&spm=1001.2101.3001.7020">模板引擎</a>，性能都比较低，官方推荐使用thymeleaf</p>
<p> Thymeleaf 是一个 Java 模板引擎开发库，可以处理和生成 HTML、<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=XML&spm=1001.2101.3001.7020">XML</a>、JavaScript、CSS 和 文本 ，在 Web 和非 Web 环境下都可以正常工作</p>
<h2 id="6-1-模板引擎"><a href="#6-1-模板引擎" class="headerlink" title="6.1 模板引擎"></a>6.1 模板引擎</h2><p>模板引擎（这里特指用于Web开发的模板引擎）是为了使用户界面与业务数据（内容）分离而产生的</p>
<p>它可以生成特定格式的文档，用于网站的模板引擎就会生成一个标准的<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/HTML/97049?fromModule=lemma_inlink">HTML</a>文档</p>
<h2 id="6-2-Thymeleaf-的分析"><a href="#6-2-Thymeleaf-的分析" class="headerlink" title="6.2 Thymeleaf 的分析"></a>6.2 Thymeleaf 的分析</h2><p>要注意的是，Thymeleaf 应该是 3.0 以上的版本，否则我们的程序都无法正常运行</p>
<p>打开 IDEA 搜索 Thymeleaf 对应的配置类 ThymeleafProperties 我们可以看到以下代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DEFAULT_PREFIX = <span class="string">&quot;classpath:/templates/&quot;</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DEFAULT_SUFFIX = <span class="string">&quot;.html&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> String prefix = <span class="string">&quot;classpath:/templates/&quot;</span>;</span><br><span class="line"><span class="keyword">private</span> String suffix = <span class="string">&quot;.html&quot;</span>;</span><br><span class="line"><span class="keyword">private</span> String mode = <span class="string">&quot;HTML&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>这是标准的前后缀设置，这意味着，在 templates 目录下的  .html 文件都会被 Thymeleaf 识别分析</p>
<h2 id="6-3-Thymeleaf-表达式"><a href="#6-3-Thymeleaf-表达式" class="headerlink" title="6.3 Thymeleaf 表达式"></a>6.3 Thymeleaf 表达式</h2><p>如果想用 Thymeleaf 来完成前后端的交互，比如传值等操作的话，需要在前端页面导入相关的依赖：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xmlns:th=&quot;http://www.thymeleaf.org&quot;</span><br></pre></td></tr></table></figure>

<p>然后就可以使用 Thymeleaf 表达式，常见的 Thymeleaf 表达式有以下这些：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;a th:href=&quot;@&#123;/user/login&#125;&quot;&gt;&lt;/a&gt;</span><br><span class="line"> </span><br><span class="line">&lt;a th:src=&quot;@&#123;/user/login&#125;&quot;/&gt;</span><br><span class="line"></span><br><span class="line">&lt;div th:text=&quot;#&#123;user&#125;&quot;&gt; &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;div th:each=&quot;value: $&#123;msg&#125;&quot; th:text=&quot;$&#123;value&#125;&quot; &gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;p&gt;Name: &lt;span th: text=&quot; *&#123;firstName&#125;&quot; &gt;Sebastian&lt;/span&gt;. &lt;/p&gt;</span><br><span class="line"> </span><br><span class="line">&lt;p&gt;Surname: &lt;span th: text=&quot; *&#123;lastName&#125;&quot; &gt;Pepper&lt;/span&gt;. &lt;/p&gt;</span><br></pre></td></tr></table></figure>



<h2 id="6-4-Thymeleaf-语法"><a href="#6-4-Thymeleaf-语法" class="headerlink" title="6.4 Thymeleaf 语法"></a>6.4 Thymeleaf 语法</h2><h3 id="6-4-1-Thymeleaf-的常用属性解读"><a href="#6-4-1-Thymeleaf-的常用属性解读" class="headerlink" title="6.4.1 Thymeleaf 的常用属性解读"></a>6.4.1 Thymeleaf 的常用属性解读</h3><p>html有的属性，Thymeleaf基本都有，而常用的属性大概有七八个</p>
<p>其中th属性执行的优先级从1~8，数字越低优先级越高</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">一、th:text ：设置当前元素的文本内容，相同功能的还有th:utext，两者的区别在于前者不会转义html标签，后者会。优先级不高：</span><br><span class="line">order=7</span><br><span class="line"></span><br><span class="line">二、th:value：设置当前元素的value值，类似修改指定属性的还有th:src，th:href。优先级不高：order=6</span><br><span class="line"></span><br><span class="line">三、th:each：遍历循环元素，和th:text或th:value一起使用。注意该属性修饰的标签位置，详细往后看。优先级很高：order=2</span><br><span class="line"></span><br><span class="line">四、th:if：条件判断，类似的还有th:unless，th:switch，th:case。优先级较高：order=3</span><br><span class="line"></span><br><span class="line">五、th:insert：代码块引入，类似的还有th:replace，th:include，三者的区别较大，若使用不恰当会破坏html结构，常用于公共代码块提取的场景。优先级最高：order=1</span><br><span class="line"></span><br><span class="line">六、th:fragment：定义代码块，方便被th:insert引用。优先级最低：order=8</span><br><span class="line"></span><br><span class="line">七、th:object：声明变量，一般和*&#123;&#125;一起配合使用，达到偷懒的效果。优先级一般：order=4</span><br><span class="line"></span><br><span class="line">八、th:attr：修改任意属性，实际开发中用的较少，因为有丰富的其他th属性帮忙，类似的还有th:attrappend，th:attrprepend。优先级一般：order=5</span><br></pre></td></tr></table></figure>



<h3 id="6-4-2-Thymeleaf-的基本语法"><a href="#6-4-2-Thymeleaf-的基本语法" class="headerlink" title="6.4.2 Thymeleaf 的基本语法"></a>6.4.2 Thymeleaf 的基本语法</h3><p><strong>标准表达式语法</strong><br>${…} 变量表达式 Variable Expressions<br>*{…} 选择变量表达式 Selection Variable Expressions<br>#{…} 消息表达式 Message Expressions<br>@{…} 链接url表达式 Link URL Expressions<br>~{…} 代码块表达式 Fragment Expressions</p>
<p><strong>字面量</strong><br>‘one text’,’another text’…文本<br>0,1,3.0,12.45… 数值<br>true false 布尔类型<br>null 空<br>one,sometext,main 文本字符</p>
<p><strong>文本操作</strong><br>+ 字符串连接<br>|The name is ${name}| 字符串连接</p>
<p><strong>算数运算</strong><br>+ - * / % 二元运算符<br>- 负号 一元运算符</p>
<p><strong>布尔操作</strong><br>and or 二元操作符<br>! not 非 一元操作符</p>
<p><strong>关系操作符</strong><br>&gt; &lt; &gt;= &lt;= gt lt ge le<br>== != eq ne</p>
<p><strong>条件判断</strong><br>(if) ? (then) if-then<br>(if) ? (then):(else) if-then-else</p>
<h3 id="6-4-3-常用-Thymeleaf-属性使用"><a href="#6-4-3-常用-Thymeleaf-属性使用" class="headerlink" title="6.4.3 常用 Thymeleaf 属性使用"></a>6.4.3 常用 Thymeleaf 属性使用</h3><p>使用Thymeleaf属性需要注意点以下五点：</p>
<p>一、若要使用Thymeleaf语法，首先要声明名称空间： xmlns:th=”<a target="_blank" rel="noopener" href="http://www.thymeleaf.org&quot;/">http://www.thymeleaf.org&quot;</a></p>
<p>二、设置文本内容 th:text，设置input的值 th:value，循环输出 th:each，条件判断 th:if，插入代码块 th:insert，定义代码块 th:fragment，声明变量 th:object</p>
<p>三、th:each 的用法需要格外注意，打个比方：如果你要循环一个div中的p标签，则th:each属性必须放在p标签上。若你将th:each属性放在div上，则循环的是将整个div。</p>
<p>四、变量表达式中提供了很多的内置方法，该内置方法是用#开头，请不要与#{}消息表达式弄混。</p>
<p>五、th:insert，th:replace，th:include 三种插入代码块的效果相似，但区别很大。</p>
<h1 id="七、MVC配置"><a href="#七、MVC配置" class="headerlink" title="七、MVC配置"></a>七、MVC配置</h1><p>Spring Boot为Spring MVC提供了自动配置，适用于大多数应用程序</p>
<p>如果你想保留Spring Boot MVC功能，并且你想添加额外的 MVC配置（拦截器，格式化程序，视图控制器和其他功能），你可以添加自己 的 @Configuration 和 WebMvcConfigurer 类</p>
<h2 id="7-1-SpringMVC-在-SpringBoot-中的扩展"><a href="#7-1-SpringMVC-在-SpringBoot-中的扩展" class="headerlink" title="7.1 SpringMVC 在 SpringBoot 中的扩展"></a>7.1 SpringMVC 在 SpringBoot 中的扩展</h2><p>首先，我们创建一个名为 config 的包，代表我们自己对 SpringMVC 的配置</p>
<p>通过源码可以得知，WebMvcConfigurer 类是一个接口类，那么我们继承这个接口即可，同时添加 @Configuration  注解</p>
<p>接下来，就可以通过重写各种方法，来完成对 SpringMVC 的各种配置</p>
<h2 id="7-2-视图解析器-ContentNegotiatingViewResolver"><a href="#7-2-视图解析器-ContentNegotiatingViewResolver" class="headerlink" title="7.2  视图解析器  ContentNegotiatingViewResolver"></a>7.2  视图解析器  ContentNegotiatingViewResolver</h2><p>我们通过对 ContentNegotiatingViewResolver 类源码的分析可以得知，这个类实现了 ViewResolver 接口类，因此可以被称之为视图解析器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ContentNegotiatingViewResolver</span> </span></span><br><span class="line"><span class="class">	<span class="keyword">extends</span> <span class="title">WebApplicationObjectSupport</span> </span></span><br><span class="line"><span class="class">	<span class="keyword">implements</span> <span class="title">ViewResolver</span>, <span class="title">Ordered</span>, <span class="title">InitializingBean</span></span></span><br></pre></td></tr></table></figure>

<p>通过 debug 可以看到，ContentNegotiatingViewResolver 视图解析器会默认启动，不用特意配置，在下面以视图解析器为例子，展示DIY 的方法</p>
<h2 id="7-3-DIY-组件"><a href="#7-3-DIY-组件" class="headerlink" title="7.3 DIY 组件"></a>7.3 DIY 组件</h2><p>接下来以视图解析器为例子，来完成一次 DIY 组件的配置，并将其装配到 SpringBoot 中</p>
<p>首先，我们需要实现 ViewResolver 接口类，这样就可以创造一个视图解析器，为了方便，我们将其设置为<strong>静态内部类</strong>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 自定义的 视图解析器</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">MyViewResolver</span> <span class="keyword">implements</span> <span class="title">ViewResolver</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> View <span class="title">resolveViewName</span><span class="params">(String viewName, Locale locale)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后书写一个带有 @Bean 注解的方法，将其注入到 Bean 容器中：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> MyViewResolver <span class="title">viewResolver</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> MyViewResolver();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这样在启动时，MyViewResolver 类就会作为视图解析器参加程序的运行</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/07/22/SSM%E6%95%B4%E5%90%88/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="神秘的世界">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/07/22/SSM%E6%95%B4%E5%90%88/" class="post-title-link" itemprop="url">SSM整合</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-07-22 21:13:17" itemprop="dateCreated datePublished" datetime="2022-07-22T21:13:17+08:00">2022-07-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-07-30 23:10:12" itemprop="dateModified" datetime="2022-07-30T23:10:12+08:00">2022-07-30</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>我们将在这篇博客中书写 SSM 的整合流程。</p>
<h1 id="一、MyBatis-部分"><a href="#一、MyBatis-部分" class="headerlink" title="一、MyBatis 部分"></a>一、MyBatis 部分</h1><p>我们需要根据 pojo 包下的实体类，来编写 Dao 层的代码 和 Service 层的代码。</p>
<p>pojo 的实体类，<strong>为其加上 有参 和 无参构造</strong>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Books</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> bookID;</span><br><span class="line">    <span class="keyword">private</span> String bookName;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> bookCounts;</span><br><span class="line">    <span class="keyword">private</span> String detail;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>根据上方的代码书写 Dao 层的代码，并为其配置XML文件</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BookMapper</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 添加数据</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">addBooks</span><span class="params">( Books books )</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 删除数据</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">deleteBooksById</span><span class="params">( <span class="meta">@Param(&quot;bookId&quot;)</span> <span class="keyword">int</span> bookId )</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 修改数据</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">updateBooks</span><span class="params">( Books books )</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 查询数据</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Books <span class="title">queryBooksById</span><span class="params">( <span class="meta">@Param(&quot;bookId&quot;)</span> <span class="keyword">int</span> bookId )</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 查询所有数据</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ArrayList&lt;Books&gt; <span class="title">queryAllBooks</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.Song.Dao.BookMapper&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;addBooks&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;Book&quot;</span>&gt;</span></span><br><span class="line">        insert into ssmbuild.books (bookID, bookName, bookCounts, detail)</span><br><span class="line">        VALUES ( #&#123;bookID&#125;, #&#123;bookName&#125;, #&#123;bookCounts&#125;, #&#123;detail&#125; );</span><br><span class="line">    <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">&quot;deleteBooksById&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span>&gt;</span></span><br><span class="line">        delete from ssmbuild.books where bookID = #&#123;bookId&#125;;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;updateBooks&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;Book&quot;</span>&gt;</span></span><br><span class="line">        update ssmbuild.books</span><br><span class="line">        set bookCounts = #&#123;bookCounts&#125;, bookName = #&#123;bookName&#125;, detail = #&#123;detail&#125;</span><br><span class="line">        where bookID = #&#123;bookID&#125;;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;queryBooksById&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;Book&quot;</span>&gt;</span></span><br><span class="line">        select * from ssmbuild.books where bookID = #&#123;bookID&#125;;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;queryAllBooks&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;Book&quot;</span>&gt;</span></span><br><span class="line">        select * from ssmbuild.books;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在配置完XML文件后，我们就可以开始书写 mybatis-config.xml 文件。</p>
<p>由于该文件中数据源配置已经交给 Spring 进行，因此就不再 mybatis-config.xml 文件中配置数据库。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">    <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- configuration核心配置文件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 标准的日志实现 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;logImpl&quot;</span> <span class="attr">value</span>=<span class="string">&quot;STDOUT_LOGGING&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">typeAlias</span> <span class="attr">type</span>=<span class="string">&quot;com.Song.Pojo.Books&quot;</span> <span class="attr">alias</span>=<span class="string">&quot;Book&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">class</span>=<span class="string">&quot;com.Song.Dao.BookMapper&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>完成了上面的部分后，我们还要根据 Dao 层的代码，去书写 Service 层，Service 层的代码分为接口和实现两部分。</p>
<p>Service 层的接口代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BookService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 添加数据</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">addBooks</span><span class="params">( Books books )</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 删除数据</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">deleteBooksById</span><span class="params">( <span class="meta">@Param(&quot;bookId&quot;)</span> <span class="keyword">int</span> bookId )</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 修改数据</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">updateBooks</span><span class="params">( Books books )</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 查询数据</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Books <span class="title">queryBooksById</span><span class="params">( <span class="meta">@Param(&quot;bookId&quot;)</span> <span class="keyword">int</span> bookId )</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 查询所有数据</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ArrayList&lt;Books&gt; <span class="title">queryAllBooks</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>由于 Service 层的作用就是调用 Dao 层的函数，因此 Service 层的接口代码和 Dao 层中接口代码相同。</p>
<p>下面是实现类的代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BookServiceImpl</span> <span class="keyword">implements</span> <span class="title">BookService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> BookMapper mapper;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMapper</span><span class="params">(BookMapper mapper)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.mapper = mapper;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">addBooks</span><span class="params">(Books books)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> mapper.addBooks( books );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">deleteBooksById</span><span class="params">(<span class="keyword">int</span> bookId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> mapper.deleteBooksById(bookId);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">updateBooks</span><span class="params">(Books books)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> mapper.updateBooks(books);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Books <span class="title">queryBooksById</span><span class="params">(<span class="keyword">int</span> bookId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> mapper.queryBooksById(bookId);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ArrayList&lt;Books&gt; <span class="title">queryAllBooks</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> mapper.queryAllBooks();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>为了方便后面对实现类进行 Spring <strong>自动装配 Bean</strong> 和 托管。</p>
<p>为实现类上添加 @Service 注解，在 私密属性 mapper 的对应的 Set 方法下加上 @Autowired 注解。</p>
<p>通过这种方式，可以完成这个类的 Bean 自动装配。</p>
<p>在完成上面的部分后，MyBatis 的内容就完成了。</p>
<h1 id="二、Spring-部分"><a href="#二、Spring-部分" class="headerlink" title="二、Spring 部分"></a>二、Spring 部分</h1><p>Spring 部分主要进行配置，我们首先创建总的 XML 文件 applicationContext.xml ，但我们暂且先不写。</p>
<p>这个部分进行的配置主要涉及 4 个文件，分别是 ：</p>
<table>
<thead>
<tr>
<th align="center"><strong>database.properties</strong></th>
<th align="center"><strong>外部数据库配置文件</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="center"><strong>Spring-Dao.xml</strong></td>
<td align="center"><strong>Spring与Dao层相关联的配置文件</strong></td>
</tr>
<tr>
<td align="center"><strong>Spring-mvc.xml</strong></td>
<td align="center"><strong>Spring与Controller层相关联的配置文件</strong></td>
</tr>
<tr>
<td align="center"><strong>Spring-Service.xml</strong></td>
<td align="center"><strong>Spring与Service层相关联的配置文件</strong></td>
</tr>
</tbody></table>
<p>我们先进行外部数据库的配置文件：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">jdbc.driver=com.mysql.cj.jdbc.Driver</span><br><span class="line">jdbc.url=</span><br><span class="line">    jdbc:mysql:<span class="comment">//localhost:3306/mybatis?useSSL=true&amp;useUnicode=true&amp;characterEncoding=UTF-8&amp;serverTimezone=Asia/Shanghai</span></span><br><span class="line">jdbc.username=root</span><br><span class="line">jdbc.password=<span class="number">123456</span></span><br></pre></td></tr></table></figure>

<p>这里要注意的是，如果连接池使用的是 C3P0 ，在 driver、url 前<strong>需要加上 jdbc. 的前缀，否则会出现神奇的错误</strong>。</p>
<h2 id="Spring-Dao-xml"><a href="#Spring-Dao-xml" class="headerlink" title="Spring-Dao.xml"></a>Spring-Dao.xml</h2><p>接下来，我们首先来完成对 <strong>Spring-Dao.xml</strong> 文件的配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:mvc</span>=<span class="string">&quot;http://www.springframework.org/schema/mvc&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context https://www.springframework.org/schema/context/spring-context.xsd http://www.springframework.org/schema/mvc https://www.springframework.org/schema/mvc/spring-mvc.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 关联外部数据库 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">&quot;classpath:database.properties&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 导入连接池 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.mchange.v2.c3p0.ComboPooledDataSource&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClass&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.driver&#125;&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;jdbcUrl&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.url&#125;&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;user&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.username&#125;&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.password&#125;&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 配置 sqlSessionFactory --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;sqlSessionFactory&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;configLocation&quot;</span> <span class="attr">value</span>=<span class="string">&quot;classpath:mybatis-config.xml&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 配置 Dao 扫描包，动态实现 Dao 层的注入 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.mapper.MapperScannerConfigurer&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 注入 sqlSessionFactory --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;sqlSessionFactoryBeanName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;sqlSessionFactory&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 扫描包 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;basePackage&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.Song.Dao&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这段代码几乎不需要改动，现在我们从上之下开始解释 ：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 关联外部数据库 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">&quot;classpath:database.properties&quot;</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 导入连接池 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.mchange.v2.c3p0.ComboPooledDataSource&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClass&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.driver&#125;&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;jdbcUrl&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.url&#125;&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;user&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.username&#125;&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.password&#125;&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这段代码的意义在于关联外部数据库并将其导入，并对其进行配置。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 配置 sqlSessionFactory --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;sqlSessionFactory&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;configLocation&quot;</span> <span class="attr">value</span>=<span class="string">&quot;classpath:mybatis-config.xml&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 配置 Dao 扫描包，动态实现 Dao 层的注入 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.mapper.MapperScannerConfigurer&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 注入 sqlSessionFactory --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;sqlSessionFactoryBeanName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;sqlSessionFactory&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 扫描包 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;basePackage&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.Song.Dao&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这段代码的意义在于配置 sqlSessionFactory 在通过动态扫描，将 Dao 包下的类进行注册。</p>
<h2 id="Spring-Service-xml"><a href="#Spring-Service-xml" class="headerlink" title="Spring-Service.xml"></a><strong>Spring-Service.xml</strong></h2><p>接下来，我们首先来完成对 <strong>Spring-Service.xml</strong> 文件的配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:mvc</span>=<span class="string">&quot;http://www.springframework.org/schema/mvc&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context https://www.springframework.org/schema/context/spring-context.xsd http://www.springframework.org/schema/mvc https://www.springframework.org/schema/mvc/spring-mvc.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--执行包扫描--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.Song.Service&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--将业务注入到 Spring 中--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookServiceImpl&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.Song.Service.BookServiceImpl&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 开启事务 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;transactionManager&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这段代码几乎不需要改动，现在我们从上之下开始解释 ：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--执行包扫描--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.Song.Service&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>这段代码的意义在于开启对包的扫描，扫描指定的位置。这里和上方中 @Service 的注解连接使用。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--将业务注入到 Spring 中--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookServiceImpl&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.Song.Service.BookServiceImpl&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>这段代码的意义在于将 Service 层中的实现类注册到其中。</p>
<p>由于我们在 Service 中的实现类中使用 @Autowire 注解，在这里就可以不用手动配置了。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 开启事务 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;transactionManager&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这就没什么说的了，开始事务。</p>
<h2 id="Spring-mvc-xml"><a href="#Spring-mvc-xml" class="headerlink" title="Spring-mvc.xml"></a>Spring-mvc.xml</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:mvc</span>=<span class="string">&quot;http://www.springframework.org/schema/mvc&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context https://www.springframework.org/schema/context/spring-context.xsd http://www.springframework.org/schema/mvc https://www.springframework.org/schema/mvc/spring-mvc.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 启用包扫描 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.Song.Controller&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 启用静态过滤 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:default-servlet-handler</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 提供Controller请求转发，json自动转换等功能 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:annotation-driven</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--添加视图解析器--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--前缀--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;prefix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;/WEB-INF/jsp/&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--后缀--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;suffix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;.jsp&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这是和 SpringMVC 相关连的 XML 文件，就不再进行说明。</p>
<h2 id="applicationContext-xml"><a href="#applicationContext-xml" class="headerlink" title="applicationContext.xml"></a>applicationContext.xml</h2><p>最后，我们将这三件全部导入到 Spring 的大配置文件 applicationContext.xml  中：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:mvc</span>=<span class="string">&quot;http://www.springframework.org/schema/mvc&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context https://www.springframework.org/schema/context/spring-context.xsd http://www.springframework.org/schema/mvc https://www.springframework.org/schema/mvc/spring-mvc.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">&quot;classpath:Spring-Dao.xml&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">&quot;classpath:Spring-mvc.xml&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">&quot;classpath:Spring-Service.xml&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- JSON 处理乱码 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:annotation-driven</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mvc:message-converters</span> <span class="attr">register-defaults</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.http.converter.StringHttpMessageConverter&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">value</span>=<span class="string">&quot;UTF-8&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.http.converter.json.MappingJackson2HttpMessageConverter&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;objectMapper&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.http.converter.json.Jackson2ObjectMapperFactoryBean&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;failOnEmptyBeans&quot;</span> <span class="attr">value</span>=<span class="string">&quot;false&quot;</span>/&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">mvc:message-converters</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mvc:annotation-driven</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>可见，我们使用的 import 方法来完成的配置。</p>
<h1 id="三、SpringMVC-部分"><a href="#三、SpringMVC-部分" class="headerlink" title="三、SpringMVC 部分"></a>三、SpringMVC 部分</h1><p>使用时，需要在 web.xml 中配置文件。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--注册DispatcherServlet--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:applicationContext.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--启动级别 1--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span> </span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>utf-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>SpringMVC 的相关配置已经在上方配置完成了，我们接下来要进行 Controller 层的书写，代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/book&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BookController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> BookService bookService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="meta">@Qualifier(&quot;bookServiceImpl&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBookService</span><span class="params">(BookService bookService)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.bookService = bookService;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 查询所有书籍，返回页面</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/allBook&quot;)</span></span><br><span class="line"><span class="comment">//    @ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getBookList</span><span class="params">()</span> <span class="keyword">throws</span> JsonProcessingException </span>&#123;</span><br><span class="line">        ArrayList&lt;Books&gt; resultList = bookService.queryAllBooks();</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//        ObjectMapper mapper = new ObjectMapper();</span></span><br><span class="line"><span class="comment">//        String result = mapper.writeValueAsString(resultList);</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;BookPage&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们由于需要通过 Service 层的实现类调用 Dao 层代码。</p>
<p>为了这个类可以被扫描，我们使用了 @Controller 注解，并用 @RequestMapping(“”) 注解限定了她的访问路径。</p>
<p>我们使用了一个私密属性的 BookService ，为了交给 Spring 托管，需要构造一个 set 方法，便于进行 DI 注入 。</p>
<p>为此我们给她赋予了@Autowired 和 @Qualifier(“bookServiceImpl”) 注解。（ bookServiceImpl 注册在 <strong>Spring-Service.xml</strong> 中 ）</p>
<p>提一嘴，注释部分是使用了 Jackson 的代码。</p>
<p>最后，配置并启动 tomcat 就可以完成 SSM 框架的整合。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/07/17/SpringMCV%E7%9A%84%E5%AD%A6%E4%B9%A0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="神秘的世界">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/07/17/SpringMCV%E7%9A%84%E5%AD%A6%E4%B9%A0/" class="post-title-link" itemprop="url">springMCV的学习</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-07-17 18:31:03" itemprop="dateCreated datePublished" datetime="2022-07-17T18:31:03+08:00">2022-07-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-07-23 11:07:44" itemprop="dateModified" datetime="2022-07-23T11:07:44+08:00">2022-07-23</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="重点！"><a href="#重点！" class="headerlink" title="重点！"></a>重点！</h1><p>每次在运行 tomcat 前，要注意对应的工程有没有导入 lib 目录 ！！！！</p>
<h1 id="一、MVC-架构"><a href="#一、MVC-架构" class="headerlink" title="一、MVC 架构"></a>一、MVC 架构</h1><p>MVC 架构一般而言特指 <strong>模型、视图、控制器</strong> 的三层架构。</p>
<h2 id="1-1-MVC-架构"><a href="#1-1-MVC-架构" class="headerlink" title="1.1 MVC 架构"></a>1.1 MVC 架构</h2><p>M即model模型是指模型表示<strong>业务规则</strong>。</p>
<p>在MVC的三个部件中，模型拥有最多的处理任务。</p>
<p>被模型返回的数据是中立的，模型与数据格式无关，这样一个模型能为多个视图提供数据，由于应用于模型的代码只需写一次就可以被多个视图重用，所以减少了代码的重复性。</p>
<p>V即<strong>View视图</strong>是指用户看到并与之交互的界面。</p>
<p>比如由html元素组成的网页界面，或者软件的客户端界面。</p>
<p>MVC的好处之一在于它能为应用程序处理很多不同的视图。在视图中其实没有真正的处理发生，它只是作为一种输出数据并允许用户操作的方式。</p>
<p>C即<strong>controller控制器</strong>是指控制器接受用户的输入并调用模型和视图去完成用户的需求，控制器本身不输出任何东西和做任何处理。它只是接收请求并决定调用哪个模型构件去处理请求，然后再确定用哪个视图来显示返回的数据。</p>
<p><strong>最经典的 MVC 模型就是 ： JSP + Srocket + JavaBean 模式</strong></p>
<h2 id="1-2-实现-MVC-时可能用到的-Maven-包"><a href="#1-2-实现-MVC-时可能用到的-Maven-包" class="headerlink" title="1.2 实现 MVC 时可能用到的 Maven 包"></a>1.2 实现 MVC 时可能用到的 Maven 包</h2><h3 id="JSP"><a href="#JSP" class="headerlink" title="JSP"></a>JSP</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- JSP 相关包 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/javax.servlet.jsp/jsp-api --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet.jsp<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jsp-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="SpringMVC"><a href="#SpringMVC" class="headerlink" title="SpringMVC"></a>SpringMVC</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- SpringMVC 相关包 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.springframework/spring-webmvc --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.20<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="Servlet"><a href="#Servlet" class="headerlink" title="Servlet"></a>Servlet</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Servlet 相关包 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/javax.servlet/javax.servlet-api --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="JSTL"><a href="#JSTL" class="headerlink" title="JSTL"></a>JSTL</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- JSTL 相关包 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/javax.servlet/jstl --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jstl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="1-3-MVC-框架的作用"><a href="#1-3-MVC-框架的作用" class="headerlink" title="1.3 MVC 框架的作用"></a>1.3 MVC 框架的作用</h2><ul>
<li>将 URL 映射到 Java 类或 Java 类的方法。</li>
<li>封装用户提交的数据。</li>
<li>处理请求，调用相关的业务处理，封装响应数据。</li>
<li>将响应的数据进行渲染 .jsp / html 等表示层的数据</li>
</ul>
<h1 id="二、SpringMVC-程序"><a href="#二、SpringMVC-程序" class="headerlink" title="二、SpringMVC 程序"></a>二、SpringMVC 程序</h1><h2 id="2-1-SpringMVC-的特点"><a href="#2-1-SpringMVC-的特点" class="headerlink" title="2.1 SpringMVC 的特点"></a>2.1 SpringMVC 的特点</h2><ul>
<li>轻便高效，是基于 响应请求 的MVC框架。</li>
<li>和 Spring 兼容性好，无缝结合</li>
<li>约定优于配置</li>
<li>功能强大，简单灵活</li>
</ul>
<h2 id="2-2-第一个-SpringMVC-程序"><a href="#2-2-第一个-SpringMVC-程序" class="headerlink" title="2.2 第一个 SpringMVC 程序"></a>2.2 第一个 SpringMVC 程序</h2><p>在导入 SpringMVC 的依赖后，在 Web.xml 中注册 SpringMVC 的相关代码</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--注册DispatcherServlet--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:applicationContext.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--启动级别 1--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span> </span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在 web.xml 注册上面的代码时，会提示找不到文件 applicationContext.xml ，先放置，我们在下一步配置 applicationContext.xml 。</p>
<p>完成后，我们就可以开始准备配置文件的设置了。</p>
<p>由于 SpringMVC 基于 Spring 所以二者的配置文件都可以为 applicationContext.xml 。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在 applicationContext.xml 中，我们需要配置以下文件：</p>
<p>处理器映射 和 处理器适配器</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--添加处理器映射--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.servlet.handler.BeanNameUrlHandlerMapping&quot;</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!--添加处理器适配器--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>视图解析器</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--添加视图显示器--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--前缀--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;prefix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;/WEB-INF/jsp/&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--后缀--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;suffix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;.jsp&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>完成上方的配置后，我们就可以开始书写实现类了</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloSpringMVC</span> <span class="keyword">implements</span> <span class="title">Controller</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">handleRequest</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">// 模型和视图</span></span><br><span class="line">        ModelAndView modelAndView = <span class="keyword">new</span> ModelAndView();</span><br><span class="line"></span><br><span class="line">        modelAndView.addObject( <span class="string">&quot;msg&quot;</span>, <span class="string">&quot;Hello SpringMVC&quot;</span> );</span><br><span class="line">        modelAndView.setViewName( <span class="string">&quot;hello&quot;</span> );</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> modelAndView;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>实现类需要继承 Controller 接口。</p>
<p>不过要注意不要继承错接口，我们应该继承 org.springframework.web.servlet.mvc.Controller 包下的接口，只有一个需要实现的方法。</p>
<p>编写完实现后，应该去 applicationContext.xml 文件中注册实现类：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--注册--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;/hello&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.Song.Controller.HelloSpringMVC&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>



<p>最后再补上相对应的 JSP 文件，配置 tomcat 就可以正确运行这个 SpringMVC 程序。</p>
<h2 id="2-3-SpringMVC-的执行流程"><a href="#2-3-SpringMVC-的执行流程" class="headerlink" title="2.3 SpringMVC 的执行流程"></a>2.3 SpringMVC 的执行流程</h2><p>第一步</p>
<p>用户发送请求到控制器，控制器根据请求信息来确定选择哪一个页面控制器进行处理并把请求委托给它。</p>
<p>第二步</p>
<p>页面控制器获取请求后，进行功能处理，需要收集和绑定请求参数到一个对象，然后将这个对象丢入业务层中进行操作。处理完毕后返回一个ModelAndView（模型数据和逻辑视图名）</p>
<p>第三步</p>
<p>前端控制器收回控制权，然后根据返回的逻辑视图名，选择相应的视图进行渲染，并把模型数据传入以便视图渲染。</p>
<p>第四步</p>
<p>前端控制器再次收回控制权，将响应返回给用户，至此整个结束。</p>
<h1 id="三、使用注解开发-SpringMVC"><a href="#三、使用注解开发-SpringMVC" class="headerlink" title="三、使用注解开发 SpringMVC"></a>三、使用注解开发 SpringMVC</h1><p>首先在确认 SpringMVC 依赖导入后，在 web.xml 文件中进行配置。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--注册DispatcherServlet--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:applicationContext.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--启动级别 1--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在上方的代码中，我们需要一个名为 applicationContext.xml 的配置文件，我们暂且搁置。</p>
<p>在完成了对 web.xml 的配置后，再去书写 applicationContext.xml 配置文件。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:mvc</span>=<span class="string">&quot;http://www.springframework.org/schema/mvc&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">                           http://www.springframework.org/schema/beans/spring-beans.xsd 					  							 http://www.springframework.org/schema/context </span></span></span><br><span class="line"><span class="string"><span class="tag">                           https://www.springframework.org/schema/context/spring-context.xsd    									   http://www.springframework.org/schema/mvc </span></span></span><br><span class="line"><span class="string"><span class="tag">                           https://www.springframework.org/schema/mvc/spring-mvc.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在这个配置文件中，我们需要配置以下的设置：</p>
<p>包扫描：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 启用包扫描 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.Song.Controller&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>静态过滤：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 启用静态过滤 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:default-servlet-handler</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>提供Controller请求转发，json自动转换等功能：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 提供Controller请求转发，json自动转换等功能 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:annotation-driven</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>视图解析器：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--添加视图解析器--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--前缀--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;prefix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;/WEB-INF/jsp/&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--后缀--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;suffix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;.jsp&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在完成了上面的配置后，我们开始书写 Controller 层的代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="comment">//@RequestMapping(&quot;/hello&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/h1&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">byHello</span><span class="params">( Model model )</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        model.addAttribute( <span class="string">&quot;msg&quot;</span>, <span class="string">&quot;Hello My SpringMVC Anno&quot;</span> );</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在这里，我们使用了 @Controller 和 @RequestMapping 两个注解，她们的效果如下：</p>
<table>
<thead>
<tr>
<th align="center"><strong>@RequestMapping</strong></th>
<th align="center">表示这个类对应的映射地址</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><strong>@Controller</strong></td>
<td align="center"><strong>表示这个类可以被扫描，会被 Spring 接管</strong></td>
</tr>
</tbody></table>
<p>我们在参数中使用了 Model 类，这个类的作用是帮助我们向前端返回参数或者提交数据。</p>
<p>这个方法的返回值对应着前端某个文件，在这里的是 /WEB-INF/jsp/hello.jsp 这个文件。</p>
<h1 id="四、RestFul-风格"><a href="#四、RestFul-风格" class="headerlink" title="四、RestFul 风格"></a>四、RestFul 风格</h1><p>RestFul 就是一个资源定位以及资源操作的风格。</p>
<p>不是标准也不是协议，只是一种风格，基于这种风格设计的软件可以更加简洁，更有层次，更易于实现缓存等机制。</p>
<h2 id="4-1-RestFul-的实现"><a href="#4-1-RestFul-的实现" class="headerlink" title="4.1 RestFul 的实现"></a>4.1 RestFul 的实现</h2><p>我们在这里书写传统的传参方式</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RestfulTest</span> </span>&#123;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;test&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">testOne</span><span class="params">(Model model, <span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">        String result = String.valueOf( a + b );</span><br><span class="line"></span><br><span class="line">        model.addAttribute( <span class="string">&quot;msg&quot;</span>, <span class="string">&quot;结果为&quot;</span> + result);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;test&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>传统方式下的传参形式为 ：localhost:8080 / test ? a = 1 &amp; b = 2 这样传参的结果为  3。</p>
<p>现在使用 RestFul 风格来编辑代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;test/&#123;a&#125;/&#123;b&#125;&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testOne</span><span class="params">(Model model, <span class="meta">@PathVariable</span> <span class="keyword">int</span> a, <span class="meta">@PathVariable</span> <span class="keyword">int</span> b )</span></span>&#123;</span><br><span class="line">    String result = String.valueOf( a + b );</span><br><span class="line"></span><br><span class="line">    model.addAttribute( <span class="string">&quot;msg&quot;</span>, <span class="string">&quot;结果为&quot;</span> + result );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;test&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>RestFul 风格下的传参形式为： localhost:8080 / test/1/2，这样的结果同样为 3 。</p>
<p>这里我们使用了 @PathVariable 注解，这个注解可以使得我们的参数在地址栏里面直接属入，但是这个注解需要搭配 {} 符号共同使用。</p>
<p>就如同上方的代码中演示的一样。</p>
<h2 id="4-2-RestFul-风格的好处"><a href="#4-2-RestFul-风格的好处" class="headerlink" title="4.2 RestFul 风格的好处"></a>4.2 RestFul 风格的好处</h2><ul>
<li>使路径变得更加简洁。</li>
<li>获得参数更加方便，框架会自动进行类型转换。</li>
<li>通过路径变量的类型可以约束访问参数，如果类型不一样，则访问不到对应的请求方法。</li>
<li>是一种更加安全的方式。</li>
</ul>
<h1 id="五、结果跳转方式"><a href="#五、结果跳转方式" class="headerlink" title="五、结果跳转方式"></a>五、结果跳转方式</h1><h2 id="5-1-原始跳转"><a href="#5-1-原始跳转" class="headerlink" title="5.1 原始跳转"></a>5.1 原始跳转</h2><p>这种方式是使用原生的 HttpServletRequest 和 HttpServletResponse 两个类完成结果跳转</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/hello&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testOne</span><span class="params">( HttpServletRequest req, HttpServletResponse resp )</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">        req.setAttribute( <span class="string">&quot;message&quot;</span>, <span class="string">&quot;testOne&quot;</span> );</span><br><span class="line">        req.getRequestDispatcher(<span class="string">&quot;/WEB-INF/jsp/hello.jsp&quot;</span> ).forward( req, resp );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这种实现方式就和原先使用 Servlet 来实现是一模一样的效果。</p>
<p>不过要注意的是，在转发位置需要填入对应的完整路径，和视图解析器不同，无法只根据名称访问。</p>
<h2 id="5-2-SpringMVC-跳转"><a href="#5-2-SpringMVC-跳转" class="headerlink" title="5.2 SpringMVC 跳转"></a>5.2 SpringMVC 跳转</h2><p>这种方式是不使用视图解析器，直接选择跳转的方式</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/hello&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">testOne</span><span class="params">( Model model )</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        model.addAttribute( <span class="string">&quot;message&quot;</span>, <span class="string">&quot;test Two&quot;</span> );</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;/WEB-INF/jsp/hello.jsp&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>同样的，这种方式需要舍弃视图解析器，才可以正确完成对文件的跳转。</p>
<p>不过要注意的是，在转发位置需要填入对应的完整路径。</p>
<h2 id="5-3-forward-和-redirect-跳转"><a href="#5-3-forward-和-redirect-跳转" class="headerlink" title="5.3 forward 和 redirect 跳转"></a>5.3 forward 和 redirect 跳转</h2><p>和 SpringMVC 跳转相似，在跳转路径前加上 forward 或者 前缀即可</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/hello&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">testOne</span><span class="params">( Model model )</span> </span>&#123;</span><br><span class="line">        model.addAttribute( <span class="string">&quot;message&quot;</span>, <span class="string">&quot;test Two&quot;</span> );</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;forward:/WEB-INF/jsp/hello.jsp&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/hello&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">testOne</span><span class="params">( Model model )</span> </span>&#123;</span><br><span class="line">        model.addAttribute( <span class="string">&quot;message&quot;</span>, <span class="string">&quot;test Two&quot;</span> );</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;redirect:/WEB-INF/jsp/hello.jsp&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这种方式，在转发位置同样需要填入对应的完整路径。</p>
<p><strong>综上所述，一言以蔽之，不如用视图解析器。</strong></p>
<p>另外视图解析器默认的跳转方式为 <strong>转发</strong>，若需要重定向，只需要加上前缀即可：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/hello&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">testOne</span><span class="params">( Model model )</span> </span>&#123;</span><br><span class="line">        model.addAttribute( <span class="string">&quot;message&quot;</span>, <span class="string">&quot;test Two&quot;</span> );</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;redirect:hello&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="六、接收请求参数以及数据回显"><a href="#六、接收请求参数以及数据回显" class="headerlink" title="六、接收请求参数以及数据回显"></a>六、接收请求参数以及数据回显</h1><p>在 SpringMVC 中有好几种 请求参数 和 数据回显 的方式。</p>
<h2 id="6-1-使用地址栏获取参数"><a href="#6-1-使用地址栏获取参数" class="headerlink" title="6.1 使用地址栏获取参数"></a>6.1 使用地址栏获取参数</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/hello/&#123;userName&#125;&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testOne</span><span class="params">( Model model, <span class="meta">@PathVariable</span> String userName )</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    System.out.println( <span class="string">&quot;获取的参数为 ： &quot;</span> + userName );</span><br><span class="line">    model.addAttribute( <span class="string">&quot;message&quot;</span>, userName );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这种方式中，需要在地址栏中填入参数，这里是使用了 RestFul 所以填写参数的方式有一点稍稍的不同</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost:8080/hello/userName</span><br></pre></td></tr></table></figure>

<p>当然，如果希望在填写参数时使用其他的名称，可以使用 @RequestParam(“XXX”) 注解。</p>
<p>要注意的是：@RequestParam 注解不可以用作 RestFul 风格，否则会出现 400 错误。 </p>
<h2 id="6-2-使用-ModelAndView-回传参数"><a href="#6-2-使用-ModelAndView-回传参数" class="headerlink" title="6.2 使用 ModelAndView 回传参数"></a>6.2 使用 ModelAndView 回传参数</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> ModelAndView <span class="title">handleRequest</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    <span class="comment">// 模型和视图</span></span><br><span class="line">    ModelAndView modelAndView = <span class="keyword">new</span> ModelAndView();</span><br><span class="line"></span><br><span class="line">    modelAndView.addObject( <span class="string">&quot;msg&quot;</span>, <span class="string">&quot;Hello SpringMVC&quot;</span> );</span><br><span class="line">    modelAndView.setViewName( <span class="string">&quot;hello&quot;</span> );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> modelAndView;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="6-3-使用-Model-回传参数"><a href="#6-3-使用-Model-回传参数" class="headerlink" title="6.3 使用 Model 回传参数"></a>6.3 使用 Model 回传参数</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/hello/&#123;userName&#125;&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testOne</span><span class="params">( Model model, <span class="meta">@PathVariable</span> String userName )</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    System.out.println( <span class="string">&quot;获取的参数为 ： &quot;</span> + userName );</span><br><span class="line">    model.addAttribute( <span class="string">&quot;message&quot;</span>, userName );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="6-4-使用-ModelMap"><a href="#6-4-使用-ModelMap" class="headerlink" title="6.4 使用 ModelMap"></a>6.4 使用 ModelMap</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/hello/&#123;userName&#125;&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testOne</span><span class="params">( ModelMap map, <span class="meta">@PathVariable</span> String userName )</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    System.out.println( <span class="string">&quot;获取的参数为 ： &quot;</span> + userName );</span><br><span class="line">    map.addAttribute( <span class="string">&quot;message&quot;</span>, userName );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="6-5-三种传输方式的区别"><a href="#6-5-三种传输方式的区别" class="headerlink" title="6.5 三种传输方式的区别"></a>6.5 三种传输方式的区别</h2><p>简单而言：</p>
<ul>
<li><strong>Model</strong> <ul>
<li>只有寥寥几个方法适合储存，十分精简。</li>
</ul>
</li>
<li><strong>ModelMap</strong> <ul>
<li>继承了 LinkeMap， 除了自身的一些方法，全部继承了 LinkeMap 的方法和功能。</li>
</ul>
</li>
<li><strong>ModelAndView</strong> <ul>
<li>可以在储存数据的同时，可以进行设置返回的逻辑视图，进行控制展示层的跳转。</li>
</ul>
</li>
</ul>
<h1 id="七、乱码的处理"><a href="#七、乱码的处理" class="headerlink" title="七、乱码的处理"></a>七、乱码的处理</h1><p>可以使用 Get 方式提交 或者 在 web.xml 文件中配置下方的代码</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>utf-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h1 id="八、JOSN"><a href="#八、JOSN" class="headerlink" title="八、JOSN"></a>八、JOSN</h1><p>JSON(JavaScript Object Notation, JS 对象标记) 是一种轻量级的数据交换格式，目前使用特别广泛。</p>
<h2 id="8-1-JOSN-的概念"><a href="#8-1-JOSN-的概念" class="headerlink" title="8.1 JOSN 的概念"></a>8.1 JOSN 的概念</h2><ul>
<li>采用完全独立于编程语言的<strong>文本格式</strong>来存储和表示数据。</li>
<li>简洁和清晰的层次结构使得 JSON 成为理想的数据交换语言。</li>
<li>易于人阅读和编写，同时也易于机器解析和生成，并有效地提升网络传输效率。</li>
</ul>
<p>在 JavaScript 语言中，一切都是对象。</p>
<p>因此，任何JavaScript 支持的类型都可以通过 JSON 来表示，例如字符串、数字、对象、数组等。看看他的要求和语法格式：</p>
<ul>
<li>对象表示为键值对，数据由逗号分隔</li>
<li>花括号保存对象</li>
<li>方括号保存数组</li>
</ul>
<h2 id="8-2-JSON-键值对"><a href="#8-2-JSON-键值对" class="headerlink" title="8.2 JSON 键值对"></a>8.2 <strong>JSON 键值对</strong></h2><p>是用来保存 JavaScript 对象的一种方式，和 JavaScript 对象的写法也大同小异，键/值对组合中的键名写在前面并用双引号 “” 包裹，使用冒号 : 分隔，然后紧接着值：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;name&quot;: &quot;QinJiang&quot;&#125;</span><br><span class="line">&#123;&quot;age&quot;: &quot;3&quot;&#125;</span><br><span class="line">&#123;&quot;sex&quot;: &quot;男&quot;&#125;</span><br></pre></td></tr></table></figure>

<p>很多人搞不清楚 JSON 和 JavaScript 对象的关系，甚至连谁是谁都不清楚。其实，可以这么理解：</p>
<p>JSON 是 JavaScript 对象的字符串表示法，它使用文本表示一个 JS 对象的信息，本质是一个字符串。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var obj = &#123;a: &#x27;Hello&#x27;, b: &#x27;World&#x27;&#125;; //这是一个对象，注意键名也是可以使用引号包裹的</span><br><span class="line">var json = &#x27;&#123;&quot;a&quot;: &quot;Hello&quot;, &quot;b&quot;: &quot;World&quot;&#125;&#x27;; //这是一个 JSON 字符串，本质是一个字符串</span><br></pre></td></tr></table></figure>

<h2 id="8-3-JSON-和-JavaScript-对象互转"><a href="#8-3-JSON-和-JavaScript-对象互转" class="headerlink" title="8.3 JSON 和 JavaScript 对象互转"></a>8.3 <strong>JSON 和 JavaScript 对象互转</strong></h2><p>要实现从JSON字符串转换为JavaScript 对象，使用 JSON.parse() 方法：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var obj = JSON.parse(&#x27;&#123;&quot;a&quot;: &quot;Hello&quot;, &quot;b&quot;: &quot;World&quot;&#125;&#x27;);</span><br><span class="line">//结果是 &#123;a: &#x27;Hello&#x27;, b: &#x27;World&#x27;&#125;</span><br></pre></td></tr></table></figure>

<p>要实现从JavaScript 对象转换为JSON字符串，使用 JSON.stringify() 方法：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var json = JSON.stringify(&#123;a: &#x27;Hello&#x27;, b: &#x27;World&#x27;&#125;);</span><br><span class="line">//结果是 &#x27;&#123;&quot;a&quot;: &quot;Hello&quot;, &quot;b&quot;: &quot;World&quot;&#125;&#x27;</span><br></pre></td></tr></table></figure>



<h2 id="8-4-Jackson-的使用"><a href="#8-4-Jackson-的使用" class="headerlink" title="8.4 Jackson 的使用"></a>8.4 Jackson 的使用</h2><p>Jackson 的使用首先需要导入相关的包依赖：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Jackson 相关包 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/com.fasterxml.jackson.core/jackson-databind --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-databind<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.13.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在使用中 Jackson 会出现乱码的问题，使用下面的代码在 XML 文件中配置即可：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mvc:annotation-driven</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">mvc:message-converters</span> <span class="attr">register-defaults</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.http.converter.StringHttpMessageConverter&quot;</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">value</span>=<span class="string">&quot;UTF-8&quot;</span>/&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.http.converter.json.MappingJackson2HttpMessageConverter&quot;</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;objectMapper&quot;</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.http.converter.json.Jackson2ObjectMapperFactoryBean&quot;</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;failOnEmptyBeans&quot;</span> <span class="attr">value</span>=<span class="string">&quot;false&quot;</span>/&gt;</span></span><br><span class="line">               <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">mvc:message-converters</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mvc:annotation-driven</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>为了使得程序不经过视图解析器，直接返回 Josn 字符串，我们需要 @<strong>ResponseBody</strong> 注解。</p>
<p>这个注解可以使得代码绕过字符解析器，直接返回字符串。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/Hi&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">jacksonOne</span><span class="params">( Model model )</span> <span class="keyword">throws</span> JsonProcessingException </span>&#123;</span><br><span class="line"></span><br><span class="line">    ObjectMapper mapper = <span class="keyword">new</span> ObjectMapper();</span><br><span class="line"></span><br><span class="line">    User user = <span class="keyword">new</span> User(<span class="number">1</span>, <span class="string">&quot;Jack&quot;</span>, <span class="string">&quot;G&quot;</span>);</span><br><span class="line"></span><br><span class="line">    String result = mapper.writeValueAsString(user);</span><br><span class="line">    System.out.println(result);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>从上方的代码中，可以知道 ：我们使用 ObjectMapper 的 writeValueAsString 方法将对象转化为 JOSN 字符串</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ObjectMapper mapper = <span class="keyword">new</span> ObjectMapper();</span><br><span class="line">String result = mapper.writeValueAsString(user);</span><br></pre></td></tr></table></figure>

<p>这就是上方代码中的核心。</p>
<h2 id="8-5-FastJosn-的实现"><a href="#8-5-FastJosn-的实现" class="headerlink" title="8.5 FastJosn 的实现"></a>8.5 FastJosn 的实现</h2><p>无疑，首先需要导入 FastJosn 的包</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">   &lt;groupId&gt;com.alibaba&lt;/groupId&gt;</span><br><span class="line">   &lt;artifactId&gt;fastjson&lt;/artifactId&gt;</span><br><span class="line">   &lt;version&gt;1.2.60&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<p>下面看看 FastJosn 的使用</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FastJsonDemo</span> </span>&#123;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">       <span class="comment">//创建一个对象</span></span><br><span class="line">       User user1 = <span class="keyword">new</span> User(<span class="string">&quot;秦疆1号&quot;</span>, <span class="number">3</span>, <span class="string">&quot;男&quot;</span>);</span><br><span class="line">       User user2 = <span class="keyword">new</span> User(<span class="string">&quot;秦疆2号&quot;</span>, <span class="number">3</span>, <span class="string">&quot;男&quot;</span>);</span><br><span class="line">       User user3 = <span class="keyword">new</span> User(<span class="string">&quot;秦疆3号&quot;</span>, <span class="number">3</span>, <span class="string">&quot;男&quot;</span>);</span><br><span class="line">       User user4 = <span class="keyword">new</span> User(<span class="string">&quot;秦疆4号&quot;</span>, <span class="number">3</span>, <span class="string">&quot;男&quot;</span>);</span><br><span class="line">       List&lt;User&gt; list = <span class="keyword">new</span> ArrayList&lt;User&gt;();</span><br><span class="line">       list.add(user1);</span><br><span class="line">       list.add(user2);</span><br><span class="line">       list.add(user3);</span><br><span class="line">       list.add(user4);</span><br><span class="line"></span><br><span class="line">       System.out.println(<span class="string">&quot;*******Java对象 转 JSON字符串*******&quot;</span>);</span><br><span class="line">       String str1 = JSON.toJSONString(list);</span><br><span class="line">       System.out.println(<span class="string">&quot;JSON.toJSONString(list)==&gt;&quot;</span>+str1);</span><br><span class="line">       String str2 = JSON.toJSONString(user1);</span><br><span class="line">       System.out.println(<span class="string">&quot;JSON.toJSONString(user1)==&gt;&quot;</span>+str2);</span><br><span class="line"></span><br><span class="line">       System.out.println(<span class="string">&quot;\n****** JSON字符串 转 Java对象*******&quot;</span>);</span><br><span class="line">       User jp_user1=JSON.parseObject(str2,User.class);</span><br><span class="line">       System.out.println(<span class="string">&quot;JSON.parseObject(str2,User.class)==&gt;&quot;</span>+jp_user1);</span><br><span class="line"></span><br><span class="line">       System.out.println(<span class="string">&quot;\n****** Java对象 转 JSON对象 ******&quot;</span>);</span><br><span class="line">       JSONObject jsonObject1 = (JSONObject) JSON.toJSON(user2);</span><br><span class="line">       System.out.println(<span class="string">&quot;(JSONObject) JSON.toJSON(user2)==&gt;&quot;</span>+jsonObject1.getString(<span class="string">&quot;name&quot;</span>));</span><br><span class="line"></span><br><span class="line">       System.out.println(<span class="string">&quot;\n****** JSON对象 转 Java对象 ******&quot;</span>);</span><br><span class="line">       User to_java_user = JSON.toJavaObject(jsonObject1, User.class);</span><br><span class="line">       System.out.println(<span class="string">&quot;JSON.toJavaObject(jsonObject1, User.class)==&gt;&quot;</span>+to_java_user);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>主要使用为</p>
<table>
<thead>
<tr>
<th align="center"><strong>JSON.toJSONString</strong></th>
<th align="center"><strong>Java对象 转 JSON字符串</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="center"><strong>JSON.parseObject</strong></td>
<td align="center"><strong>JSON字符串 转 Java对象</strong></td>
</tr>
<tr>
<td align="center"><strong>JSON.toJSON</strong></td>
<td align="center"><strong>Java对象 转 JSON对象</strong></td>
</tr>
<tr>
<td align="center"><strong>JSON.toJavaObject</strong></td>
<td align="center"><strong>JSON对象 转 Java对象</strong></td>
</tr>
</tbody></table>
<h1 id="九、拦截器"><a href="#九、拦截器" class="headerlink" title="九、拦截器"></a>九、拦截器</h1><p>拦截器类似于过滤器 Filter ，不同的是拦截器只会拦截 Controller 层的对象。</p>
<p>自定义拦截器十分的简单，只需要实现 <strong>HandlerInterceptor</strong> 接口。</p>
<p>实现后，需要在 xml 文件中配置拦截器的属性：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--配置拦截器--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:interceptors</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--配置拦截器，多个拦截器时，顺序执行--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--要拦截的具体的方法--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mvc:mapping</span> <span class="attr">path</span>=<span class="string">&quot;/*/text&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--不去拦截的方法</span></span><br><span class="line"><span class="comment">&lt;mvc:exclude-mapping path=&quot;&quot;/&gt;</span></span><br><span class="line"><span class="comment">        &lt;!--配置拦截器对象--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.ftp.interceptor.IndexInterceptor1&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mvc:interceptors</span>&gt;</span></span><br></pre></td></tr></table></figure>





<h2 id="9-1-过滤器和拦截器的区别"><a href="#9-1-过滤器和拦截器的区别" class="headerlink" title="9.1 过滤器和拦截器的区别"></a><strong>9.1 过滤器和拦截器的区别</strong></h2><p>过滤器(filter)：</p>
<pre><code>1) filter属于Servlet技术，只要是web工程都可以使用
2) filter主要对所有请求过滤
3) filter的执行时机早于Interceptor
</code></pre>
<p> 拦截器(interceptor)</p>
<pre><code>1) interceptor属于SpringMVC技术，必须要有SpringMVC环境才可以使用
2) interceptor通常对处理器Controller进行拦截
3) interceptor只能拦截dispatcherServlet处理的请求
</code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/07/17/%E8%81%8A%E8%81%8A%E4%B8%BA%E4%BB%80%E4%B9%88AOP%E4%B8%AD%E6%89%A7%E8%A1%8C%E7%8E%AF%E7%BB%95%E7%9A%84%E6%96%B9%E6%B3%95%E4%BC%9A%E5%9C%A8%E6%89%93%E5%8D%B0%E5%89%8D/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="神秘的世界">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/07/17/%E8%81%8A%E8%81%8A%E4%B8%BA%E4%BB%80%E4%B9%88AOP%E4%B8%AD%E6%89%A7%E8%A1%8C%E7%8E%AF%E7%BB%95%E7%9A%84%E6%96%B9%E6%B3%95%E4%BC%9A%E5%9C%A8%E6%89%93%E5%8D%B0%E5%89%8D/" class="post-title-link" itemprop="url">聊聊为什么AOP中执行环绕的方法会在打印前</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2022-07-17 15:13:29 / Modified: 15:28:32" itemprop="dateCreated datePublished" datetime="2022-07-17T15:13:29+08:00">2022-07-17</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>这一篇的内容属于有感而发，起初是在实现 AOP 时出现了 after 和 before 的打印在一起，如下：</p>
<p>测试代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testOne</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">    UserMapper userMapper = context.getBean(<span class="string">&quot;userMapper&quot;</span>, UserMapper.class);</span><br><span class="line"></span><br><span class="line">    ArrayList&lt;User&gt; userList = userMapper.getUserList();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> ( User user : userList )&#123;</span><br><span class="line">        System.out.println( user.toString() );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    userMapper.deleteUser( <span class="number">10</span> );</span><br><span class="line">    userMapper.addUser( <span class="keyword">new</span> User( <span class="number">10</span>, <span class="string">&quot;测试员&quot;</span>, <span class="string">&quot;1234567&quot;</span> ) );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">==================== 方法执行前 ====================</span><br><span class="line">==================== 方法执行后 ====================</span><br><span class="line">User(userId=1, userName=管理员, userPWD=1234567)</span><br><span class="line">User(userId=2, userName=李四, userPWD=ycy856249)</span><br><span class="line">User(userId=3, userName=张三, userPWD=1234567)</span><br><span class="line">User(userId=4, userName=李六, userPWD=1234567)</span><br><span class="line">User(userId=10, userName=测试员, userPWD=1234567)</span><br><span class="line">User(userId=16, userName=测试员, userPWD=1234567)</span><br><span class="line">==================== 方法执行前 ====================</span><br><span class="line">==================== 方法执行后 ====================</span><br><span class="line">==================== 方法执行前 ====================</span><br><span class="line">==================== 方法执行后 ====================</span><br></pre></td></tr></table></figure>



<p>起初我认为，这是 applicationContext.xml 的配置问题，但在开启日志后我发现，这并没有问题，日志如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">&quot;C:\Program Files\Java\jdk-14.0.1\bin\java.exe&quot; -ea -Didea.test.cyclic.buffer.size=1048576 &quot;-javaagent:D:\IntelliJ IDEA\lib\idea_rt.jar=64842:D:\IntelliJ IDEA\bin&quot; -Dfile.encoding=UTF-8 -classpath &quot;D:\IntelliJ IDEA\lib\idea_rt.jar;D:\IntelliJ IDEA\plugins\junit\lib\junit5-rt.jar;D:\IntelliJ IDEA\plugins\junit\lib\junit-rt.jar;C:\Users\Arsh\Desktop\WorkTest\Spring_AOP2\target\test-classes;C:\Users\Arsh\Desktop\WorkTest\Spring_AOP2\target\classes;D:\apache-maven-3.8.4\maven-repo\org\aspectj\aspectjweaver\1.9.9.1\aspectjweaver-1.9.9.1.jar;D:\apache-maven-3.8.4\maven-repo\org\springframework\spring-webmvc\5.3.21\spring-webmvc-5.3.21.jar;D:\apache-maven-3.8.4\maven-repo\org\springframework\spring-aop\5.3.21\spring-aop-5.3.21.jar;D:\apache-maven-3.8.4\maven-repo\org\springframework\spring-beans\5.3.21\spring-beans-5.3.21.jar;D:\apache-maven-3.8.4\maven-repo\org\springframework\spring-context\5.3.21\spring-context-5.3.21.jar;D:\apache-maven-3.8.4\maven-repo\org\springframework\spring-core\5.3.21\spring-core-5.3.21.jar;D:\apache-maven-3.8.4\maven-repo\org\springframework\spring-jcl\5.3.21\spring-jcl-5.3.21.jar;D:\apache-maven-3.8.4\maven-repo\org\springframework\spring-expression\5.3.21\spring-expression-5.3.21.jar;D:\apache-maven-3.8.4\maven-repo\org\springframework\spring-web\5.3.21\spring-web-5.3.21.jar;D:\apache-maven-3.8.4\maven-repo\org\springframework\spring-jdbc\5.3.21\spring-jdbc-5.3.21.jar;D:\apache-maven-3.8.4\maven-repo\org\springframework\spring-tx\5.3.21\spring-tx-5.3.21.jar;D:\apache-maven-3.8.4\maven-repo\org\mybatis\mybatis-spring\2.0.7\mybatis-spring-2.0.7.jar;D:\apache-maven-3.8.4\maven-repo\mysql\mysql-connector-java\8.0.28\mysql-connector-java-8.0.28.jar;D:\apache-maven-3.8.4\maven-repo\com\google\protobuf\protobuf-java\3.11.4\protobuf-java-3.11.4.jar;D:\apache-maven-3.8.4\maven-repo\org\mybatis\mybatis\3.5.6\mybatis-3.5.6.jar;D:\apache-maven-3.8.4\maven-repo\org\projectlombok\lombok\1.18.12\lombok-1.18.12.jar;D:\apache-maven-3.8.4\maven-repo\junit\junit\4.13.1\junit-4.13.1.jar;D:\apache-maven-3.8.4\maven-repo\org\hamcrest\hamcrest-core\1.3\hamcrest-core-1.3.jar&quot; com.intellij.rt.junit.JUnitStarter -ideVersion5 -junit4 MyTest,testOne</span><br><span class="line">Logging initialized using &#x27;class org.apache.ibatis.logging.stdout.StdOutImpl&#x27; adapter.</span><br><span class="line">==================== 方法执行前 ====================</span><br><span class="line">Creating a new SqlSession</span><br><span class="line">Registering transaction synchronization for SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@39ab59f8]</span><br><span class="line">JDBC Connection [com.mysql.cj.jdbc.ConnectionImpl@ca66933] will be managed by Spring</span><br><span class="line">==&gt;  Preparing: select * from mybatis.user;</span><br><span class="line">==&gt; Parameters: </span><br><span class="line">&lt;==    Columns: id, name, password</span><br><span class="line">&lt;==        Row: 1, 管理员, 1234567</span><br><span class="line">&lt;==        Row: 2, 李四, ycy856249</span><br><span class="line">&lt;==        Row: 3, 张三, 1234567</span><br><span class="line">&lt;==        Row: 4, 李六, 1234567</span><br><span class="line">&lt;==        Row: 10, 测试员, 1234567</span><br><span class="line">&lt;==        Row: 16, 测试员, 1234567</span><br><span class="line">&lt;==      Total: 6</span><br><span class="line">Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@39ab59f8]</span><br><span class="line">==================== 方法执行后 ====================</span><br><span class="line">Transaction synchronization committing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@39ab59f8]</span><br><span class="line">Transaction synchronization deregistering SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@39ab59f8]</span><br><span class="line">Transaction synchronization closing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@39ab59f8]</span><br><span class="line">User(userId=1, userName=管理员, userPWD=1234567)</span><br><span class="line">User(userId=2, userName=李四, userPWD=ycy856249)</span><br><span class="line">User(userId=3, userName=张三, userPWD=1234567)</span><br><span class="line">User(userId=4, userName=李六, userPWD=1234567)</span><br><span class="line">User(userId=10, userName=测试员, userPWD=1234567)</span><br><span class="line">User(userId=16, userName=测试员, userPWD=1234567)</span><br><span class="line">==================== 方法执行前 ====================</span><br><span class="line">Creating a new SqlSession</span><br><span class="line">Registering transaction synchronization for SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@ddf20fd]</span><br><span class="line">JDBC Connection [com.mysql.cj.jdbc.ConnectionImpl@695a69a1] will be managed by Spring</span><br><span class="line">==&gt;  Preparing: delete from mybatis.user where id = ?</span><br><span class="line">==&gt; Parameters: 10(Integer)</span><br><span class="line">&lt;==    Updates: 1</span><br><span class="line">Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@ddf20fd]</span><br><span class="line">==================== 方法执行后 ====================</span><br><span class="line">Transaction synchronization committing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@ddf20fd]</span><br><span class="line">Transaction synchronization deregistering SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@ddf20fd]</span><br><span class="line">Transaction synchronization closing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@ddf20fd]</span><br><span class="line">==================== 方法执行前 ====================</span><br><span class="line">Creating a new SqlSession</span><br><span class="line">Registering transaction synchronization for SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@69cac930]</span><br><span class="line">JDBC Connection [com.mysql.cj.jdbc.ConnectionImpl@5d39f2d8] will be managed by Spring</span><br><span class="line">==&gt;  Preparing: insert into mybatis.user(id, name, password) values (?, ?, ?)</span><br><span class="line">==&gt; Parameters: 10(Integer), 测试员(String), 1234567(String)</span><br><span class="line">&lt;==    Updates: 1</span><br><span class="line">Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@69cac930]</span><br><span class="line">==================== 方法执行后 ====================</span><br><span class="line">Transaction synchronization committing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@69cac930]</span><br><span class="line">Transaction synchronization deregistering SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@69cac930]</span><br><span class="line">Transaction synchronization closing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@69cac930]</span><br></pre></td></tr></table></figure>

<p>可以看出，环绕的确实在方法前和方法后执行的，之所以会出现打印前是因为：<strong>打印代码并不在方法体内！</strong></p>
<p>由于打印不在方法内部，自然不会被环绕包含。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/07/12/Spring%E5%AD%A6%E4%B9%A0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="神秘的世界">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/07/12/Spring%E5%AD%A6%E4%B9%A0/" class="post-title-link" itemprop="url">Spring学习</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-07-12 12:16:10" itemprop="dateCreated datePublished" datetime="2022-07-12T12:16:10+08:00">2022-07-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-07-21 18:26:49" itemprop="dateModified" datetime="2022-07-21T18:26:49+08:00">2022-07-21</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Spring-官方文档"><a href="#Spring-官方文档" class="headerlink" title="Spring 官方文档"></a>Spring 官方文档</h1><p><a target="_blank" rel="noopener" href="https://www.docs4dev.com/docs/zh/spring-framework/5.1.3.RELEASE/reference">https://www.docs4dev.com/docs/zh/spring-framework/5.1.3.RELEASE/reference</a></p>
<h1 id="一、Spring"><a href="#一、Spring" class="headerlink" title="一、Spring"></a>一、Spring</h1><h2 id="1-1-Spring-的简介"><a href="#1-1-Spring-的简介" class="headerlink" title="1.1 Spring 的简介"></a>1.1 Spring 的简介</h2><p>Spring框架是一个 <a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%BC%80%E6%94%BE%E6%BA%90%E4%BB%A3%E7%A0%81/114160">开放源代码</a> 的 <a target="_blank" rel="noopener" href="https://baike.baidu.com/item/J2EE/110838">J2EE </a>应用程序框架，由 [Rod Johnson](<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/Rod">https://baike.baidu.com/item/Rod</a> Johnson/1423612) 发起。</p>
<p>是针对bean的生命周期进行管理的轻量级容器（lightweight container）。</p>
<p>使用 Spring 需要导入的包很多，毕竟 Spring 是一个集合了各种技术的大杂烩。但在现阶段下，导入 Spring Web 和 Spring JDBC 就足以。剩余的包，可以利用 Maven 自动导入的机制导入。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- Spring Web 相关包 --&gt;</span><br><span class="line">    &lt;!-- https://mvnrepository.com/artifact/org.springframework/spring-webmvc --&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;5.3.21&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- Spring JDBC 相关包 --&gt;</span><br><span class="line">&lt;!-- https://mvnrepository.com/artifact/org.springframework/spring-jdbc --&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-jdbc&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;5.3.21&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<h2 id="1-2-Spring-的组成"><a href="#1-2-Spring-的组成" class="headerlink" title="1.2 Spring 的组成"></a>1.2 Spring 的组成</h2><p>Spring 由 <a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_37899908/article/details/114211943">七大模块</a> 组成，分别是 spring Core、Spring Context、Spring <a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=AOP&spm=1001.2101.3001.7020">AOP</a>、Spring ORM、Spring Dao、Spring MVC、spring web</p>
<p><strong>spring Core</strong>（核心容器）：核心容器提供 Spring 框架的基本功能。</p>
<p>​                                                 核心容器的主要组件是 BeanFactory，它是工厂模式的实现。BeanFactory 使用控制反转 （IOC）模式将应用程序的配置和依赖性规范与实际的应用程序代码分开。</p>
<p><strong>Spring Context</strong> （Spring上下文）：一个核心配置文件，为Spring框架提供上下文信息。</p>
<p>​                                                                Spring 上下文包括企业服务，例如 JNDI、EJB、电子邮件、国际化、校验和调度功能。</p>
<p><strong>Spring AOP</strong>：集成了面向切面的编程功能。</p>
<p>​                      （AOP把一个业务流程分成几部分，例如权限检查、业务处理、日志记录， 每个部分单独处理，然后把它们组装成完整的业务流程。每个部分被称为切面），可以将声明性事物管理集成到应用程序中。</p>
<p><strong>Spring DAO</strong>：Spring操作数据库的模块。</p>
<p>​                          它可消除冗长的JDBC编码和解析数据库厂商特有的错误代码，它可消除冗长的JDBC编码和解析数据库厂商特有的错误代码JDBC DAO 抽象层提供了有意义的异常层次结构，可用该结构来管理异常处理和不同数据库供应商抛出的错误消息。</p>
<p>​                          异常层次结构简化了错误处理，并且极大地降低了需要编写的异常代码数量（例如打开和关闭连接）。</p>
<p>​                          Spring DAO 的面向 JDBC 的异常遵从通用的 DAO 异常层次结构。</p>
<p><strong>Spring ORM</strong>：Spring 框架插入了若干个 ORM 框架，从而提供了 ORM 的对象关系工具。</p>
<p>​                          其中包括 JDO、Hibernate 和 iBatis SQL Map。所有这些都遵从 Spring 的通用事务和 DAO 异常层次结构。</p>
<p><strong>Spring Web</strong> ：集成各种优秀的web层框架的模块。</p>
<p>​                           Web 上下文模块建立在应用程序上下文模块之上，为基于 Web 的应用程序提供了上下文。所以，Spring 框架支持与 Jakarta Struts 的集成。Web 模块还简化了处理多部分请求以及将请求参数绑定到域对象的工作。</p>
<p><strong>Spring MVC</strong> 框架：MVC 框架是一个全功能的构建 Web 应用程序的 MVC 实现。</p>
<p>​                                  通过策略接口，MVC 框架变成为高度可配置的，MVC 容纳了大量视图技术，其中包括 JSP、Velocity、Tiles、iText 和 POI。</p>
<p>Spring 框架的功能可以用在任何 J2EE 服务器中，大多数功能也适用于不受管理的环境。Spring 的核心要点是：支持不绑定到特定 J2EE 服务的可重用业务和数据访问对象。毫无疑问，这样的对象可以在不同 J2EE 环境 （Web 或 EJB）、独立应用程序、测试环境之间重用。</p>
<h1 id="二、IOC-控制反转"><a href="#二、IOC-控制反转" class="headerlink" title="二、IOC 控制反转"></a>二、IOC 控制反转</h1><h2 id="2-1-IOC-理论推导"><a href="#2-1-IOC-理论推导" class="headerlink" title="2.1 IOC 理论推导"></a>2.1 IOC 理论推导</h2><p>在讨论 IOC 的理论推导前，我们回顾一下原本编写代码的路线：</p>
<p>Dao层接口 -&gt; Dao层接口的实现类 -&gt; 服务层接口 -&gt; 服务层接口的实现类 ，大致的代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">public interface UserDao &#123;</span><br><span class="line">    public void getUser();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public class UserDaoImplByCommon implements UserDao &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void getUser() &#123;</span><br><span class="line">        System.out.println( &quot;获取用户名 以 普通 方式&quot; );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public interface UserService &#123;</span><br><span class="line">    public void getUser();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public class UserServiceImpl implements UserService &#123;</span><br><span class="line"></span><br><span class="line">    UserDao userDao = new UserDaoImplByCommon();</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void getUser() &#123;</span><br><span class="line">        userDao.getUser();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以看见，代码在 UserServiceImpl 位置，为了调用 Dao 层的代码，于是将这里的 userDao 直接赋值写死了。</p>
<p>这种方式虽然简单，但是如果用户需要更换 Dao 层的实现，比如使用 MySQL 或者 Orcale 亦或者突然改用 SQLServer，此时就需要改动</p>
<p>源代码，当代码量变得极为庞大时，就会导致效率低下。</p>
<p>这是由于这段代码体现的思想是  ：</p>
<ul>
<li>由程序主动控制创建对象。</li>
<li>程序猿拥有控制权。</li>
</ul>
<p>现在，我们提出一种解决方法：使用 set 注入方法来降低代码的耦合性。在服务层修改代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">UserDao userDao = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUserDao</span><span class="params">( UserDao userDao )</span></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.userDao = userDao;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这样，在用户需要修改需求时，就可以通过 set 的方式来完成。从而避免了大量修改底层代码的操作，例如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">userService.setUserDao( <span class="keyword">new</span> UserDaoImplByCommon() );</span><br><span class="line">userService.setUserDao( <span class="keyword">new</span> UserDaoImplByMySQL() );</span><br><span class="line">userService.setUserDao( <span class="keyword">new</span> UserDaoImplBySQLServer() );</span><br><span class="line">userService.getUser();</span><br></pre></td></tr></table></figure>

<p>这里就凸显了 IOC 控制反转的思想：</p>
<ul>
<li>由用户主动控制船舰对象。</li>
<li>程序员不再拥有程序的控制权。</li>
</ul>
<h2 id="2-1-IOC-本质"><a href="#2-1-IOC-本质" class="headerlink" title="2.1 IOC 本质"></a>2.1 IOC 本质</h2><p>IOC 本质上一种编程思想，我们常说的 DI （依赖注入） 就是实现 IOC 的一种方式。</p>
<p>控制反转IOC 是一种通过描述（ XML 或者 注解 ）并通过第三方生产获取特定对象的方式。</p>
<p>在 Spring 种实现控制反转的 IOC 容器，其实现方式是依赖注入（ DI ）。 </p>
<h1 id="三、第一个-Spring-代码"><a href="#三、第一个-Spring-代码" class="headerlink" title="三、第一个 Spring 代码"></a>三、第一个 Spring 代码</h1><h2 id="3-1-配置元数据"><a href="#3-1-配置元数据" class="headerlink" title="3.1 配置元数据"></a>3.1 配置元数据</h2><p>Spring IOC 容器使用一种形式的配置元数据。</p>
<p>此配置元数据表示您作为应用程序开发人员如何告诉 Spring 容器实例化，配置和组装应用程序中的对象。</p>
<p>默认的，将相对应的 XML 文件命名为 applicationContext.xml，相应的 XML 文件如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在上面配置元数据的 xml 文件中，我们常使用的就是 Bean 标签，该标签对应 Java 中的原始类。使用的方法如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String userName;</span><br><span class="line">    <span class="keyword">private</span> String userCode;</span><br><span class="line">    <span class="keyword">private</span> String userPassWord;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;User&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.EveArsh.pojo.User&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;userCode&quot;</span> <span class="attr">value</span>=<span class="string">&quot;001&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;userName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;测试员-A&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;userPassWord&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1234567&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>下面描述一下和 Spring 相关的配置文件的标签：</p>
<table>
<thead>
<tr>
<th align="center"><strong>Bean</strong></th>
<th align="center"><strong>框架在运行时管理</strong>的对象</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><strong>id</strong></td>
<td align="center"><strong>Bean中注册的标签值</strong></td>
</tr>
<tr>
<td align="center"><strong>class</strong></td>
<td align="center"><strong>Java原始类的路径</strong></td>
</tr>
<tr>
<td align="center"><strong>property</strong></td>
<td align="center"><strong>Java原始类的标签映射</strong></td>
</tr>
<tr>
<td align="center"><strong>name</strong></td>
<td align="center"><strong>Java原始类中的属性</strong></td>
</tr>
<tr>
<td align="center"><strong>value</strong></td>
<td align="center"><strong>直接对Java原始类赋予值</strong></td>
</tr>
<tr>
<td align="center"><strong>ref</strong></td>
<td align="center"><strong>对Java原始类赋予Bean中已经注册的值连接</strong></td>
</tr>
</tbody></table>
<h2 id="3-2-实例化容器"><a href="#3-2-实例化容器" class="headerlink" title="3.2 实例化容器"></a><strong>3.2 实例化容器</strong></h2><p>提供给 ApplicationContext 构造函数的位置路径是资源字符串，这些资源字符串使容器可以从各种外部资源(例如本地文件系统，Java <code>CLASSPATH</code>等) 加载配置元数据。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;applicationContext.xml&quot;</span> );</span><br></pre></td></tr></table></figure>



<p>在实例化容器后，就可以通过 getBean 函数来获取在 applicationContext.xml 中配置的值，如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User user = (User) context.getBean(<span class="string">&quot;User&quot;</span>);</span><br></pre></td></tr></table></figure>



<h1 id="四、IOC-创建对象"><a href="#四、IOC-创建对象" class="headerlink" title="四、IOC 创建对象"></a>四、IOC 创建对象</h1><h2 id="4-1-IOC-创建对象的四种方式"><a href="#4-1-IOC-创建对象的四种方式" class="headerlink" title="4.1 IOC 创建对象的四种方式"></a>4.1 IOC 创建对象的四种方式</h2><p>在使用 IOC 容器时，有四种常用的创建对象的方式。</p>
<h3 id="4-1-1-默认构造"><a href="#4-1-1-默认构造" class="headerlink" title="4.1.1 默认构造"></a>4.1.1 默认构造</h3><p>在 Spring 中，默认的构造就是无参构造。</p>
<p>若对应的类中没有无参构造的方法，那么配置文件就会报错 。</p>
<figure class="highlight xml"><figcaption><span><beans></beans></span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">beans</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;student&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.EveArsh.pojo.Student&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>若没有无参构造，则会报告以下错误：在类 ‘XXX’ 中找不到匹配的构造函数。</p>
<h3 id="4-1-2-下标赋值构造"><a href="#4-1-2-下标赋值构造" class="headerlink" title="4.1.2 下标赋值构造"></a>4.1.2 下标赋值构造</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;student&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.EveArsh.pojo.Student&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;0&quot;</span> <span class="attr">value</span>=<span class="string">&quot;studentName&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;1&quot;</span> <span class="attr">value</span>=<span class="string">&quot;studentName&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;2&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;teacher&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>对应的原始类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String studentName;</span><br><span class="line">    <span class="keyword">private</span> String studentCode;</span><br><span class="line">    <span class="keyword">private</span> Teacher teacher;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用下标赋值是 IOC 创建对象的第一种方式。</p>
<p>在这种方式中，index 标签代表着参数在原始类中声明的顺序，这种方式便于书写，但相对的无法看见值对应的参数的类型。</p>
<h3 id="4-1-3-通过类型创建"><a href="#4-1-3-通过类型创建" class="headerlink" title="4.1.3 通过类型创建"></a>4.1.3 通过类型创建</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;student&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.EveArsh.pojo.Student&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">type</span>=<span class="string">&quot;java.lang.String&quot;</span> <span class="attr">value</span>=<span class="string">&quot;studentName&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">type</span>=<span class="string">&quot;java.lang.String&quot;</span> <span class="attr">value</span>=<span class="string">&quot;studentCode&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">type</span>=<span class="string">&quot;com.EveArsh.pojo.Teacher&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;teacher&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>对应的原始类和 4.1.2 中的原始类相同。</p>
<p>使用类型赋值是 IOC 创建对象的第二种方式。</p>
<p>在这种方式中，type 代表着参数的类型，并且在这种方式中 type 中的类型必须为全限定类名，不可以设置别名。另外，这种方式虽然明确了参数的类型，但是相对的无法明确是哪一个参数。</p>
<p>就例如在上面的例子中，studentName 和 studentCode 都是 String 类型，无法明确是哪一个值。</p>
<h3 id="4-1-4-参数名设置"><a href="#4-1-4-参数名设置" class="headerlink" title="4.1.4 参数名设置"></a>4.1.4 参数名设置</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;student&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.EveArsh.pojo.Student&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;studentName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;studentName&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;studentCode&quot;</span> <span class="attr">value</span>=<span class="string">&quot;studentCode&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;teacher&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;teacher&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>对应的原始类和 4.1.2 中的原始类相同。</p>
<p>使用参数名赋值是 IOC 创建对象的第三种方式。</p>
<p>在这种方式中，name 代表着对应的参数名，value 则直接是赋予 name 的值。这也是三种方法中最直接的方法。</p>
<h2 id="4-2-IOC-创建对象获取的特性"><a href="#4-2-IOC-创建对象获取的特性" class="headerlink" title="4.2 IOC 创建对象获取的特性"></a>4.2 IOC 创建对象获取的特性</h2><p>我们在 Bean 中创建两个 IOC 的对象，并同时获取，可以窥见 IOC 创建对象的一些特性，代码如下：</p>
<p>applicationContext.xml  文件配置：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">beans</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;student&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.EveArsh.pojo.Student&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;studentName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;studentName&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;studentCode&quot;</span> <span class="attr">value</span>=<span class="string">&quot;studentCode&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;teacher&quot;</span> <span class="attr">value</span>=<span class="string">&quot;teacher&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;teacher&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.EveArsh.pojo.Teacher&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;teacherName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;teacherName&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;teacherCode&quot;</span> <span class="attr">value</span>=<span class="string">&quot;teacherCode&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;students&quot;</span> <span class="attr">value</span>=<span class="string">&quot;students&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>测试类中的代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Student student = (Student) context.getBean(<span class="string">&quot;student&quot;</span>);</span><br><span class="line">Student student2 = (Student) context.getBean(<span class="string">&quot;student&quot;</span>);</span><br><span class="line"></span><br><span class="line">System.out.println( student == student2 );</span><br></pre></td></tr></table></figure>

<p>通过控制台的输出可以看见，student 和 student2 其实是同一个对象。</p>
<p>也就是说，原始类在 XML 文件中注册时就已经被集体生成了，后来只是在测试类中按需调用即可。</p>
<h1 id="五、Spring-配置"><a href="#五、Spring-配置" class="headerlink" title="五、Spring 配置"></a>五、Spring 配置</h1><h2 id="5-1-Spring-–-alias-别名"><a href="#5-1-Spring-–-alias-别名" class="headerlink" title="5.1 Spring – alias 别名"></a>5.1 Spring – alias 别名</h2><p>我们可以在 applicationContext.xml  文件配置中设置 Bean 注册的别名。例如：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">alias</span> <span class="attr">name</span>=<span class="string">&quot;teacher&quot;</span> <span class="attr">alias</span>=<span class="string">&quot;teacherAlias&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">alias</span> <span class="attr">name</span>=<span class="string">&quot;student&quot;</span> <span class="attr">alias</span>=<span class="string">&quot;studentAlias&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>在使用了别名后，就可以在测试类中使用别名，例如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Student student = (Student) context.getBean(<span class="string">&quot;studentAlias&quot;</span>);</span><br><span class="line">Teacher teacher = (Teacher) context.getBean(<span class="string">&quot;teacherAlias&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>其实这么看来，别名的意义在于给测试类通过其他的注册方式。</p>
<p>另外，alias 配置必须在 Bean 配置之前。</p>
<h2 id="5-2-Spring-–-Bean-配置"><a href="#5-2-Spring-–-Bean-配置" class="headerlink" title="5.2 Spring – Bean 配置"></a>5.2 Spring – Bean 配置</h2><p>在 Spring 中，Bean 标签除了之前的配置外，还有一些其他的配置。</p>
<h3 id="5-2-1-name-属性"><a href="#5-2-1-name-属性" class="headerlink" title="5.2.1 name 属性"></a>5.2.1 name 属性</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;student&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.EveArsh.pojo.Student&quot;</span> <span class="attr">name</span>=<span class="string">&quot;studentAlis&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;studentName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;studentName&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;studentCode&quot;</span> <span class="attr">value</span>=<span class="string">&quot;studentCode&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;teacher&quot;</span> <span class="attr">value</span>=<span class="string">&quot;teacher&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>如上方的代码所示，在 bean 标签中使用了 name 属性，这种做法和使用 alias 别名相同。</p>
<p>并且，如果使用 name 属性的方式来启用别名，则可以一次性设置多个别名，例如：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;student&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.EveArsh.pojo.Student&quot;</span> <span class="attr">name</span>=<span class="string">&quot;studentAlis, student2&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;studentName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;studentName&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;studentCode&quot;</span> <span class="attr">value</span>=<span class="string">&quot;studentCode&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;teacher&quot;</span> <span class="attr">value</span>=<span class="string">&quot;teacher&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在这种方式下，所有在 name 属性注册的别名都可以使用，与 alias 的效果相同。</p>
<h2 id="5-2-2-scope-属性"><a href="#5-2-2-scope-属性" class="headerlink" title="5.2.2 scope 属性"></a>5.2.2 scope 属性</h2><p>scope 属性是 Bean 标签配置下用于规范其作用范围的属性。其用法也十分简单：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;student&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.EveArsh.pojo.Student&quot;</span> <span class="attr">scope</span>=<span class="string">&quot;request&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;studentName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;studentName&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;studentCode&quot;</span> <span class="attr">value</span>=<span class="string">&quot;studentCode&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;teacher&quot;</span> <span class="attr">value</span>=<span class="string">&quot;teacher&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>singleton：表示整个IOC容器共享一个Bean，也就是说每次说每次通过getBean获取的bean都是同一个。</p>
<p>prototype：每次对该bean请求（ 将其注入到另一个bean中，或者以程序的方式调用容器的 getBean() 方法 ）时都会创建一个新的bean实例。</p>
<p>request：每次HTTP请求将会生成各自的bean实例。</p>
<p>session：每次会话请求对应一个bean实例。</p>
<p>singleton和prototype经常使用，request和session基本不使用。</p>
<h2 id="5-3-Spring-–-import-导入"><a href="#5-3-Spring-–-import-导入" class="headerlink" title="5.3 Spring – import 导入"></a>5.3 Spring – import 导入</h2><p>import 导入的用处往往都是在团队开发中才会被使用。</p>
<p>其作用是将不同的 XML 文件汇总集合到同一个 XML 文件中，方便开发的使用。例如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="keyword">import</span> resource=<span class="string">&quot;applicationContext.xml&quot;</span>/&gt;</span><br></pre></td></tr></table></figure>

<p>在上方的代码被写入到 XML 文件后，就可以在代码中使用指定的 XML 文件。</p>
<h1 id="六、DI-依赖注入"><a href="#六、DI-依赖注入" class="headerlink" title="六、DI 依赖注入"></a>六、DI 依赖注入</h1><p>DI—Dependency Injection，即“<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5&spm=1001.2101.3001.7020">依赖注入</a>”。</p>
<p>组件之间依赖关系由容器在运行期决定，形象的说，即由容器动态的将某个依赖关系注入到组件之中。</p>
<p>依赖注入的目的并非为软件系统带来更多功能，而是为了提升组件重用的频率，并为系统搭建一个灵活、可扩展的平台。</p>
<p>通过依赖注入机制，我们只需要通过简单的配置，而无需任何代码就可指定目标需要的资源，完成自身的业务逻辑，而不需要关心具体的资源来自何处，由谁实现。</p>
<p>依赖注入主要依靠三种方法：</p>
<ul>
<li>构造器注入</li>
<li>Set 方式注入</li>
<li>其他注入</li>
</ul>
<h2 id="6-1-构造器注入"><a href="#6-1-构造器注入" class="headerlink" title="6.1 构造器注入"></a>6.1 构造器注入</h2><p>构造器注入的方式，我们在 <strong>第二节 IOC理论推导</strong> 的部分就已经使用了 构造器注入 的方式。</p>
<p>我们在此就不再进行讨论。</p>
<h2 id="6-2-Set方式注入"><a href="#6-2-Set方式注入" class="headerlink" title="6.2 Set方式注入"></a>6.2 Set方式注入</h2><p>Set 方式注入支持许多的类型注入，主要有：</p>
<table>
<thead>
<tr>
<th align="center">bean</th>
<th align="center">ref</th>
<th align="center">idref</th>
<th align="center">list</th>
<th align="center">set</th>
<th align="center">map</th>
<th align="center">props</th>
<th align="center">value</th>
<th align="center">null</th>
</tr>
</thead>
</table>
<p>下面实现以下各种类型的注入，在此之前，需要注意的是：</p>
<p><strong>不知为何，在使用 IDEA 时，list，map 还有 set 在注入时会报告 ‘java.util.XXXXX’  类型的属性不能由 ‘XXX’ 注入 的错误。</strong></p>
<ul>
<li><p>ref 类型注入：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;teacher&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;teacher&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>这种注入属于是普通类的注入方式，但这种方式只能适用于普通的复杂类。</p>
</li>
<li><p>list 类型注入：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;studentWork&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>数学<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>语文<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>科学<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>set 类型注入：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;studentHobby&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>抽烟<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>喝酒<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>烫头<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>map  类型注入：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;studentGrade&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">map</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;MathGrade&quot;</span> <span class="attr">value</span>=<span class="string">&quot;100&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;ChineseGrade&quot;</span> <span class="attr">value</span>=<span class="string">&quot;100&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;EnglishGrade&quot;</span> <span class="attr">value</span>=<span class="string">&quot;100&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>value 类型注入：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;studentName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;学生姓名&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>value 类型注入在大部分时候都属于直接赋值，不过需要一提的是 constructor-arg 表示通过构造器注入，而 property 是使用 Set 方式注入。</p>
</li>
<li><p>properties 类型注入：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;properties&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;root&quot;</span>&gt;</span>localhost<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;password&quot;</span>&gt;</span>1234567<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>null 类型注入：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;studentName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span>/&gt;</span> <span class="comment">&lt;!-- 这种方式下，studentName 的值被设置为空串，并非Null值 --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 这种方式下，studentName 的值被设置为 Null 值 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;studentName&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">null</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="6-3-扩展注入"><a href="#6-3-扩展注入" class="headerlink" title="6.3 扩展注入"></a>6.3 扩展注入</h2><p>一般的扩展注入主要有两种形式 P - namepase 和 C - namepase</p>
<h3 id="6-3-1-P-namepase"><a href="#6-3-1-P-namepase" class="headerlink" title="6.3.1 P - namepase"></a>6.3.1 P - namepase</h3><p>在使用 P - namepase 前，需要提前将对应的约束添加到元数据的配置中。并且使用 p 标签的 bean 标签对应的类<strong>必须有无参构造</strong>。</p>
<p>需添加的约束：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xmlns:p=&quot;http://www.springframework.org/schema/p&quot;</span><br></pre></td></tr></table></figure>

<p>添加后的元数据配置：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:p</span>=<span class="string">&quot;http://www.springframework.org/schema/p&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>在添加配置后，就可以在 Bean 标签中使用 P 标签，如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.EveArsh.pojo.User&quot;</span> <span class="attr">p:userName</span>=<span class="string">&quot;测试员&quot;</span> <span class="attr">p:userCode</span>=<span class="string">&quot;1101&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>这样就可以直接在 bean 标签中直接赋予值。</p>
<h3 id="6-3-2-C-namepase"><a href="#6-3-2-C-namepase" class="headerlink" title="6.3.2 C - namepase"></a>6.3.2 C - namepase</h3><p>在使用 C - namepase 前，需要提前将对应的约束添加到元数据的配置中。并且使用 C 标签的 bean 标签对应的类<strong>必须为有参构造</strong>。</p>
<p>需添加的约束：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xmlns:c=&quot;http://www.springframework.org/schema/c&quot;</span><br></pre></td></tr></table></figure>

<p>添加后的元数据配置：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:c</span>=<span class="string">&quot;http://www.springframework.org/schema/c&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>在添加配置后，就可以在 Bean 标签中使用 C 标签，如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.EveArsh.pojo.User&quot;</span> <span class="attr">c:userCode</span>=<span class="string">&quot;1101&quot;</span> <span class="attr">c:userName</span>=<span class="string">&quot;Name&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>这样就可以直接在 bean 标签中直接赋予值。</p>
<p>另外，如果使用 C 扩展，那么除了使用参数名赋值，也可以使用下标赋值，例如：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.EveArsh.pojo.User&quot;</span> <span class="attr">c:_0</span>=<span class="string">&quot;1101&quot;</span> <span class="attr">c:_1</span>=<span class="string">&quot;Name&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>使用方式和正常的下标赋值相同。</p>
<h2 id="6-4-Bean-的作用域（生命周期）"><a href="#6-4-Bean-的作用域（生命周期）" class="headerlink" title="6.4 Bean 的作用域（生命周期）"></a>6.4 Bean 的作用域（生命周期）</h2><p>Bean拥有六大作用域，分别是：</p>
<table>
<thead>
<tr>
<th align="center"><strong>singleton (默认)</strong></th>
<th align="center"><strong>将单个 bean 定义限定为每个 Spring IoC 容器的单个对象实例</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="center"><strong>prototype</strong></td>
<td align="center"><strong>将单个 bean 定义限定为任意数量的对象实例</strong></td>
</tr>
<tr>
<td align="center"><strong>request</strong></td>
<td align="center"><strong>将单个 bean 定义限定为单个 HTTP 请求的生命周期</strong></td>
</tr>
<tr>
<td align="center"><strong>session</strong></td>
<td align="center"><strong>将单个 bean 定义限定为 HTTP 会话的生命周期，仅在web类型的 ApplicationContext有效</strong></td>
</tr>
<tr>
<td align="center"><strong>application</strong></td>
<td align="center"><strong>将单个 bean 定义限定为 ServletContext 的生命周期，仅在web类型的 ApplicationContext有效</strong></td>
</tr>
<tr>
<td align="center"><strong>websocket</strong></td>
<td align="center"><strong>将单个 bean 定义限定为 WebSocket 的生命周期，仅在web类型的 <code>ApplicationContext</code>有效。</strong></td>
</tr>
</tbody></table>
<p>另外，对于 <strong>request</strong>  作用域下的情况，有一点特别：每个 HTTP 请求都有自己的 bean 实例，该实例是在单个 bean 定义的后面创建的。仅在web类型的 ApplicationContext有效。</p>
<h2 id="6-5-Bean-的自动装配"><a href="#6-5-Bean-的自动装配" class="headerlink" title="6.5 Bean 的自动装配"></a>6.5 Bean 的自动装配</h2><p>常用的 Bean 的装配方式有三种，分别是：</p>
<ul>
<li>使用手动装配 Bean</li>
<li>使用 Java 装配 Bean</li>
<li>使用 Bean 的自动装配</li>
</ul>
<p>在这里我们着重讨论一下 Bean 的自动装配 ：Bean 的自动装配除了使用注解，还可以使用 Bean 标签内中的 autoware 属性来完成对 Bean 内属性的自动装配。</p>
<p>Java 原始类代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Dog</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">shout</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println( <span class="string">&quot;wang~&quot;</span> );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Cat</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">shout</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;miao~&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">People</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Dog dog;</span><br><span class="line">    <span class="keyword">private</span> Cat cat;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String peoName;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们以上方的代码为例子，研究 byName 和 byType 的不同。</p>
<h3 id="6-5-1-使用-autowire-–-byName-自动装配"><a href="#6-5-1-使用-autowire-–-byName-自动装配" class="headerlink" title="6.5.1 使用 autowire – byName 自动装配"></a>6.5.1 使用 autowire – byName 自动装配</h3><p>byName 会自动在容器上下文中查找，和自己对象set方法后面对应的 benid。</p>
<p>applicationContext.xml 文件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dog&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.EveArsh.pojo.Dog&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;cat&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.EveArsh.pojo.Cat&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;people&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.EveArsh.pojo.People&quot;</span> <span class="attr">autowire</span>=<span class="string">&quot;byName&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;peoName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;人&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>在上面的代码中，我们使用了 byName 的方式来完成对 Bean 的自动配置。</p>
<p>使用 byName 来配置 Bean 可以精确到原始类属性中的某个属性，并且，就算出现多个同类型的属性，也可也成功匹配。</p>
<p>byName 的原理是通过检查对于原始类的 set 函数后缀的类名是否与 bean 中的注册 id 可以匹配。若匹配则可以进行自动装配。</p>
<p>另外，如果 bean 中注册的 id 值和 set 函数后的类名不同，则无法进行自动装配。</p>
<h3 id="6-5-2-使用-autowire-–-byType-自动装配"><a href="#6-5-2-使用-autowire-–-byType-自动装配" class="headerlink" title="6.5.2 使用 autowire – byType 自动装配"></a>6.5.2 使用 autowire – byType 自动装配</h3><p>byType 会自动在容器上下文中查找，和自己对象属性对应的 class 路径。</p>
<p>applicationContext.xml 文件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dog&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.EveArsh.pojo.Dog&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;cat&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.EveArsh.pojo.Cat&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;people&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.EveArsh.pojo.People&quot;</span> <span class="attr">autowire</span>=<span class="string">&quot;byName&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;peoName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;人&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>在上面的代码中，我们使用了 byType 的方式来完成对 Bean 的自动配置。</p>
<p>使用 byType 来配置 Bean 可以精确到原始类属性中的某个类，但是、如果出现多个同类型的属性，就无法成功匹配。</p>
<p>byType 的原理是通过检查对于原始类的属性对应的类名是否与 bean 中的注册 class 可以匹配。若匹配则可以进行自动装配。</p>
<p>另外，如果 bean 中注册的 class 值和 原始类的属性对应的类名不同，则无法进行自动装配。</p>
<h3 id="6-5-3-byType-和-byName-的区别"><a href="#6-5-3-byType-和-byName-的区别" class="headerlink" title="6.5.3 byType 和 byName 的区别"></a>6.5.3 byType 和 byName 的区别</h3><ul>
<li>byName 的时候，需要保证所有的 Bean 的 id 一致， 并且这个 Bean 需要和自动注入的属性 Set 方法一致。</li>
<li>byType 的时候，需要保证所有 Bean 的 class 唯一，并且这个 Bean 需要和自动注入的属性的类型一致。</li>
</ul>
<h2 id="6-6-通过注解实现自动装配"><a href="#6-6-通过注解实现自动装配" class="headerlink" title="6.6 通过注解实现自动装配"></a>6.6 通过注解实现自动装配</h2><p>在使用注解前，需要在项目中添加前置的需求：</p>
<ul>
<li><p>配置注解的支持</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:annotation-config</span>/&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>导入约束 ： context 约束</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xmlns:context=&quot;http://www.springframework.org/schema/context&quot;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http://www.springframework.org/schema/beans</span><br><span class="line">http://www.springframework.org/schema/beans/spring-beans.xsd</span><br><span class="line">http://www.springframework.org/schema/context</span><br><span class="line">http://www.springframework.org/schema/context/spring-context.xsd</span><br></pre></td></tr></table></figure>

<p>导入后为：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:annotation-config</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="6-6-1-Autowired注解"><a href="#6-6-1-Autowired注解" class="headerlink" title="6.6.1 @Autowired注解"></a>6.6.1 @Autowired注解</h3><p>使用 Autowired 后，原始类代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">People</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> Dog dog;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> Cat cat;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String peoName;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>applicationContext.xml 文件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:annotation-config</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dog&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.EveArsh.pojo.Dog&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;cat&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.EveArsh.pojo.Cat&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;people&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.EveArsh.pojo.People&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;peoName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;测试员&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>使用了 @Autowried 注解后，系统会自己找寻注解所对应的类，完成自动装配。</p>
<p>推荐在属性上直接使用，也可以在 Set 方式上使用。</p>
<p>使用 @Autowried 的话，我们就可以不用 编写 set 方法，前提是你这个自动装配的属性在 IOC （ Spring ） 容器中存在，且符合名字。</p>
<p>综上所述，可以看出 @Autowired 注解理论上会默认使用 byTpye 方式进行自动装配。</p>
<h3 id="6-6-2-Qualifier注解"><a href="#6-6-2-Qualifier注解" class="headerlink" title="6.6.2 @Qualifier注解"></a>6.6.2 @Qualifier注解</h3><p>在上方使用 @Autowired 注解的过程中，如果出现了多项 Bean 注册，就会出现一些问题。例如：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dog&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.EveArsh.pojo.Dog&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dog11&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.EveArsh.pojo.Dog&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;cat&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.EveArsh.pojo.Cat&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;cat11&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.EveArsh.pojo.Cat&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>虽然 IDEA 在现在的版本下不会报错，但是会默认使用第一项 Bean 注册。</p>
<p>那么为了使用其他的 Bean 注册，我们就需要使用 @Qualifier 注解，如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="meta">@Qualifier( &quot;dog11&quot; )</span></span><br><span class="line"><span class="keyword">private</span> Dog dog;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Qualifier( &quot;cat11&quot; )</span></span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> Cat cat;</span><br></pre></td></tr></table></figure>

<p>在这种情况下，我们使用了 @Qualifier 注解。</p>
<p>使用过后，自动装配时，会优先使用 @Qualifier 注解所标记的 Bean 注册。</p>
<h3 id="6-6-3-Nollable注解"><a href="#6-6-3-Nollable注解" class="headerlink" title="6.6.3 @Nollable注解"></a>6.6.3 @Nollable注解</h3><p>如果这个注解应用于某个参数上，代表着这个参数可以为 Null，例如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Nullable</span></span><br><span class="line"><span class="keyword">private</span> String peoName;</span><br></pre></td></tr></table></figure>



<h1 id="七、使用注解开发"><a href="#七、使用注解开发" class="headerlink" title="七、使用注解开发"></a>七、使用注解开发</h1><p>使用注解开发前，一样的需要引入注解支持，此外，我们需要引入一个新的约束：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.EveArsh&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>该约束会让系统对指定的路径进行扫描，未被扫描到的包，无法成功的使用注解。</p>
<p>进行包的扫描后，可以使用 @Component 注解，来代替在原始类在XML文件中进行的 Bean 注册。使用 @Value 注解，来代替原本的简单类型注入。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="comment">// 一般情况下，对应的 Bean id 为这个类名的小写</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;张三&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String userName;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;1101&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String userCode;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>另外，要提到的是，@Value 并不能完成 <strong>复杂类型</strong> 或者 **Map，Set 类型 **的注入。</p>
<p>其次，@Component 注解是为了给 pojo 类提供扫描和注册使用的，这种注解还有相似的注解，作用相似，但是目的是供给给其他的层级使用，如 Dao 层、Service 层 和 Controller 层。例如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    <span class="comment">//...........代码块</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDao</span> </span>&#123;</span><br><span class="line">    <span class="comment">//...........代码块</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line">    <span class="comment">//...........代码块</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上方的三个相似注解，都是为了将对应的类注册到 Spring 中，进行装配。</p>
<h1 id="八、使用-Java-方式配置-Spring"><a href="#八、使用-Java-方式配置-Spring" class="headerlink" title="八、使用 Java 方式配置 Spring"></a>八、使用 Java 方式配置 Spring</h1><p>这意味着，我们将放弃通过 XML 文件来配置 Spring， 而是完全依靠 Java 的方式完成对 Spring 的配置。（ JavaConfig ）</p>
<p>首先，作为例子，我们需要一个 Java 原始类，加上 @Component 注解，声明该类可以被扫描：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;测试员&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String userName;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;1101&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String userCode;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在上方的代码处，我们已经完成了对整个类的扫描 和 简单的数据注入。</p>
<p>接下来，我们书写属于自己的 Config 类，下面是代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyConfig</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="comment">// 下方代码 与 Bean 注册等价</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">user</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> User();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在上方的代码中，我们使用了 @Bean 标签来对 User 类进行了注册，这种方式和在 XML 中使用 Bean 标签注册相同。</p>
<p>其中，函数名 对标 Bean标签中的 Id， 返回值对应 Bean标签中的 Class。需要调用时调用即可，测试类如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testOne</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ApplicationContext context = <span class="keyword">new</span> AnnotationConfigApplicationContext(MyConfig.class);</span><br><span class="line">    User user = context.getBean( <span class="string">&quot;user&quot;</span>, User.class );</span><br><span class="line"></span><br><span class="line">    System.out.println(user.toString());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在 测试类中，我们使用的不同与以前的类，使用的是 AnnotationConfigApplicationContext 类。</p>
<h1 id="九、AOP"><a href="#九、AOP" class="headerlink" title="九、AOP"></a>九、AOP</h1><h2 id="9-1-代理模式"><a href="#9-1-代理模式" class="headerlink" title="9.1 代理模式"></a>9.1 代理模式</h2><p>代理模式是 SpringAOP 的基础，其拥有 静态代理 和 动态代理 两种模式。</p>
<h3 id="9-1-1-静态代理"><a href="#9-1-1-静态代理" class="headerlink" title="9.1.1 静态代理"></a>9.1.1 静态代理</h3><p>静态代理大致分为四种角色 ：</p>
<ul>
<li><p>公共业务 ：以租房为例，租房这个行为本身就是一个公共业务。</p>
</li>
<li><p>真实角色 ：以租房为例，出租房屋的房东就是真式角色。</p>
</li>
<li><p>代理角色 ：以租房为例，租房中介就是代理角色，她们是真实角色的代理。</p>
</li>
<li><p>用户 ： 访问 代理角色 以完成 公共业务。</p>
</li>
</ul>
<p>下面以租房为例，只书写概念性的代码：</p>
<p>公共业务：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 公共业务 -- 租房</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Rend</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">rend</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>真实角色：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Host</span> <span class="keyword">implements</span> <span class="title">Rend</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">rend</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println( <span class="string">&quot; Rent the House &quot;</span> );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>代理角色：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.EveArsh.Proxy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RentProxy</span> <span class="keyword">implements</span> <span class="title">Rend</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Host host;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">RentProxy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">RentProxy</span><span class="params">(Host host)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.host = host;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Host <span class="title">getHost</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> host;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setHost</span><span class="params">(Host host)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.host = host;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getHostMassage</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println( <span class="string">&quot;附属行为 -- 获取房东的信息&quot;</span> );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">seeHouseByUser</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println( <span class="string">&quot;附属行为 -- 带用户看房&quot;</span> );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getProxyMoney</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println( <span class="string">&quot;附属行为 -- 收取中介费&quot;</span> );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 作为中介代理公共业务</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">rend</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.getHostMassage();</span><br><span class="line">        <span class="keyword">this</span>.seeHouseByUser();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">this</span>.host.rend();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">this</span>.getProxyMoney();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>用户：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.EveArsh.Proxy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Host host = <span class="keyword">new</span> Host();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 用户不再直接访问房东，而是通过代理角色，同时代理角色也可以做出一些附属行为</span></span><br><span class="line">        RentProxy rentProxy = <span class="keyword">new</span> RentProxy( host );</span><br><span class="line">        rentProxy.rend();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>从上方的代码，也可以看出静态代理模式的一些优缺点。</p>
<p>优点：</p>
<ul>
<li>可以使得真实角色的操作更加纯粹，使得其不用关注复杂业务。</li>
<li>公共业务交给了代理角色，可以明确分工。</li>
<li>公共业务的衍生更加便于管理。</li>
</ul>
<p>缺点：</p>
<ul>
<li>一个真实角色就需要一个代理角色，这会造成 <strong>代码量变大</strong>，<strong>效率降低</strong>。</li>
</ul>
<h3 id="9-1-2-动态代理"><a href="#9-1-2-动态代理" class="headerlink" title="9.1.2 动态代理"></a>9.1.2 动态代理</h3><p>和静态代理不同，动态代理的最大区别之一，就是不再手动给真实对象书写对应的代理类，而把这些工作托付给程序，让程序自动完成。</p>
<p>为了使用动态代理，我们需要引入 Proxy 和 InvocationHandler 两个类。</p>
<p>下面我们用一个模拟的 CRUD 来演示 Proxy 和 InvocationHandler 的使用。</p>
<p>公共服务（ 接口类 ）：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserDao</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">upData</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">query</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>真实对象：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDaoImpl</span> <span class="keyword">implements</span> <span class="title">UserDao</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println( <span class="string">&quot;增加了一个用户&quot;</span> );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println( <span class="string">&quot;删除了一个用户&quot;</span> );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">upData</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println( <span class="string">&quot;更新了一个用户&quot;</span> );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">query</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println( <span class="string">&quot;查询了一个用户&quot;</span> );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在使用动态代理前，我们需要明确动态代理的对象，也就是将要被代理的对象接口（公共业务）：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> Object target; <span class="comment">// 将被代理的对象接口</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTarget</span><span class="params">(Object target)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.target = target;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>接下来，我们就要开始书写动态代理的代码，首先在实现了 InvocationHandler 接口后需要实现 invoke 方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个函数用于执行对代理对象的操作，下面是执行代理方法的代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 执行代理对象的操作</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 执行代理方法</span></span><br><span class="line">    Object result = method.invoke( target, args );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>至此，我们完成对公共业务的代理。</p>
<p>接下来，我们应该向外部提供可以获取代理对象的方法，这是就需要使用 Proxy 类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取代理对象</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">getProxy</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// 这里三个参数分别是：</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">        * this.getClass().getClassLoader() 获取当前查询的字节码文件</span></span><br><span class="line"><span class="comment">        * target.getClass().getInterfaces() 当前代理的接口</span></span><br><span class="line"><span class="comment">        * this 当前的程序</span></span><br><span class="line"><span class="comment">        * */</span></span><br><span class="line">    <span class="keyword">return</span> Proxy.newProxyInstance( <span class="keyword">this</span>.getClass().getClassLoader(), </span><br><span class="line">                                  target.getClass().getInterfaces(), <span class="keyword">this</span> );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>此时，对上方的所有代码进行组合，即可获得动态代理的工具类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProxyInvocationHandler</span> <span class="keyword">implements</span> <span class="title">InvocationHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Object target; <span class="comment">// 将被代理的对象接口</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTarget</span><span class="params">(Object target)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.target = target;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取代理对象</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">getProxy</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">// 这里三个参数分别是：</span></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        * this.getClass().getClassLoader() 获取当前查询的字节码文件</span></span><br><span class="line"><span class="comment">        * target.getClass().getInterfaces() 当前代理的接口</span></span><br><span class="line"><span class="comment">        * this 当前的程序</span></span><br><span class="line"><span class="comment">        * */</span></span><br><span class="line">        <span class="keyword">return</span> Proxy.newProxyInstance( <span class="keyword">this</span>.getClass().getClassLoader(), target.getClass().getInterfaces(), <span class="keyword">this</span> );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 执行代理对象的操作</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 执行代理方法</span></span><br><span class="line">        Object result = method.invoke( target, args );</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>测试类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestController</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 真实对象</span></span><br><span class="line">        UserDaoImpl userDao = <span class="keyword">new</span> UserDaoImpl();</span><br><span class="line"></span><br><span class="line">        ProxyInvocationHandler pih = <span class="keyword">new</span> ProxyInvocationHandler();</span><br><span class="line">        pih.setTarget( userDao );</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取代理对象 ( 这里在启用代码时，类应该为对应的接口类型 )</span></span><br><span class="line">        UserDao proxy = (UserDao) pih.getProxy();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 执行方法</span></span><br><span class="line">        proxy.add();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>要注意的是 ： <strong>动态代理代理的是接口，也就是 公共业务，并非真实对象</strong></p>
<h2 id="9-2-AOP-的概念"><a href="#9-2-AOP-的概念" class="headerlink" title="9.2 AOP 的概念"></a>9.2 AOP 的概念</h2><p>在软件业，AOP为 Aspect Oriented Programming 的缩写，意为：<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E9%9D%A2%E5%90%91%E5%88%87%E9%9D%A2%E7%BC%96%E7%A8%8B/6016335">面向切面编程</a>。</p>
<p>通过<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E9%A2%84%E7%BC%96%E8%AF%91/3191547">预编译</a>方式和运行期间动态代理实现程序功能的统一维护的一种技术。</p>
<p>AOP是<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/OOP">OOP</a>的延续，是软件开发中的一个热点，也是<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/Spring">Spring</a>框架中的一个重要内容，是<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B/4035031">函数式编程</a>的一种衍生范型。</p>
<p>利用AOP可以对业务逻辑的各个部分进行隔离，从而使得业务逻辑各部分之间的<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E8%80%A6%E5%90%88%E5%BA%A6/2603938">耦合度</a>降低，提高程序的可重用性，提高了开发的效率。</p>
<h2 id="9-3-AOP-在-Spring-中的作用"><a href="#9-3-AOP-在-Spring-中的作用" class="headerlink" title="9.3 AOP 在 Spring 中的作用"></a>9.3 AOP 在 Spring 中的作用</h2><p>Spring 框架监控切入点方法的行，一旦监控到切入点方法被运行，使用代理机制，动态创建目标对象的代理对象，根据通知类别，在代理对象的相应位置，将通知 对应的功能加入，完成完整的代码逻辑运行。</p>
<p>上面这段话还是比较难以理解的，举个简单的例子：</p>
<p>就好比公交车，公交车出站开始运营，乘客知道了公交车开始运营了，在站点等着，车子到站乘客就上车。</p>
<p>公交车：切入点方法；乘客：功能。</p>
<p>公交车和人两个本来毫无关系的个体在公交运行时产生了联系。</p>
<p>AOP即切面，AOP底层即是动态代理模式。</p>
<p>切面 = 切点（目标对象中的方法） + 增强方法（增加的新功能）。</p>
<p>一旦检测到目标对象中的方法被调用，就将增强方法调入，将两者进行整合成一段新的代码逻辑功能。</p>
<h2 id="9-4-AOP-在-Spring-中的实现"><a href="#9-4-AOP-在-Spring-中的实现" class="headerlink" title="9.4 AOP 在 Spring 中的实现"></a>9.4 AOP 在 Spring 中的实现</h2><p>AOP 在 Spring 中可以有两种方式的实现 ： 使用 Spring 的 API 接口 和 使用自定义类实现 AOP</p>
<p>无论使用哪种方式，都要导入对应的包：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Spring AOP 相关包 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.aspectj/aspectjweaver --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.aspectj<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>aspectjweaver<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.9.9.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="9-4-1-使用-Spring-的-API-接口"><a href="#9-4-1-使用-Spring-的-API-接口" class="headerlink" title="9.4.1 使用 Spring 的 API 接口"></a>9.4.1 使用 Spring 的 API 接口</h3><p>若使用这种方式实现 AOP 切面编程，那么就要在 XML 文件中导入相应的依赖：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://www.springframework.org/schema/beans/spring-beans.xsd</span><br><span class="line">http://www.springframework.org/schema/aop </span><br><span class="line">https://www.springframework.org/schema/aop/spring-aop.xsd&quot;</span><br></pre></td></tr></table></figure>



<p>下面我们以 CRUD 为例子，完成一次 AOP 的编程：</p>
<p>由于这次我们使用 XML 文件来完成对 Bean 的配置，所以这次就不使用 @Component 注解。</p>
<p>首先，我们需要一个接口 ( 公共业务 ) 和 实现类。</p>
<p>接口（ 公共业务 ）：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Service</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">query</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>实现类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ServiceImpl</span> <span class="keyword">implements</span> <span class="title">Service</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println( <span class="string">&quot;增加一个用户&quot;</span> );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println( <span class="string">&quot;删除一个用户&quot;</span> );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println( <span class="string">&quot;修改一个用户&quot;</span> );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">query</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println( <span class="string">&quot;查询一个用户&quot;</span> );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>完成了上述准备后，我们开始书写用插入切片中的类，这里以 log 类为例。</p>
<p>两个类分别是是实现了 AfterReturningAdvice ( 后置插入 ) 和 MethodBeforeAdvice ( 前置插入 )</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AfterLog</span> <span class="keyword">implements</span> <span class="title">AfterReturningAdvice</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterReturning</span><span class="params">(Object returnValue, Method method, Object[] args, Object target)</span></span>&#123;</span><br><span class="line">        System.out.println( <span class="string">&quot;执行了&quot;</span> + method.getName() + <span class="string">&quot;返回结果为：&quot;</span> + returnValue );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BeforeLog</span> <span class="keyword">implements</span> <span class="title">MethodBeforeAdvice</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">before</span><span class="params">(Method method, Object[] args, Object target)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        System.out.println( target.getClass().getName() + <span class="string">&quot;的&quot;</span> + method.getName() + <span class="string">&quot;被执行&quot;</span> );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在这里需要解释一下： 在上述的代码中，method 代表着<strong>代理方法</strong>，target 代表<strong>代理对象</strong></p>
<p>完成后，就可以在 XML 文件中进行配置：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 切入点 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">&quot;printCut&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;execution(* com.Eve.Service.ServiceImpl.*(..))&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--执行环绕--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">&quot;afterLog&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;printCut&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">&quot;beforeLog&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;printCut&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>首先我们要设定切入点，也就是定义 aop:pointcut 标签，并通过 expression 属性来确定何处是切入点。</p>
<p>解释一下 expression 属性中的表达式：execution( * )是固定格式，这里的第一个 * 代表着后缀方法的返回值，推荐直接写入为 * 即可3，com.Eve.Service.ServiceImpl.* 是方法路径，上文的代码表示在  ServiceImpl 类下的所有方法都是切入点，（  ..  ）代表所有参数。</p>
<p>在设置完切入点后，就通过 aop:advisor 标签来注册环绕，advice-ref 属性对应需要插入的切片方法，pointcut-ref 代表目标的切入点。</p>
<h3 id="9-4-2-使用自定义类实现-AOP"><a href="#9-4-2-使用自定义类实现-AOP" class="headerlink" title="9.4.2  使用自定义类实现 AOP"></a>9.4.2  使用自定义类实现 AOP</h3><p>使用这种方式可以减少使用 API 接口，不用在意接口是否正确或存在。但是相对的这种方式只能操作方法，无法操作代理的类中的属性。</p>
<p>这种方式虽然简单，但是可操作的部分较少。下面演示一次使用自定义类的操作：</p>
<p>Diy 自定义类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyDiy</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">BeforeClass</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println( <span class="string">&quot;=================方法执行前==================&quot;</span> );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">AfterClass</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println( <span class="string">&quot;=================方法执行后==================&quot;</span> );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在完成 Diy 类的书写后，把类注册在 XML 文件中。</p>
<p>注册完后，利用 aop:config 标签下的 aop:aspect 标签来配置自定义类，如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:aspect</span> <span class="attr">ref</span>=<span class="string">&quot;diy&quot;</span>&gt;</span></span><br><span class="line">        ..............</span><br><span class="line">    <span class="tag">&lt;/<span class="name">aop:aspect</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>配置完后，和第一种方式相同，设置 切入点 和 断片方法：</p>
<p>切入点：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">&quot;pointCut&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;execution(* com.Eve.Service.ServiceImpl.* (..))&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>断片：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:before</span> <span class="attr">method</span>=<span class="string">&quot;BeforeClass&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;pointCut&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:after</span> <span class="attr">method</span>=<span class="string">&quot;AfterClass&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;pointCut&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>测试代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext( <span class="string">&quot;applicationContext.xml&quot;</span> );</span><br><span class="line"></span><br><span class="line">Service service = context.getBean(<span class="string">&quot;service&quot;</span>, Service.class);</span><br><span class="line">service.add();</span><br></pre></td></tr></table></figure>

<p>通过代码可知，这种方式虽然简单，但本质还是调用固定方法，无法操作类中的对象。</p>
<h2 id="9-5-使用注解实现-AOP"><a href="#9-5-使用注解实现-AOP" class="headerlink" title="9.5 使用注解实现 AOP"></a>9.5 使用注解实现 AOP</h2><p>用这种方式实现 AOP 和上方讨论的第二种方式（ 使用自定义类 ）的方式相似，但相对的，这种方式比起自定义类更为简洁。</p>
<p>使用注解实现 AOP 之前，需要在 XML 文件中开启自动匹配：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:aspectj-autoproxy</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>完成后，第一步，声明一个切面，后面所有的切面代码都在这个类中：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 这个声明代表这是一个切面</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AnnotationPointCut</span> </span>&#123;</span><br><span class="line">   ....... </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>下一步，通过一些注解来完成对 AOP 的实现：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@After(&quot;execution(* Services.ServiceImpl.* (..))&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterLog</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println( <span class="string">&quot;=========方法执行后==========&quot;</span> );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Before(&quot;execution(* Services.ServiceImpl.* (..))&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">beforeLog</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println( <span class="string">&quot;=========方法执行前==========&quot;</span> );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在上方的代码中，@After 和 @Before 分别可以在 目标断面后 和 目标断面前。</p>
<p>其中注解的括号里面应该指定为目标断面的表达式。关于表达式的内容在 9.4.2 中有过解释。</p>
<p>在这里就可以体现出这种方式的一个重大缺点：表达式每次都需要重新书写，无法复用，且极易出错。</p>
<p>下面是测试代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">AOP_TestThree</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">    Service service = context.getBean(<span class="string">&quot;service&quot;</span>, Service.class);</span><br><span class="line"></span><br><span class="line">    service.add();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里再次声明一次：动态代理代理的是公共业务，也就是接口本身，并不代理真实对象。</p>
<h1 id="十、整合-MyBatis"><a href="#十、整合-MyBatis" class="headerlink" title="十、整合 MyBatis"></a>十、整合 MyBatis</h1><p>在使用 Spring 整合 MyBatis 时，首先要导入一个 SpringMyBatis 包：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Spring 整合 MyBaits 相关包 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.mybatis/mybatis-spring --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>MyBatis-Spring官网 ：<a target="_blank" rel="noopener" href="http://mybatis.org/spring/zh/index.html">http://mybatis.org/spring/zh/index.html</a></p>
<p>首先，我们要将数据源从 MyBatis 的配置文件中剥离，在 Spring 中来配置数据库的元数据：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 配置数据元 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.datasource.DriverManagerDataSource&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClassName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql://localhost:3306/mybatis?useSSL=true<span class="symbol">&amp;amp;</span>useUnicode=true<span class="symbol">&amp;amp;</span>characterEncoding=UTF-8<span class="symbol">&amp;amp;</span>serverTimezone=Asia/Shanghai&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;123456&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在配置完数据源后，我们开始构建 sqlSessionFactory （ 记得在此之前把数据库XML文件中的数据元删除 ）：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 配置 sqlSessionFactory --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;sqlSessionFactory&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在构建 sqlSessionFactory 后，我们可以在其中配置 Mapper 文件的注册 和 绑定 MyBatis 配置文件：</p>
<p>Mapper 文件的注册：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 注册 Mapper --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;mapperLocations&quot;</span> <span class="attr">value</span>=<span class="string">&quot;classpath:com/Eve/Dao/UserMapper.xml&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>有些时候，我们需要注册多个 Mapper ，此时我们就需要使用另外一种方式来处理 Mapper 文件的注册：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;mapperLocations&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>classpath:com/Song/Dao/TeacherDao/TeacherMapper.xml<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>classpath:com/Song/Dao/UserDao/UserMapper.xml<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>MyBaits 配置文件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 绑定 MyBatis 配置文件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;configLocation&quot;</span> <span class="attr">value</span>=<span class="string">&quot;classpath:mybatis-config.xml&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>完成后如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 配置 sqlSessionFactory --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;sqlSessionFactory&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 绑定 MyBatis 配置文件 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;configLocation&quot;</span> <span class="attr">value</span>=<span class="string">&quot;classpath:mybatis-config.xml&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 注册 Mapper --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;mapperLocations&quot;</span> <span class="attr">value</span>=<span class="string">&quot;classpath:com/Eve/Dao/UserMapper.xml&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>完成的上面代码后，我们接下来开始构建会话对象，也就是 sqlSessionTemplate ，sqlSessionTemplate 和在 MyBatis 中的 sqlSession 相似，但 sqlSessionTemplate 可以做到线程安全，且功能相同。</p>
<p>所以我们接下来开始构建 sqlSessionTemplate：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 创建 sqlSession --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;sqlSessionTemplate&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.SqlSessionTemplate&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;sqlSessionFactory&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;sqlSessionFactory&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在执行下一步前，提供另一种构造 sqlSessionTemplate 的方法：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 创建 sqlSession --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;sqlSessionTemplate&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.SqlSessionTemplate&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;0&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;sqlSessionFactory&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>之所以使用构造器构造，是因为 sqlSessionFactory 本身没有 set 方法。</p>
<p>接下来，我们需要创建一个实现了Mapper接口的实体类，以 UserMapper 为例，我们要创建 UserMapperImpl 类并实现 UserMapper 接口，用作代理。</p>
<p>我们会在这个实现类中提供 <strong>隐式的 sqlSessionTemplate</strong> 和 <strong>set方法</strong>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> SqlSessionTemplate sqlSessionTemplate;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSqlSessionTemplate</span><span class="params">(SqlSessionTemplate sqlSessionTemplate)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.sqlSessionTemplate = sqlSessionTemplate;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>同时，由于实现了 UserMapper 的接口，我们会被要求重写 UserMapper 的所有方法。</p>
<p>其实方法已经在 UserMapper 对应的 XMl 文件中实现，我们在使用时调用实现类即可，下面以一个 UserMapperImpl 为例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> ArrayList&lt;User&gt; <span class="title">getUserList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    UserMapper mapper = sqlSessionTemplate.getMapper(UserMapper.class);</span><br><span class="line">    <span class="keyword">return</span> mapper.getUserList();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> ArrayList&lt;User&gt; <span class="title">getUserListById</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">    UserMapper mapper = sqlSessionTemplate.getMapper( UserMapper.class );</span><br><span class="line">    <span class="keyword">return</span> mapper.getUserListById( <span class="number">1</span> );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>另外，这个实现类需要在 XML 文件中注册才可以被调用，否则会报错：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 注册实例类 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userMapper&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.Eve.Dao.UserMapperImpl&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;sqlSessionTemplate&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;sqlSessionTemplate&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>至此整合完成。</p>
<p>下面给出测试类的代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getUserList</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext( <span class="string">&quot;spring-dao.xml&quot;</span> );</span><br><span class="line"></span><br><span class="line">    UserMapper mapper = context.getBean(<span class="string">&quot;userMapper&quot;</span>,UserMapper.class);</span><br><span class="line">    mapper.getUserList();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="十一、声明式事务"><a href="#十一、声明式事务" class="headerlink" title="十一、声明式事务"></a>十一、声明式事务</h1><p>在 Spring 中的事务大体可以分为 声明式事务 和 编程式事务。</p>
<p>其中，声明式事务使用的手段就是 AOP ，而编程式事务需要在代码中实现事务的管理。</p>
<p>由于声明式事务会改变代码，因此我们着重于声明式事务。</p>
<h2 id="11-1-声明式事务的使用"><a href="#11-1-声明式事务的使用" class="headerlink" title="11.1 声明式事务的使用"></a>11.1 声明式事务的使用</h2><p>在 Spring 中使用声明式事务前，需要提前声明事务的开启：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 开启事务 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;transactionManager&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>接下来，我们以 User 表为例来完成一次声明式事务的书写：</p>
<p>首先，我们定义一个UserMapper 接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 根据 Id 查询学生</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">getUser</span><span class="params">( <span class="meta">@Param(&quot;userId&quot;)</span> <span class="keyword">int</span> id )</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 增加用户</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">addUser</span><span class="params">( User user )</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 删除用户</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">deleteUser</span><span class="params">( <span class="meta">@Param(&quot;userId&quot;)</span> <span class="keyword">int</span> id )</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在 XML 中完成对上述接口的配置（ 此处不展示代码 ），完成后再创建实例类，在 applicationContext.xml 中注册该实例类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> SqlSessionTemplate sqlSessionTemplate;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSqlSessionTemplate</span><span class="params">(SqlSessionTemplate sqlSessionTemplate)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.sqlSessionTemplate = sqlSessionTemplate;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> User <span class="title">getUser</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">    UserMapper mapper = sqlSessionTemplate.getMapper(UserMapper.class);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 执行增加和删除的操作</span></span><br><span class="line">    mapper.addUser( <span class="keyword">new</span> User( <span class="number">16</span>, <span class="string">&quot;测试员&quot;</span>, <span class="string">&quot;1234567&quot;</span> ) );</span><br><span class="line">    mapper.deleteUser( <span class="number">15</span> );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> mapper.getUser( id );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">addUser</span> <span class="params">(User user )</span> </span>&#123;</span><br><span class="line">    UserMapper mapper = sqlSessionTemplate.getMapper(UserMapper.class);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> mapper.addUser( user );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">deleteUser</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">    UserMapper mapper = sqlSessionTemplate.getMapper(UserMapper.class);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> mapper.deleteUser( id );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userMapper&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.Song.Dao.UserDao.UserMapperImpl&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;sqlSessionTemplate&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;sqlSessionTemplate&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>可以发现在创建实例类的代码中，getUser 函数下调用了其他两个函数，此时我们可以把 getUser 以及被她调用的两个函数视为一个事务。</p>
<p>根据事务的一致性，当这三个函数中有一个失败时，所有的事务都需要回滚 ； 只有这三个函数同时成功时，执行的结果才可以提交。</p>
<p>完成了上述工作后，我们开始进行 事务的配置 和 AOP的织入。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 配置事务 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tx:advice</span> <span class="attr">id</span>=<span class="string">&quot;txAdvice&quot;</span> <span class="attr">transaction-manager</span>=<span class="string">&quot;transactionManager&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;*&quot;</span>/&gt;</span> <span class="comment">&lt;!--代表所有函数都在事务范围内，若要指定为某个方法，将方法命填入name中即可--&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tx:advice</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>要注意，配置事务时 tx:advice 的自动导入极容易导错包，推荐在导入包后重新审查一下。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 配置AOP --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">&quot;txPointCut&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;execution(* com.Song.Dao.*.* (..))&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">&quot;txAdvice&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;txPointCut&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--代表在 tePointCut 位置附加事务--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/06/03/MyBatis%E5%AD%A6%E4%B9%A0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="神秘的世界">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/06/03/MyBatis%E5%AD%A6%E4%B9%A0/" class="post-title-link" itemprop="url">MyBatis学习</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-06-03 23:45:31" itemprop="dateCreated datePublished" datetime="2022-06-03T23:45:31+08:00">2022-06-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-07-13 11:36:55" itemprop="dateModified" datetime="2022-07-13T11:36:55+08:00">2022-07-13</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="MyBatis-的官方文档地址"><a href="#MyBatis-的官方文档地址" class="headerlink" title="MyBatis 的官方文档地址"></a>MyBatis 的官方文档地址</h1><p><a target="_blank" rel="noopener" href="https://mybatis.org/mybatis-3/zh/index.html">https://mybatis.org/mybatis-3/zh/index.html</a></p>
<h1 id="一、我的第一个MyBatis程序"><a href="#一、我的第一个MyBatis程序" class="headerlink" title="一、我的第一个MyBatis程序"></a>一、我的第一个MyBatis程序</h1><p>思路 ：搭建环境 –&gt; 导入 MyBatis –&gt; 编写代码 –&gt; 进行测试</p>
<h2 id="1-1、搭建环境"><a href="#1-1、搭建环境" class="headerlink" title="1.1、搭建环境"></a>1.1、搭建环境</h2><p>利用 IDEA 或者 JDBC 搭建数据库</p>
<p>这个数据库暂且只有一张表，且其中只有四个数据，日后再进行扩充</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> DATABASE `mybatis`;</span><br><span class="line"></span><br><span class="line">USE `mybatis`;</span><br><span class="line"></span><br><span class="line"><span class="operator">/</span><span class="operator">/</span> 创建表</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `<span class="keyword">User</span>` (</span><br><span class="line">	`id` <span class="type">INT</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">	`name` <span class="type">VARCHAR</span>(<span class="number">30</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">	`password` <span class="type">VARCHAR</span>(<span class="number">30</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">	<span class="keyword">PRIMARY</span> KEY( `id` )</span><br><span class="line">) ENGINE <span class="operator">=</span> INNODB <span class="keyword">DEFAULT</span> CHARSET <span class="operator">=</span> utf8;</span><br><span class="line"></span><br><span class="line"><span class="operator">/</span><span class="operator">/</span> 插入数据</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `<span class="keyword">User</span>` (`id`,`name`,`password`) <span class="keyword">VALUES</span></span><br><span class="line">	(<span class="number">1</span>,&quot;管理员-A&quot;,&quot;1234567&quot;),</span><br><span class="line">	(<span class="number">2</span>,&quot;李明&quot;,&quot;1234567&quot;),</span><br><span class="line">	(<span class="number">3</span>,&quot;张三&quot;,&quot;1234567&quot;),</span><br><span class="line">	(<span class="number">4</span>,&quot;赵燕&quot;,&quot;1234567&quot;)</span><br></pre></td></tr></table></figure>



<p>新建一个普通的 Maven 项目</p>
<p>将这个 Maven 项目的 src 目录删除，将其变为 &lt; 父工程 &gt;，然后导入依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--  导入 MyBaits 依赖  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- MySQL 驱动 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- https://mvnrepository.com/artifact/mysql/mysql-connector-java --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.0.28<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- MyBaits --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.mybatis/mybatis --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Junit --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- https://mvnrepository.com/artifact/junit/junit --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.13.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="1-2、创建模块"><a href="#1-2、创建模块" class="headerlink" title="1.2、创建模块"></a>1.2、创建模块</h2><p>在之前的父工程下，创建一个新的 Maven 模块，注意将父工程选项选为之前的 Maven 工程。</p>
<p>完成后，就要开始着手于编写 MyBatis 的配置文件 以及 MyBatis 的有关工具类。</p>
<h3 id="MyBatis-的配置文件"><a href="#MyBatis-的配置文件" class="headerlink" title="MyBatis 的配置文件"></a>MyBatis 的配置文件</h3><p>新建 MyBatis 的相关 XML 配置文件，在 resources 文件夹下，推荐文件名为 mybatis-config.xml。 这是 MyBaits 的总配置文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">    <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- configuration核心配置文件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> </span></span><br><span class="line"><span class="tag">                          <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql://localhost:3306/mybatis?useSSL=true<span class="symbol">&amp;amp;</span>useUnicode=true<span class="symbol">&amp;amp;</span>characterEncoding=UTF-8<span class="symbol">&amp;amp;</span>serverTimezone=Asia/Shanghai&quot;</span>/&gt;</span></span><br><span class="line">                </span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;123456&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 进行 Mapper 的注册 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">&quot;com/EveArsh/Dao/UserMapper.xml&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="MyBatis-的有关工具类"><a href="#MyBatis-的有关工具类" class="headerlink" title="MyBatis 的有关工具类"></a>MyBatis 的有关工具类</h3><p>设置 Utils 类，来获取和 MyBatis 有关的工具类。 即，工厂类 SqlSessionFactory 和 用于执行 SQL 语句的 SqlSession 类对象 ：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.EveArsh.Utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBatisUtils</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 提升 SqlSessionFactory 作用域</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> SqlSessionFactory sqlSessionFactory = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 使用静态代码块，在这个类被加载时就可以自动读取在 resources 文件夹下的 mybatis-config.xml 配置文件</span></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        InputStream inputStream = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 使用 MyBatis ： 第一步，获取 SqlSessionFactory 的对象</span></span><br><span class="line">        <span class="comment">// SqlSessionFactory 是一个经典的工厂模式</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            String resource = <span class="string">&quot;mybatis-config.xml&quot;</span>;</span><br><span class="line">            inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlSession <span class="title">getSqlSession</span><span class="params">()</span> <span class="keyword">throws</span> NullPointerException </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 使用 MyBatis ： 第二步，获取 SqlSession 的对象</span></span><br><span class="line">        <span class="keyword">if</span> ( sqlSessionFactory != <span class="keyword">null</span> )&#123;</span><br><span class="line">            <span class="keyword">return</span> sqlSessionFactory.openSession();</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 如果 sqlSessionFactory 为空，即可认为连接数据库失败，抛出空指针异常</span></span><br><span class="line">        System.out.println( <span class="string">&quot;【 Utils -&gt; MyBatisUtils 】 : 出现空指针异常，数据库可能连接失败&quot;</span> );</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="1-3编写代码"><a href="#1-3编写代码" class="headerlink" title="1.3编写代码"></a>1.3编写代码</h2><p>在 Dao 层对应的包下，也就是 com.EveArsh.Dao 创建 对应 pojo 包中对应的类进行创建对应 接口 和 配置文件</p>
<p>例如，对于 User 类而言，就在 Dao 包下创建 UserDao 和 UserMapper.xml</p>
<p>UserDao </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.EveArsh.Dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.EveArsh.pojo.User;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserDao</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> ArrayList&lt; User &gt; getUserList();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>UserMapper.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--namespace= 会绑定一个对应的 Dao/Mapper 接口--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.EveArsh.Dao.UserDao&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--查询语句， id 对应 方法名, resultType 对应 返回类型 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--resultType 对应 返回类型, 其中的返回类型若不使用注解，则需要填入绝对路径 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUserList&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.EveArsh.pojo.User&quot;</span>&gt;</span></span><br><span class="line">        select * from mybatis.user;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="1-4-进行测试"><a href="#1-4-进行测试" class="headerlink" title="1.4 进行测试"></a>1.4 进行测试</h2><p>在 Test 文件夹下，利用 Junit 来编写测试代码对代码进行测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.EveArsh.Dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.EveArsh.Utils.MyBatisUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDaoTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获得 sqlSession 对象，执行 sql</span></span><br><span class="line">        SqlSession sqlSession = MyBatisUtils.getSqlSession();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 方式一 ： 通过 getMapper 的方式来获取</span></span><br><span class="line">        UserDao mapper = sqlSession.getMapper( UserDao.class );</span><br><span class="line">        System.out.println( mapper.getUserList().size() );</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 关闭 sqlSession</span></span><br><span class="line">        sqlSession.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="二、CRUD"><a href="#二、CRUD" class="headerlink" title="二、CRUD"></a>二、CRUD</h1><h2 id="2-1-namespace"><a href="#2-1-namespace" class="headerlink" title="2.1 namespace"></a>2.1 namespace</h2><p>namespace 中的包名和 Dao/mapper 中的包名一致。</p>
<h2 id="2-2-Select标签"><a href="#2-2-Select标签" class="headerlink" title="2.2 Select标签"></a>2.2 Select标签</h2><p>Select 标签在 MyBatis 的相关 XML 配置中代表着修改的查询语句。</p>
<ul>
<li>id ： 对应 namespace 中的接口函数，也就是对应 Mapper 接口类中的函数。</li>
<li>resultType：代表着函数的返回值，其中的返回类型若不使用注解，则需要填入绝对路径。</li>
<li>parameterType：参数类型，规定了这个方法所应该传入的参数，取决于当下方法的需求。</li>
</ul>
<h2 id="2-3-insert，delete-和-update"><a href="#2-3-insert，delete-和-update" class="headerlink" title="2.3 insert，delete 和 update"></a>2.3 insert，delete 和 update</h2><p>对于 MyBatis 而言，所有的对数据库的修改都应该手动的进行 事务 的提交，也就是利用 SqlSession 的 Commit 函数。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlSession.commit();</span><br></pre></td></tr></table></figure>

<p>如果不使用 commit 函数，那么就算对应的 Sql 语句被执行成功，数据库中的值也不会被修改。</p>
<h2 id="2-4-Map-的使用"><a href="#2-4-Map-的使用" class="headerlink" title="2.4 Map 的使用"></a>2.4 Map 的使用</h2><p>在实际运用中，数据库中的表可能具有大量字段（ 几十条，甚至于上百条 ），此时如果需要执行修改某项数据的某个字段的 SQL 语句，就需要向 Dao 层中传入一个 <strong>带有完整数据的用户类型参数</strong> 这无疑十分麻烦。</p>
<p>为了节省时间和工作量，就可以使用 Map 来代题参数的传递，例如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 接口</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insertUser_C</span><span class="params">( Map&lt; String, Object &gt; map )</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// XML文件</span></span><br><span class="line">&lt;insert id=<span class="string">&quot;insertUser_C&quot;</span> parameterType=<span class="string">&quot;Map&quot;</span>&gt;</span><br><span class="line">    insert into mybatis.user(id, name) values ( #&#123;param_id&#125;, #&#123;param_name&#125; );</span><br><span class="line">&lt;/insert&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 函数测试</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insertUser_C_Test</span><span class="params">()</span></span>&#123;</span><br><span class="line">    SqlSession sqlSession = MyBatisUtils.getSqlSession();</span><br><span class="line"></span><br><span class="line">    HashMap&lt; String, Object &gt; param = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    UserMapper mapper = sqlSession.getMapper( UserMapper.class );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 此处 Key 的值应该与文件 UserMapper.xml 中对应的 SQL 语句中的 #&#123;&#125; 相互对应</span></span><br><span class="line">    param.put( <span class="string">&quot;param_id&quot;</span>, <span class="number">10</span> );</span><br><span class="line">    param.put( <span class="string">&quot;param_name&quot;</span>, <span class="string">&quot;name&quot;</span> );</span><br><span class="line"></span><br><span class="line">    mapper.insertUser_C( param );</span><br><span class="line"></span><br><span class="line">    sqlSession.commit();</span><br><span class="line"></span><br><span class="line">    sqlSession.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>综上所述，可以得知目前 Mybites 常用的取值可以分为三种情况：</p>
<ul>
<li>使用 Map 传入参数，在 SQL 语句中直接取出所需要元素的 key 值即可，由于 key 的值可以自定义，因此自由度较高</li>
<li>使用对象传递参数，在 SQL 语句中直接取出对象的属性即可，由于需要传入一个完整的对象，占用的内存更多，自由度更低</li>
<li>使用<strong>基本数据类型</strong>传递参数，SQL 语句可以直接取到（ 前提是该函数只有一个参数，且为基本数据类型</li>
</ul>
<p>除了上述的三点之外，还有一点需要注意：</p>
<ul>
<li>若一个函数存在复数个参数，就应该使用 Map 或者 <strong>使用注解开发</strong></li>
</ul>
<h2 id="2-5-MyBatis-中的模糊查询"><a href="#2-5-MyBatis-中的模糊查询" class="headerlink" title="2.5 MyBatis 中的模糊查询"></a>2.5 MyBatis 中的模糊查询</h2><p>在使用 MyBatis 框架的情况下使用模糊查询可以有两种方法：</p>
<ul>
<li><p>在编写 SQL 语句时，正常书写 SQL 语句，通过参数传入通配符，例如：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUserList&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.EveArsh.pojo.User&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;Map&quot;</span>&gt;</span></span><br><span class="line">    select * from mybatis.user where name like #&#123;name&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getUserListTest</span><span class="params">()</span></span>&#123;</span><br><span class="line">    SqlSession sqlSession = MyBatisUtils.getSqlSession();</span><br><span class="line"></span><br><span class="line">    HashMap&lt; String, Object &gt; paramMap = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    UserMapper mapper = sqlSession.getMapper( UserMapper.class );</span><br><span class="line"></span><br><span class="line">    paramMap.put( <span class="string">&quot;name&quot;</span>, <span class="string">&quot;%李%&quot;</span>);</span><br><span class="line"></span><br><span class="line">    ArrayList&lt; User &gt; resultList = mapper.getUserList( paramMap );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (User user : resultList) &#123;</span><br><span class="line">        System.out.println( user.toString() );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    sqlSession.close();;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通过这种方式实现模糊查询，可以有效避免恶意的 SQL 注入，但是需要每次传入参数时就携带通配符。</p>
</li>
<li><p>在编写 SQL 语句时，直接加上通配符，固定模糊查询的方式，例如：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUserList&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.EveArsh.pojo.User&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;Map&quot;</span>&gt;</span></span><br><span class="line">    select * from mybatis.user where name like &quot;%&quot;#&#123;name&#125;&quot;%&quot;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getUserListTest</span><span class="params">()</span></span>&#123;</span><br><span class="line">    SqlSession sqlSession = MyBatisUtils.getSqlSession();</span><br><span class="line"></span><br><span class="line">    HashMap&lt; String, Object &gt; paramMap = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    UserMapper mapper = sqlSession.getMapper( UserMapper.class );</span><br><span class="line"></span><br><span class="line">    paramMap.put( <span class="string">&quot;name&quot;</span>, <span class="string">&quot;李&quot;</span>);</span><br><span class="line"></span><br><span class="line">    ArrayList&lt; User &gt; resultList = mapper.getUserList( paramMap );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (User user : resultList) &#123;</span><br><span class="line">        System.out.println( user.toString() );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    sqlSession.close();;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通过这种方式实现模糊查询，容易受到恶意的 SQL 注入，但是每次传入参数时就不用手动携带通配符。</p>
</li>
</ul>
<h1 id="三、MyBatis-的配置解析"><a href="#三、MyBatis-的配置解析" class="headerlink" title="三、MyBatis 的配置解析"></a>三、MyBatis 的配置解析</h1><h2 id="3-1-核心配置文件"><a href="#3-1-核心配置文件" class="headerlink" title="3.1 核心配置文件"></a>3.1 核心配置文件</h2><p>一般默认的，MyBatis 的核心文件被命名为 mybatis-config.xml 当然，也可以是其他的名字。</p>
<p>MyBatis 的核心配置文件十分重要，MyBatis 的配置文件包含了会深深影响 MyBatis 行为的设置和属性信息。下面是其顶层配置结构：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">configuration（配置）</span><br><span class="line">properties（属性）</span><br><span class="line">settings（设置）</span><br><span class="line">typeAliases（类型别名）</span><br><span class="line">typeHandlers（类型处理器）</span><br><span class="line">objectFactory（对象工厂）</span><br><span class="line">plugins（插件）</span><br><span class="line">environments（环境配置）</span><br><span class="line">environment（环境变量）</span><br><span class="line">transactionManager（事务管理器）</span><br><span class="line">dataSource（数据源）</span><br><span class="line">databaseIdProvider（数据库厂商标识）</span><br><span class="line">mappers（映射器）</span><br></pre></td></tr></table></figure>



<h2 id="3-2-环境配置-environment"><a href="#3-2-环境配置-environment" class="headerlink" title="3.2 环境配置 environment"></a>3.2 环境配置 environment</h2><h3 id="3-2-1-MyBatis-配置多套环境"><a href="#3-2-1-MyBatis-配置多套环境" class="headerlink" title="3.2.1 MyBatis 配置多套环境"></a>3.2.1 MyBatis 配置多套环境</h3><p>MyBatis 可以配置成适应多种环境，但是需要注意的是 ： <strong>尽管可以配置多个环境，但每个 SqlSessionFactory 实例只能选择一种环境</strong>。</p>
<p>MyBatis 配置多套环境的实例：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">&quot;testEnvironment&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql://localhost:3306/mybatis?useSSL=true<span class="symbol">&amp;amp;</span>useUnicode=true<span class="symbol">&amp;amp;</span>characterEncoding=UTF-8<span class="symbol">&amp;amp;</span>serverTimezone=Asia/Shanghai&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;123456&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;testEnvironment&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql://localhost:3306/school?useSSL=true<span class="symbol">&amp;amp;</span>useUnicode=true<span class="symbol">&amp;amp;</span>characterEncoding=UTF-8<span class="symbol">&amp;amp;</span>serverTimezone=Asia/Shanghai&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;123456&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>此时，如果需要修改 MyBatis 的配置环境，只需要改动对应的位置即可：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">&quot;testEnvironment&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="3-2-2-事务管理器-和-数据源-的属性"><a href="#3-2-2-事务管理器-和-数据源-的属性" class="headerlink" title="3.2.2 事务管理器 和 数据源 的属性"></a>3.2.2 事务管理器 和 数据源 的属性</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>上方的设置属性就是 MyBatis 的事务管理器属性，对于 MyBatis 框架而言，常用的有两种事务管理器。</p>
<ul>
<li><p><strong>JDBC</strong></p>
<p> 这个配置直接使用了 JDBC 的提交和回滚功能，它依赖从数据源获得的连接来管理事务作用域。</p>
</li>
<li><p><strong>MANAGED</strong></p>
<p>这个配置几乎没做什么。它从不提交或回滚一个连接，而是让容器来管理事务的整个生命周期，现在已经逐渐不再使用。一般而言，Events容器并不希望连接被关闭，因此需要将 closeConnection 属性设置为 false 来阻止默认的关闭行为。</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;dataSource type=&quot;POOLED&quot;&gt;</span><br></pre></td></tr></table></figure>

<p>上方的设置属性就是 MyBatis 的数据源属性，对于 MyBatis 框架而言，常用的有三种数据源属性，她们的作用都是连接数据库。</p>
<ul>
<li><p><strong>UNPOOLED</strong></p>
<p>这种数据源代表该环境下未使用 <strong>连接池</strong> ，会对打开的数据库连接进行回收。虽然有点慢，但对那些数据库连接可用性要求不高的简单应用程序来说，是一个很好的选择。</p>
</li>
<li><p><strong>POOLED</strong></p>
<p>这种数据源代表该环境下使用了 <strong>连接池</strong> ，不会对打开的数据库连接进行回收。避免了创建新的连接实例时所必需的初始化和认证时间。可以达到 Web 程序间的快速响应。</p>
</li>
<li><p><strong>JNDI</strong> </p>
<p> 这个数据源实现是为了能在如 EJB 或应用服务器这类容器中使用，容器可以集中或在外部配置数据源，然后放置一个 JNDI 上下文的数据源引用。这已经十分少见。</p>
</li>
</ul>
<h2 id="3-3-属性配置-properties"><a href="#3-3-属性配置-properties" class="headerlink" title="3.3 属性配置 properties"></a>3.3 属性配置 properties</h2><p>MyBatis 框架支持使用外部的配置文件来完成 mybatis-config.xml 文件中的属性配置，也就是依旧可以使用 JDBC 时使用的 db.properties 文件来完成对 MyBatis 的配置。</p>
<p>外部配置文件：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">driver=com.mysql.cj.jdbc.Driver</span><br><span class="line">url=jdbc:mysql:<span class="comment">//localhost:3306/mybatis?useSSL=true&amp;useUnicode=true&amp;characterEncoding=UTF-8&amp;serverTimezone=Asia/Shanghai</span></span><br><span class="line">username=root</span><br><span class="line">password=<span class="number">123456</span></span><br></pre></td></tr></table></figure>

<p>MyBatis属性配置：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">&quot;db.properties&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--该环境使用外部配置的 properties--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;driver&#125;&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;url&#125;&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;username&#125;&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;password&#125;&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>需要注意的是，properties 标签需要写在 configuration 标签下第一顺位，MyBatis 配置文件中的标签顺序都是固定的。</p>
<p>另外，properties 标签是可以附加属性的设置的，例如：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">&quot;db.properties&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;123456&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>另外，如果 properties 中设置的字段和外部连接中的字段重复，MyBatis 会优先选择外部配置文件中的字段值。</p>
<h2 id="3-4-类型别名-typeAliases"><a href="#3-4-类型别名-typeAliases" class="headerlink" title="3.4 类型别名 typeAliases"></a>3.4 类型别名 typeAliases</h2><p>类型别名可为 Java 类型设置一个缩写名字。 它仅用于 XML 配置，意在降低冗余的全限定类名书写。其有两个作用：</p>
<ul>
<li>避免使用全限定类名书写，减少书写量</li>
<li>为其设定一个短的名字</li>
</ul>
<p>在 MyBatis 中，通过 typeAliases 标签设置别名（ 同样要注意 typeAliases 标签的位置 ），大体可分为两种方法：</p>
<ul>
<li><p>直接为类设置别名</p>
<p>UserMapper.xml 配置文件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUserList&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;Map&quot;</span>&gt;</span></span><br><span class="line">    select * from mybatis.user where name like #&#123;userName&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>mybatis-config.xml 配置文件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAlias</span> <span class="attr">type</span>=<span class="string">&quot;com.EveArsh.pojo.User&quot;</span> <span class="attr">alias</span>=<span class="string">&quot;User&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在上方的例子中，为实体类 com.EveArsh.pojo.User  设置了一个别名 User，并在 UserMapper.xml 中使用。</p>
<p>可以看出，使用这种方式可以自由定义实体类的别名。</p>
</li>
<li><p>包扫描</p>
<p>UserMapper.xml 配置文件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUserList&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;user&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;Map&quot;</span>&gt;</span></span><br><span class="line">    select * from mybatis.user where name like #&#123;userName&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>mybatis-config.xml 配置文件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.EveArsh.pojo&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在上方的例子中，先进行了一次包扫描，那么此时在包下的所有实体类都可以直接使用，其默认为首字母小写后的形式（ 优先识别注解 ）。</p>
<p>这种方式可以在有大量的实体类时使用，但存在无法自定义别名的缺点。</p>
<p>若希望在这种情况下自定义类型别名，就需要使用注解开发：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Alias( &quot;Hello&quot; )</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;...&#125;</span><br></pre></td></tr></table></figure>

<p>UserMapper.xml 配置文件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUserList&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;Hello&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;Map&quot;</span>&gt;</span></span><br><span class="line">    select * from mybatis.user where name like #&#123;userName&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>mybatis-config.xml 配置文件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.EveArsh.pojo&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>若希望使用注解开发来自定义类型别名，一定要先进行包扫描。</p>
</li>
</ul>
<h2 id="3-5-设置-Setting"><a href="#3-5-设置-Setting" class="headerlink" title="3.5 设置 Setting"></a>3.5 设置 Setting</h2><p>在此处只列出几个极为重要的 Setting </p>
<table>
<thead>
<tr>
<th align="center"><strong>cacheEnabled</strong></th>
<th align="center"><strong>全局性开启或者关闭缓存</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="center"><strong>lazyLoadingEnabled</strong></td>
<td align="center"><strong>全局性开启或关闭懒加载</strong></td>
</tr>
<tr>
<td align="center"><strong>mapUnderscoreToCamelCase</strong></td>
<td align="center"><strong>开启或关闭驼峰命名自动映射</strong></td>
</tr>
</tbody></table>
<p>其余设置详见 MyBatis 的官方文档。</p>
<h2 id="3-6-映射器-mappers"><a href="#3-6-映射器-mappers" class="headerlink" title="3.6 映射器 mappers"></a>3.6 映射器 mappers</h2><p> mappers 用于绑定注册文件对应的 Mapper，每一个 Mapper 都要进行注册。</p>
<p>mapper 的注册主要有四种方式：</p>
<ul>
<li><p>使用相对于类路径的资源引用</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">&quot;com/EveArsh/Dao/UserMapper.xml&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这种方法常用且有效，唯一费事的是，每次都需要将 resource 的类路径写全。但相对的，使用这种方式不会有什么条件和制约。</p>
</li>
</ul>
<ul>
<li><p>使用完全限定资源定位符（URL）</p>
<p>由于这种方法几乎淘汰，这里就不做讨论。</p>
</li>
<li><p>使用映射器接口实现类的完全限定类名</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">class</span>=<span class="string">&quot;com.EveArsh.Dao.UserMapper&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这种方式可以通过 class 的位置来绑定 Mapper，虽然相对便捷，但是这种方式一定约束：</p>
<ul>
<li>当 Mapper 对应的 XML 文件 和 接口类 不在同一个包下时，无法使用该方式。</li>
<li>当 Mapper 对应的 XML 文件 和 接口类 名称不同时，无法使用该方式。</li>
</ul>
</li>
</ul>
<ul>
<li><p>将包内的映射器接口实现全部注册为映射器（ 类似于包扫描 ）</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.EveArsh.Dao&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这种方式可以一次性将目标包下的所有 Mapper 全部注册，这种方式相对便捷，但同时有一定问题。</p>
<p>首先，这种方式和第三种方式相同，都会有相同的约束。（ 即 Mapper 的 XML 文件 和 接口类 的问题 ）</p>
<p>其次，若包下存在无法注册为 Mapper 的文件，则会报错使程序无法进行。</p>
</li>
</ul>
<h2 id="3-7-生命周期和作用域"><a href="#3-7-生命周期和作用域" class="headerlink" title="3.7 生命周期和作用域"></a>3.7 生命周期和作用域</h2><p>作用域和生命周期类别是至关重要的，因为错误的使用会导致非常严重的<strong>并发问题</strong>。</p>
<p>在 MyBatis 框架种需要重点注意生命周期和作用域的位置有三种，即 SqlSessionFactoryBuilder、 SqlSessionFactory 和 SqlSession ，这些内容无疑是线程不安全的，若不注意其生命周期和作用域，必定会引起并发问题。</p>
<ul>
<li><p>SqlSessionFactoryBuilder</p>
<p>SqlSessionFactoryBuilder 是标准的生产者模式，其在打开一次后，build 出 SqlSessionFactory 工厂类后就应该被销毁。</p>
<p>因此 SqlSessionFactoryBuilder 应该为一个临时的局部变量，便于销毁，否则会占用多余的资源。</p>
<ul>
<li>最佳作用域是<strong>方法作用域</strong>。（ 也就是局部方法变量 ）</li>
<li>不要一直保留着它，以保证所有的 XML 解析资源可以被释放给更重要的事情。</li>
</ul>
</li>
<li><p>SqlSessionFactory </p>
<p>SqlSessionFactory  是一个工厂模式类，其在被实例化后，可以反复 “ 生产 ” 对应的 SqlSession 类，在我们需要多个 SqlSession  类时，同一个工厂可以反复使用。</p>
<p>因此 SqlSessionFactory 应该为一个一直存在的变量，直到所有的 SqlSession 类实例被关闭，程序结束时，再被销毁。</p>
<ul>
<li>最好将其设定为一个<strong>单例模式的变量，保证其在程序中只存在一个此类型的变量</strong>。</li>
<li>多次重建 SqlSessionFactory 被视为一种代码“坏习惯”。因此 SqlSessionFactory 的最佳作用域是应用作用域。</li>
</ul>
</li>
<li><p>SqlSession </p>
<p>由于 SqlSession 类是直接与数据库挂钩的类，因此每一条线程都需要一个 SqlSession 类的实例变量。</p>
<p>由于 SqlSession 类的特性（ 线程不安全 ），在使用 SqlSession 类的实例对象时，应该在具体方法中临时获取，在使用完后及时销毁，避免出现线程不安全和资源的浪费。</p>
<ul>
<li>SqlSession 的实例不是线程安全的，因此是不能被共享的，所以它的最佳的作用域是请求或<strong>方法作用域</strong>。</li>
<li>绝对不能将 SqlSession 实例的引用放在一个类的静态域，甚至一个类的实例变量也不行。</li>
<li>打开一个 SqlSession 在使用完后一定要关闭它。</li>
</ul>
</li>
</ul>
<h1 id="四、ResultMap"><a href="#四、ResultMap" class="headerlink" title="四、ResultMap"></a>四、ResultMap</h1><h2 id="4-1-数据库中的字段-和-实体类的属性-不同出现的问题"><a href="#4-1-数据库中的字段-和-实体类的属性-不同出现的问题" class="headerlink" title="4.1 数据库中的字段 和 实体类的属性 不同出现的问题"></a>4.1 数据库中的字段 和 实体类的属性 不同出现的问题</h2><p>当数据库中的字段 和 实体类中的属性 不同时就会产生冲突，此时若执行包含冲突字段的 SQL 则有可能出现报错 或者 出现为 NULL 的情况。</p>
<p>这种时候大致可以通过两种方式进行问题的处理。可以分别从 数据库的 SQL 方面 和 Mapper 方面，这两个方面来处理此类问题。</p>
<h2 id="4-2-冲突的解决方法"><a href="#4-2-冲突的解决方法" class="headerlink" title="4.2 冲突的解决方法"></a>4.2 冲突的解决方法</h2><ul>
<li><p>在编写 SQL 时，使用别名</p>
<p>这是最简单粗暴的解决方式，使用 as 字段就可以解决上述问题，例如：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUserList&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;UserMap&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;Map&quot;</span>&gt;</span></span><br><span class="line">    select id, name as UserName, password as pwd from mybatis.user where name like #&#123;userName&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>但无疑，这种方法十分的低效率，如果数据库和对应的实体类有几十个字段的话，就会造成十分冗长的 SQL 语句。</p>
</li>
<li><p>在 Mapper 的 XML 文件中使用 ResultMap </p>
<p>使用 ResultMap 来替换原本的 ResultType 来完成 数据库中的字段 和 实体类 的映射。例如：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;UserMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span> <span class="attr">property</span>=<span class="string">&quot;userName&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;password&quot;</span> <span class="attr">property</span>=<span class="string">&quot;userPassWord&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUserList&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;UserMap&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;Map&quot;</span>&gt;</span></span><br><span class="line">    select * from mybatis.user where name like #&#123;userName&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在上述中， resultMap 的 id 属性和下方的 resultMap 中的 名称相同。</p>
<p>在 resultMap 的子标签下，使用 result 标签来完成 数据库的字段 和 实体类的属性 的关联映射，其中 column 的值对应数据库中的字段，而 property 的值对应数据库中的字段。</p>
<p>在完成了映射后，即可完成查询，这种方法可以在不改变 SQL 语句的情况下来完成原本 SQL 语句的查询。</p>
</li>
<li><p>ResultMap 的一些相关的特性：</p>
<ul>
<li>resultMap 元素是 MyBatis 中最重要最强大的元素。</li>
<li>设计思想是，对简单的语句做到零配置，对于复杂一点的语句，只需要描述语句之间的关系即可。</li>
</ul>
</li>
</ul>
<h1 id="五、日志"><a href="#五、日志" class="headerlink" title="五、日志"></a>五、日志</h1><h2 id="5-1-日志工厂"><a href="#5-1-日志工厂" class="headerlink" title="5.1 日志工厂"></a>5.1 日志工厂</h2><p>Mybatis 通过使用内置的日志工厂提供日志功能。</p>
<p>使用日志需要使用 MyBaits 自带的设定标签 Setting ，其中的 logImpl 项目控制日志的开启和选用，对于 logImpl 的值，MyBatis 预设了许多默认值。</p>
<ul>
<li><p>Apache Commons Logging</p>
<p>Apache下的开源项目，为“所有的Java日志实现”提供一个统一的接口，使项目与日志实现工具解耦，其自身的功能并不强，因此使用的不多。</p>
</li>
<li><p>SLF4J</p>
<p>简单日志门面（Simple Logging Facade for Java），不是具体的日志解决方案，它只服务于各种各样的日志系统。从设计模式的角度考虑，它是用来在log和代码层之间起到门面的作用。</p>
</li>
<li><p>Log4j2</p>
<p>是对Log4j 的升级版本，参考了logback 的一些优秀的设计，并且修复了一些问题，因此带来了一些重大的提升。但 Log4j2 依旧存在着重大漏洞，具体可以参考这篇文章 ：<a target="_blank" rel="noopener" href="https://blog.csdn.net/lumingzhu111/article/details/121871114">log4j2漏洞简析</a></p>
</li>
<li><p>Log4j （3.5.9 起废弃）</p>
<p>Log4j是<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/Apache/8512995">Apache</a>的一个开源项目，通过使用Log4j，我们可以控制日志信息输送的目的地是<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E6%8E%A7%E5%88%B6%E5%8F%B0/2438626">控制台</a>、文件、<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/GUI">GUI</a>组件，甚至是套接口服务器、<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/NT/3443842">NT</a>的事件记录器、<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/UNIX">UNIX</a> <a target="_blank" rel="noopener" href="https://baike.baidu.com/item/Syslog">Syslog</a><a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%AE%88%E6%8A%A4%E8%BF%9B%E7%A8%8B/966835">守护进程</a>等。</p>
<p>但是 Log4j 存在重大安全漏洞，自从 MyBatis 3.5.9 后就被拒绝使用了。</p>
</li>
<li><p>JDK_LOGGING</p>
<p>是 JDK 自带的日志组件，可以直接通过代码来调用其自带的包，来完成调试的作用。</p>
</li>
<li><p>STDOUT_LOGGING</p>
<p>MyBatis 的默认日志输出组件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 标准的日志实现 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;logImpl&quot;</span> <span class="attr">value</span>=<span class="string">&quot;STDOUT_LOGGING&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>COMMONS_LOGGING</p>
<p>Jakarta Commons-logging（JCL）是<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=apache&spm=1001.2101.3001.7020">apache</a> 最早提供的日志的门面接口。</p>
<p>提供简单的日志实现以及日志解耦功能。使用 COMMONS_LOGGING 能够灵活的选择使用那些日志方式，而且不需要修改源代码。</p>
</li>
<li><p>NO_LOGGING</p>
<p>无日志组件</p>
</li>
</ul>
<h1 id="六、分页"><a href="#六、分页" class="headerlink" title="六、分页"></a>六、分页</h1><h2 id="6-1-JDBC的分页"><a href="#6-1-JDBC的分页" class="headerlink" title="6.1 JDBC的分页"></a>6.1 JDBC的分页</h2><p>在原始的 JDBC 代码中，我们实现分页的方式就是使用 Limit 字段，在查询中插入 Limit 【 startIndex，pageSize 】</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> mybatis.user limit startIndex, pageSize;</span><br></pre></td></tr></table></figure>



<ul>
<li><p>为什么要使用分页 ？</p>
<p>分页是出于系统管理的需要，目的是为了更好地满足用户的需要</p>
</li>
</ul>
<ul>
<li><p>原始 JDBC 代码中一个十分特别的 Bug ： -1</p>
<p>在不久之前，查询代码中 pageSize 的位置如果传入的值为 -1 的话，那么就会一次性查询剩下的所有数据并在一页中显示。但是这个用法在不久前被官方承认为一个 Bug 。</p>
<p>现在已经不再能使用这种方式来完成分页查询了。</p>
</li>
</ul>
<h2 id="6-2-MyBatis-实现查询分页"><a href="#6-2-MyBatis-实现查询分页" class="headerlink" title="6.2 MyBatis 实现查询分页"></a>6.2 MyBatis 实现查询分页</h2><p>MyBatis 实现分页查询需要从 接口，Mapper 文件 和 测试类 入手：</p>
<ul>
<li><p>接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用 Limit 来查询用户</span></span><br><span class="line"><span class="keyword">public</span> ArrayList&lt; User &gt; getUserListForLimit( Map&lt;String, Object&gt; paramMap );</span><br></pre></td></tr></table></figure></li>
<li><p>Mapper 文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUserListForLimit&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;UserMap&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;Map&quot;</span>&gt;</span></span><br><span class="line">    select * from mybatis.user limit #&#123;startIndex&#125;, #&#123;pageSize&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>测试类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testTwo</span><span class="params">()</span></span>&#123;</span><br><span class="line">    SqlSession sqlSession = MyBatisUtils.getSqlSession();</span><br><span class="line"></span><br><span class="line">    UserMapper mapper = sqlSession.getMapper( UserMapper.class );</span><br><span class="line">    HashMap&lt; String, Object &gt; paramMap = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    paramMap.put( <span class="string">&quot;startIndex&quot;</span>, <span class="number">0</span> );</span><br><span class="line">    paramMap.put( <span class="string">&quot;pageSize&quot;</span>, <span class="number">2</span> );</span><br><span class="line"></span><br><span class="line">    ArrayList&lt;User&gt; resultList = mapper.getUserListForLimit( paramMap );</span><br><span class="line">    <span class="keyword">for</span> ( User user : resultList ) &#123;</span><br><span class="line">        System.out.println( user.toString() );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    sqlSession.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通过上述的代码，可以通过 MyBatis 的方式来实现 Limit 分页查询。</p>
<p>可以看出，通过 MyBatis 的方式来实现查询分页相对于原始 JDBC 的方式可以有效的减少代码量，提高效率。</p>
</li>
</ul>
<h1 id="七、注解开发"><a href="#七、注解开发" class="headerlink" title="七、注解开发"></a>七、注解开发</h1><h2 id="7-1-面向接口开发"><a href="#7-1-面向接口开发" class="headerlink" title="7.1 面向接口开发"></a>7.1 面向接口开发</h2><p>面向接口开发是当下代码开发十分常见的方式，面向接口开发的思想最起码有以下的好处：</p>
<ul>
<li><p><strong>完成了前后端的解耦</strong></p>
<p>这里说的解耦，指的是解开页面与服务器的耦合。这种低耦合的开发模式，可使开发者们各司其职责，可以在各自最擅长的领域发光发亮，大大提升了开发产品的效率。</p>
</li>
<li><p><strong>后端程序的服务范围更广</strong></p>
<p>一次开发，多端可用。通过同一套接口的约束，可以规范化后端程序的设计。</p>
</li>
</ul>
<p>在 MyBaits 中，面向接口开发的思想十分明显，其中使用注解开发也是一种实现面向接口开发的优秀方式。</p>
<h2 id="7-2-MyBaits-中使用注解开发"><a href="#7-2-MyBaits-中使用注解开发" class="headerlink" title="7.2 MyBaits 中使用注解开发"></a>7.2 MyBaits 中使用注解开发</h2><p>在 MyBaits 中使用使用注解开发就可以不再使用 Mapper 文件的配置即可完成查询。</p>
<p>只需要在接口代码中加入注解即可 ：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Select( &quot;select * from mybatis.user&quot; )</span></span><br><span class="line"><span class="keyword">public</span> ArrayList&lt; User &gt; getUserListSize();</span><br></pre></td></tr></table></figure>



<h2 id="7-3-MyBatis-的执行流程"><a href="#7-3-MyBatis-的执行流程" class="headerlink" title="7.3 MyBatis 的执行流程"></a>7.3 MyBatis 的执行流程</h2><ol>
<li><p>读取 MyBatis 的配置文件，即 全局文件 mybatis-config.xml 。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">String resource = <span class="string">&quot;mybatis-config.xml&quot;</span>;</span><br><span class="line">inputStream = Resources.getResourceAsStream(resource);</span><br></pre></td></tr></table></figure></li>
<li><p>加载映射文件。</p>
<p>映射文件即 SQL 映射文件，该文件中配置了操作数据库的 SQL 语句，需要 在MyBatis 配置文件 mybatis-config.xml 中加载。mybatis-config.xml 文件可以加载多个映射文件，每个文件对应数据库中的一张表。</p>
</li>
<li><p>解析配置文件流 XMLConfigBuilder，获取ConfigBuilder的所有配置信息。</p>
</li>
<li><p>构造会话工厂。</p>
<p>通过MyBatis的环境配置信息构建会话工厂 SqlSessionFactory 。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> SqlSessionFactory sqlSessionFactory = <span class="keyword">null</span>;</span><br><span class="line">sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br></pre></td></tr></table></figure></li>
<li><p>Executor执行器。</p>
<p>MyBatis底层定义了一个 Executor 接口来操作数据库，它将根据SqlSession传递的参数动态地生成需要执行的SQL语句，同时负责查询缓存的维护。</p>
</li>
<li><p>创建会话对象。</p>
<p>由会话工厂创建 SqlSession 对象，该对象中包含了执行 SQL 语句的所有方法。</p>
</li>
<li><p>执行 CRUD。</p>
<p>通过 SqlSession 对象来执行 CRUD 操作，若失败则进行事务的回滚，若成功则将事务提交。</p>
</li>
</ol>
<h2 id="7-4-注解实现-CRUD-操作"><a href="#7-4-注解实现-CRUD-操作" class="headerlink" title="7.4 注解实现 CRUD 操作"></a>7.4 注解实现 CRUD 操作</h2><p>利用注解实现 CRUD 操作的话，可以考虑设置 SqlSession 对象自动完成提交事务的操作，节省下手动 commit 的操作。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> sqlSessionFactory.openSession(<span class="keyword">true</span>);</span><br></pre></td></tr></table></figure>

<p>当向 openSession 函数传入一个 true 值时，就可以使得构造出的 SqlSession 对象自动完成对事务的提交。</p>
<p>由于使用注解实现查询已经在 7.2 中实现了，在这里就不展示查询的实现方式。</p>
<p>此外，由于选择使用注解开发，在这个过程中可能出现不同函数中出现相同形参的问题，那么此时为了使得形参和 SQL 代取的参数对应，应该在形参前加上 param 的注解（ 对象类，例如User，可以不加 ），例如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Param(&quot;name&quot;)</span> String name, <span class="meta">@Param(&quot;password&quot;)</span> String pwd</span><br></pre></td></tr></table></figure>

<p>需要注意的是，如果选择使用注解开发，那么就不能忽视一个重要的问题：当数据库中的字段 和 实体类中的属性 不同时就会产生冲突，此时若执行包含冲突字段的 SQL 则有可能出现报错 或者 出现为 NULL 的情况。</p>
<p>出现这种情况时，我们就应该放弃使用注解，改用映射解决问题。毕竟，注解开发无法解决过于复杂的 SQL 以及处理这种情况。</p>
<h3 id="7-4-1-insert-插入"><a href="#7-4-1-insert-插入" class="headerlink" title="7.4.1 insert 插入"></a>7.4.1 insert 插入</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Insert( &quot;insert into mybatis.user( id, name, password ) values ( #&#123;id&#125;, #&#123;userName&#125;, #&#123;userPassWord&#125; )&quot; )</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">insertUser</span><span class="params">( User user )</span></span>;</span><br></pre></td></tr></table></figure>



<h3 id="7-4-2-update-修改"><a href="#7-4-2-update-修改" class="headerlink" title="7.4.2 update 修改"></a>7.4.2 update 修改</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Update(&quot;update mybatis.user set name = #&#123;userName&#125;, password = #&#123;userPassWord&#125; where id = #&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">upDateUser</span><span class="params">( User user )</span></span>;</span><br></pre></td></tr></table></figure>



<h3 id="7-4-3-delete-删除"><a href="#7-4-3-delete-删除" class="headerlink" title="7.4.3 delete 删除"></a>7.4.3 delete 删除</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Delete(&quot;delete from mybatis.user where id = #&#123;userId&#125;&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">removeUserById</span><span class="params">( <span class="meta">@Param(&quot;userId&quot;)</span><span class="keyword">int</span> id )</span></span>;</span><br></pre></td></tr></table></figure>



<h2 id="7-5-关于-Param-“”-注解-以及-￥-和-的区别"><a href="#7-5-关于-Param-“”-注解-以及-￥-和-的区别" class="headerlink" title="7.5 关于 @Param(“”) 注解 以及 ￥{} 和 #{} 的区别"></a>7.5 关于 @Param(“”) 注解 以及 ￥{} 和 #{} 的区别</h2><h3 id="7-5-1-关于-Param-“”-的一些需要知道的东西"><a href="#7-5-1-关于-Param-“”-的一些需要知道的东西" class="headerlink" title="7.5.1 关于 @Param(“”) 的一些需要知道的东西"></a>7.5.1 关于 @Param(“”) 的一些需要知道的东西</h3><ul>
<li>基本类型的参数 和 String 类型的参数在使用时需要加上 @Param(“”) 注解</li>
<li>引用类型的参数不需要加上 @Param(“”) 注解</li>
<li>若函数的形参只有一个基本类型时，可以选择忽略，但是推荐加上 @Param(“”) 注解</li>
<li>加上了 @Param(“”) 注解后，SQL 中所引用的就是我们在 @Param(“”) 注解中设置的属性名称</li>
</ul>
<h3 id="7-5-2-￥-和-的区别"><a href="#7-5-2-￥-和-的区别" class="headerlink" title="7.5.2 ￥{} 和 #{} 的区别"></a>7.5.2 ￥{} 和 #{} 的区别</h3><p>在 mapper.xml 中有时我们会用到 #{}，${}</p>
<p>**#{} **叫 <strong>预编译处理</strong>，mybatis 在处理 #{} 时，会将 SQL 中的 #{ } 替换为 ? 号，调用 PreparedStatement 的 set 方法来赋值。</p>
<p>传进来的数据会加个” “（#将传入的数据都当成一个字符串，会对自动传入的数据加一个双引号），有效防止 SQL 注入。</p>
<p><strong>${}</strong> 就是字符串替换，字符串拼接参数。直接替换掉占位符。$方式一般用于传入数据库对象，例如传入表名。</p>
<p>综合以上原因，在使用 MyBatis 时，如果可以使用 #{} 就尽可能的使用 #{} ，不过如果在 MyBatis 中使用 OrderBy 语句的话，就要使用 ￥{} 符号来传递值。</p>
<p>使用 #{} 可以有效的防止SQL注入，提高系统安全性。</p>
<h1 id="八、Lombok"><a href="#八、Lombok" class="headerlink" title="八、Lombok"></a>八、Lombok</h1><h2 id="8-1-Lombok-的介绍"><a href="#8-1-Lombok-的介绍" class="headerlink" title="8.1 Lombok 的介绍"></a>8.1 Lombok 的介绍</h2><p>Lombok项目是一个java库，它可以自动插入到编辑器和构建工具中，增强java的性能。</p>
<p>不要再写另一个getter或equals方法，只要有一个注释，你的类就有一个功能齐全的构建器，自动记录变量等等。</p>
<p>用注解的方式，简化了 JavaBean 的编写，避免了冗余和样板式代码而出现的插件，让编写的类更加简洁。</p>
<p>Lombok 的 Maven 导入：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- Lombok导入 --&gt;</span><br><span class="line">&lt;!-- https:<span class="comment">//mvnrepository.com/artifact/org.projectlombok/lombok --&gt;</span></span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;lombok&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;<span class="number">1.18</span><span class="number">.12</span>&lt;/version&gt;</span><br><span class="line">    &lt;scope&gt;provided&lt;/scope&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>



<h2 id="8-2-Lombok-的使用步骤"><a href="#8-2-Lombok-的使用步骤" class="headerlink" title="8.2 Lombok 的使用步骤"></a>8.2 Lombok 的使用步骤</h2><p>1、在 IDEA 中安装 Lombok 的插件</p>
<p>2、导入与 Lombok 相关的 jar 包</p>
<p>3、在相关原始类下使用对应的注解，所有的可用注解可以在 IDEA 的组件管理中 Lombok 相关的位置下查询。下面是一些常用的注解：</p>
<table>
<thead>
<tr>
<th align="center">注解</th>
<th align="center">效果</th>
</tr>
</thead>
<tbody><tr>
<td align="center">@Data</td>
<td align="center">无参构造、Set、Get、toString、equals、hashCode</td>
</tr>
<tr>
<td align="center">@Getter 和 @Setter</td>
<td align="center">Get 和 Set</td>
</tr>
<tr>
<td align="center">@AllArgsConstructor 和 @NoArgsConstructor</td>
<td align="center">有参构造 和 无参构造</td>
</tr>
</tbody></table>
<p>另外，Lombok 的注解可用使用在字段 和 类上，也就是说，可以生成指定的简单方法。</p>
<p>但是，Lombok 不支持参数构造器的重载 ； 同时，使用 Lombok 会导致源码的可阅读性降低，减少了源码的完整度。</p>
<h1 id="九、多对一-和-一对多"><a href="#九、多对一-和-一对多" class="headerlink" title="九、多对一 和 一对多"></a>九、多对一 和 一对多</h1><h2 id="9-1-关联和集合"><a href="#9-1-关联和集合" class="headerlink" title="9.1 关联和集合"></a>9.1 关联和集合</h2><p>多对一 ： 多个对象 <strong>关联</strong> 一个对象，称之为 多对一。</p>
<p>一对多 ： 一个对象 <strong>集合</strong> 多个对象，称之为 一对多。</p>
<p>搭建测试环境 ：</p>
<p>1、导入 Lombok（ 下载 Lombok 插件，导入相关 Jar 包 ）</p>
<p>2、新建实体类</p>
<p>3、 建立对应的 Mapper 接口</p>
<p>4、 建立 Mapper.XML 文件</p>
<p>5、 测试查询</p>
<h2 id="9-2-多对一的复杂查询方式"><a href="#9-2-多对一的复杂查询方式" class="headerlink" title="9.2 多对一的复杂查询方式"></a>9.2 多对一的复杂查询方式</h2><p>多对一也就是关联的复杂查询有两种常用的查询方式：</p>
<p>在多对一的查询中，需要用到 Mapper 中的 <strong>association</strong> 标签</p>
<ul>
<li><p>子查询</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;studentMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Student&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;studentName&quot;</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;teacher&quot;</span> <span class="attr">column</span>=<span class="string">&quot;tid&quot;</span> <span class="attr">javaType</span>=<span class="string">&quot;Teacher&quot;</span> <span class="attr">select</span>=<span class="string">&quot;getTeacherForId&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getStudentWhichTeacher&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;studentMap&quot;</span>&gt;</span></span><br><span class="line">    select * from mybatis.student;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getTeacherForId&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;teacherMap&quot;</span>&gt;</span></span><br><span class="line">    select * from mybatis.teacher where id = #&#123;tid&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>使用这种方式，可以使得查询层次分明。在这个映射中，先查询出所有 student 表中所有的数据。</p>
<p>在查询 student 表中每个值时，会取出对应的 tid ，然后将 tid 传入到对应的 Mapper 映射的 getTeacherForId 中，将 tid 作为传入对应函数中。</p>
<p>下面解释一下 association 标签：</p>
<table>
<thead>
<tr>
<th align="center"><strong>property</strong></th>
<th align="center"><strong>原始类中的属性</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="center"><strong>column</strong></td>
<td align="center"><strong>传入嵌套函数的参数</strong></td>
</tr>
<tr>
<td align="center"><strong>javaType</strong></td>
<td align="center"><strong>属性所对应的类</strong></td>
</tr>
<tr>
<td align="center"><strong>select</strong></td>
<td align="center"><strong>用于嵌套的查询函数</strong></td>
</tr>
</tbody></table>
</li>
<li><p>连表查询</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getStudentList2&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;teacherMap2&quot;</span>&gt;</span></span><br><span class="line">    SELECT s.id sid, s.name sname, t.name tname </span><br><span class="line">    from mybatis.student s join mybatis.teacher t on s.tid = t.id;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;teacherMap2&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Student&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;sid&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;studentName&quot;</span> <span class="attr">column</span>=<span class="string">&quot;sname&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;teacher&quot;</span> <span class="attr">javaType</span>=<span class="string">&quot;Teacher&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;teacherName&quot;</span> <span class="attr">column</span>=<span class="string">&quot;tname&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这种方式是连表查询在 MyBaits 中的衍生，简而言之，主要思想就是使用正常的连表查询，然后在其对应的映射中将所有的属性和对应的列关联。</p>
<p>不过，关联时，若使用这种方式，那么关联的列名应该为 SQL 语句中的别名。</p>
</li>
</ul>
<h2 id="9-3-一对多的复杂查询方式"><a href="#9-3-一对多的复杂查询方式" class="headerlink" title="9.3 一对多的复杂查询方式"></a>9.3 一对多的复杂查询方式</h2><p>一对多也就是关联的复杂查询有两种常用的查询方式：</p>
<p>在一对多的查询中，需要用到 Mapper 中的 <strong>collection</strong> 标签</p>
<ul>
<li><p>子查询</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;TeacherMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Teacher&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;teacherName&quot;</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">&quot;students&quot;</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span> </span></span><br><span class="line"><span class="tag">                <span class="attr">javaType</span>=<span class="string">&quot;ArrayList&quot;</span> <span class="attr">ofType</span>=<span class="string">&quot;Student&quot;</span> <span class="attr">select</span>=<span class="string">&quot;getStudentForTid&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;StudentMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Student&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;studentName&quot;</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;teacherId&quot;</span> <span class="attr">column</span>=<span class="string">&quot;tid&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getTeacherList&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;TeacherMap&quot;</span>&gt;</span></span><br><span class="line">    select * from mybatis.teacher where id = #&#123;tid&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getStudentForTid&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;StudentMap&quot;</span>&gt;</span></span><br><span class="line">    select * from mybatis.student where tid = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>使用这种方式，可以使得查询层次分明。在这个映射中，先查询出所有 teacher 表中所有的数据。</p>
<p>在查询 teacher 表中每个值时，会取出对应的 id，然后将 id 传入到对应的 Mapper 映射的 getStudentForTid 中，将 id 作为传入对应函数中。 </p>
<p>下面解释一下 association 标签中各个值：</p>
<table>
<thead>
<tr>
<th align="center"><strong>property</strong></th>
<th align="center"><strong>原始类中的属性</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="center"><strong>column</strong></td>
<td align="center"><strong>传入嵌套函数的参数</strong></td>
</tr>
<tr>
<td align="center"><strong>javaType</strong></td>
<td align="center"><strong>属性所对应的类</strong></td>
</tr>
<tr>
<td align="center"><strong>select</strong></td>
<td align="center"><strong>用于嵌套的查询函数</strong></td>
</tr>
<tr>
<td align="center"><strong>ofType</strong></td>
<td align="center"><strong>集合泛型中的类型</strong></td>
</tr>
</tbody></table>
</li>
<li><p>连表查询</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getTeacherById&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;TeacherMap2&quot;</span>&gt;</span></span><br><span class="line">    SELECT s.id sid, s.name sname, t.id tid, t.name tname</span><br><span class="line">    from mybatis.student s join mybatis.teacher t on s.tid = t.id</span><br><span class="line">    where t.id = #&#123;tid&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;TeacherMap2&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Teacher&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;tid&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;teacherName&quot;</span> <span class="attr">column</span>=<span class="string">&quot;tname&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">&quot;students&quot;</span> <span class="attr">ofType</span>=<span class="string">&quot;Student&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;sid&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;studentName&quot;</span> <span class="attr">column</span>=<span class="string">&quot;sname&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;teacherId&quot;</span> <span class="attr">column</span>=<span class="string">&quot;tid&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这种方式是连表查询在 MyBaits 中的衍生，简而言之，主要思想就是使用正常的连表查询，然后在其对应的映射中将所有的属性和对应的列关联。</p>
<p>不过，关联时，若使用这种方式，那么关联的列名应该为 SQL 语句中的别名。</p>
<p>从上面的两种方式可以看出，若使用 连表查询，则可以减少 Mapper 映射的复杂度，但相对的 SQL 的复杂度上升 ； 若使用 子查询方式，则可以减少 SQL 语句的复杂度，但相对的 Mapper 映射的复杂度上升。</p>
</li>
</ul>
<h1 id="十、动态-SQL"><a href="#十、动态-SQL" class="headerlink" title="十、动态 SQL"></a>十、动态 SQL</h1><h2 id="10-1-什么是动态-SQL"><a href="#10-1-什么是动态-SQL" class="headerlink" title="10.1 什么是动态 SQL"></a>10.1 什么是动态 SQL</h2><p>SQL 的内容是变化的, 可以根据条件获取到不同的 SQL 语句。<br>主要是 where 部分发生变化。<br>动态sql的实现, 使用的是 MyBatis 提供的标签。</p>
<h2 id="10-2-IF-语句"><a href="#10-2-IF-语句" class="headerlink" title="10.2 IF 语句"></a>10.2 IF 语句</h2><p>使用动态 SQL 最常见情景是根据条件包含 where 子句的一部分。</p>
<p>其中的 IF 语句是常用的语句之一，作为条件判断来拼接 SQL 。需要使用 MyBatis 自带的标签来完成 SQL 的动态拼接。</p>
<p>例如以下状态：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getBlogListByIF&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;Map&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;BlogMap&quot;</span>&gt;</span></span><br><span class="line">    select * from mybatis.blog</span><br><span class="line">    where 1 = 1</span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;blogTitle != null&quot;</span>&gt;</span></span><br><span class="line">        and title like #&#123;blogTitle&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;blogAuthor != null&quot;</span>&gt;</span></span><br><span class="line">        and author = #&#123;blogAuthor&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>可以看出，为了使得 SQL 语句更加利于拼接，可以在 where 后加上一个绝对准确的条件，比如 1 = 1。由此来保证不使用 if 标签的情况下，可以查询出所有的数据。</p>
<p>在查询出所有的数据后，再附加条件就可以轻松的完成对 SQL  的拼接。</p>
<h2 id="10-2-Choose（-When，Otherwise）-语句"><a href="#10-2-Choose（-When，Otherwise）-语句" class="headerlink" title="10.2 Choose（ When，Otherwise） 语句"></a>10.2 Choose（ When，Otherwise） 语句</h2><p>有时候，我们不想使用所有的条件，而只是想从多个条件中选择一个使用。</p>
<p>针对这种情况，MyBatis 提供了 choose 元素，它有点像 Java 中的 switch 语句。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getBlogListByWhich&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;Map&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;BlogMap&quot;</span>&gt;</span></span><br><span class="line">    select * from mybatis.blog</span><br><span class="line">    <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">choose</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">&quot;blogTitle != null&quot;</span>&gt;</span></span><br><span class="line">                title = #&#123;blogTitle&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">&quot;blogAuthor != null&quot;</span>&gt;</span></span><br><span class="line">                author = #&#123;blogAuthor&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">otherwise</span>&gt;</span></span><br><span class="line">                views = #&#123;blogViews&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">otherwise</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">choose</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>就和 Java 中的 switch 语句相似，choose 对应 switch 、 when 对应 case、otherwise 对应 default 。</p>
<p>另外，choose 标签如果和上方的模式相同，标签内的语句没有前缀的话，需要嵌套在 where 标签内使用。</p>
<p>choose 标签和 swith 结构还有一个相似处，那就是都只会处理第一个满足条件的语句，剩下的其他的语句就算是满足条件也不会进行处理，会自动忽略。</p>
<h2 id="10-3-Trim（-Set，Where）-语句"><a href="#10-3-Trim（-Set，Where）-语句" class="headerlink" title="10.3 Trim（ Set，Where） 语句"></a>10.3 Trim（ Set，Where） 语句</h2><p>MyBatis 有一个简单且适合大多数场景的解决办法。而在其他场景中，可以对其进行自定义以符合需求。</p>
<p>也就是使用 Tirm 标签，这个标签可以自由的自定义标签、前后缀的定义情况。</p>
<h3 id="10-3-1-where-标签"><a href="#10-3-1-where-标签" class="headerlink" title="10.3.1 where 标签"></a>10.3.1 where 标签</h3><p>在 SQL 的执行过程中，有可能出现这样的情况：第一条 IF 语句判读为失败，第二条判断为成功。此时的 SQL 就会出现 where 语句后直接接 and 的现象，导致错误。</p>
<p>在之前 (  10.1 什么是动态SQL  ) ，我们使用在 where 后加上一个 “绝对正确” 的条件来避开这个问题，但终究是不好看。现在在这里提出另一个解决思路，那就是使用 where 标签。例如：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getBlogListByIF&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;Map&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;BlogMap&quot;</span>&gt;</span></span><br><span class="line">    select * from mybatis.blog</span><br><span class="line">    <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;blogTitle != null&quot;</span>&gt;</span></span><br><span class="line">            and title like #&#123;blogTitle&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;blogAuthor != null&quot;</span>&gt;</span></span><br><span class="line">            and author = #&#123;blogAuthor&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">==&gt;  Preparing: select * from mybatis.blog WHERE title like ? and author = ?</span><br></pre></td></tr></table></figure>

<p>在使用 where 标签后，可以从日志的打印看出 <em>where</em> 标签自动帮助我们去掉了第一个成功条件中的 and 。</p>
<p>那么根据官方的解释 <em>where</em> 元素只会在子元素返回任何内容的情况下才插入 “WHERE” 子句。</p>
<p>而且，若子句的开头为 “AND” 或 “OR”，<em>where</em> 元素也会将它们去除。</p>
<p>并且使用 <em>where</em> 标签，可以避免在使用 “绝对正确” 的条件时后缀为 OR 语句时导致查询失效的问题。</p>
<h3 id="10-3-1-set标签"><a href="#10-3-1-set标签" class="headerlink" title="10.3.1 set标签"></a>10.3.1 set标签</h3><p><em>set</em> 元素可以用于动态包含需要更新的列，忽略其它不更新的列。</p>
<p>这个例子中，<em>set</em> 元素会动态地在行首插入 SET 关键字，并会删掉额外的逗号（这些逗号是在使用条件语句给列赋值时引入的）。</p>
<p>当然，我们也可以使用 trim 来完成相同的功能</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;updateBlog&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;Map&quot;</span>&gt;</span></span><br><span class="line">    update mybatis.blog</span><br><span class="line">    <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;blogTitle != null&quot;</span>&gt;</span></span><br><span class="line">            title = #&#123;blogTitle&#125;,</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;blogAuthor != null&quot;</span>&gt;</span></span><br><span class="line">            author = #&#123;blogAuthor&#125;,</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    where id = #&#123;id&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">==&gt;  Preparing: update mybatis.blog SET title = ? where id = ?;</span><br></pre></td></tr></table></figure>

<p>在使用 set 标签后，可以从日志的打印看出 <em>set</em> 标签自动帮助我们去掉了最后一个成功条件中的后缀 ， 。</p>
<p>那么根据官方的解释 <em>set</em> 标签只会在子元素返回任何内容的情况下才插入 “SET” 子句。</p>
<p>另外，如果 <em>set</em> 标签中所有的 <em>if</em> 条件都不被满足时，就会导致程序报错，原因为 SQL 语句错误。因为没有生成 Set 子句会导致 Update 语句不完整从而导致 SQL 语句错误。</p>
<h2 id="10-4-ForEach"><a href="#10-4-ForEach" class="headerlink" title="10.4 ForEach"></a>10.4 ForEach</h2><p>动态 SQL 的另一个常见使用场景是对集合进行遍历（尤其是在构建 IN 条件语句的时候）。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;queryBlogByScope&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;Map&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;BlogMap&quot;</span>&gt;</span></span><br><span class="line">    select * from mybatis.blog</span><br><span class="line">    <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">&quot;idList&quot;</span> <span class="attr">item</span>=<span class="string">&quot;userId&quot;</span> <span class="attr">open</span>=<span class="string">&quot;and (&quot;</span> <span class="attr">separator</span>=<span class="string">&quot;or&quot;</span> <span class="attr">close</span>=<span class="string">&quot;)&quot;</span>&gt;</span></span><br><span class="line">            id = #&#123;userId&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">==&gt;  Preparing: select * from mybatis.blog WHERE ( id = ? or id = ? or id = ? )</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">HashMap&lt;String, Object&gt; paramMap = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">ArrayList&lt;String&gt; idList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">idList.add( <span class="string">&quot;6b3ed630f98941a88fd82a2060b8569c&quot;</span> );</span><br><span class="line">idList.add( <span class="string">&quot;d9b2e30d451c4d5e8e95b07681d07430&quot;</span> );</span><br><span class="line">idList.add( <span class="string">&quot;49c63e9df7544ba4a7f96e7951a9f693&quot;</span> );</span><br><span class="line">paramMap.put( <span class="string">&quot;idList&quot;</span>, idList );</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>从上方的代码以及日志的打印语句不难看出，<em>foreach</em> 标签依旧实行的是 SQL 字段的拼接，只不过在标签的量上相较有点复杂。</p>
<p>下面解释其中所携带的标签意义：</p>
<table>
<thead>
<tr>
<th align="center">collection</th>
<th align="center"><strong>传入的泛型（ 如List、Map ）</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="center"><strong>item</strong></td>
<td align="center"><strong>collection中携带的类型</strong></td>
</tr>
<tr>
<td align="center"><strong>open</strong></td>
<td align="center"><strong>开始拼接时的第一个符号</strong></td>
</tr>
<tr>
<td align="center"><strong>separator</strong></td>
<td align="center"><strong>分割符</strong></td>
</tr>
<tr>
<td align="center"><strong>close</strong></td>
<td align="center"><strong>结束拼接时的最后一个符号</strong></td>
</tr>
</tbody></table>
<p><em>foreach</em> 元素的功能非常强大，它允许你指定一个集合，声明可以在元素体内使用的集合项（item）和索引（index）变量。</p>
<p>它也允许你指定开头与结尾的字符串以及集合项迭代之间的分隔符。这个元素也不会错误地添加多余的分隔符。</p>
<p>可以将任何可迭代对象（如 List、Set 等）、Map 对象或者数组对象作为集合参数传递给 <em>foreach</em>。</p>
<p>当使用可迭代对象或者数组时，index 是当前迭代的序号，item 的值是本次迭代获取到的元素。</p>
<p>当使用 Map 对象（或者 Map.Entry 对象的集合）时，index 是键，item 是值。</p>
<h2 id="10-5-SQL-片段"><a href="#10-5-SQL-片段" class="headerlink" title="10.5 SQL 片段"></a>10.5 SQL 片段</h2><p>有的时候，我们可以将一些公共部分抽取出来，方便复用。</p>
<p>1、抽取 SQL 语句中的公共部分</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">sql</span> <span class="attr">id</span>=<span class="string">&quot;if-title-author&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;blogTitle != null&quot;</span>&gt;</span></span><br><span class="line">        title = #&#123;blogTitle&#125;,</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;blogAuthor != null&quot;</span>&gt;</span></span><br><span class="line">        author = #&#123;blogAuthor&#125;,</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">sql</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>2、在 SQL 中导入 SQL 片段</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">&quot;if-title-author&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br></pre></td></tr></table></figure>



<ul>
<li>提取的片段最好是基于单表的定义 SQL 片段</li>
<li>不要存在 <em>where</em>、 <em>set</em> 标签</li>
</ul>
<h1 id="十一、缓存"><a href="#十一、缓存" class="headerlink" title="十一、缓存"></a>十一、缓存</h1><h2 id="11-1-缓存的介绍"><a href="#11-1-缓存的介绍" class="headerlink" title="11.1 缓存的介绍"></a>11.1 缓存的介绍</h2><h3 id="11-1-1-缓存的概念"><a href="#11-1-1-缓存的概念" class="headerlink" title="11.1.1 缓存的概念"></a>11.1.1 缓存的概念</h3><p>缓存是存在内存中的临时数据，是为了加快用户进行 CRUD 等操作而被产生的概念。</p>
<p>将操作数据库得到的值存放在计算机的内存中，在下次需要该值的时候就直接从内存中取用该值，这就是缓存。</p>
<h3 id="11-1-2-缓存的意义以及使用环境"><a href="#11-1-2-缓存的意义以及使用环境" class="headerlink" title="11.1.2 缓存的意义以及使用环境"></a>11.1.2 缓存的意义以及使用环境</h3><p>使用缓存的意义 ： 使用缓存可以减少和数据库的交互次数，减少系统开销，提高系统的效率。</p>
<p>缓存的适用范围 ：经常查询且不会轻易更改的数据。</p>
<h3 id="11-1-3-MyBatis-缓存"><a href="#11-1-3-MyBatis-缓存" class="headerlink" title="11.1.3 MyBatis 缓存"></a>11.1.3 MyBatis 缓存</h3><p>MyBatis 内置了一个强大的事务性查询缓存机制，它可以非常方便地配置和定制。</p>
<p>MyBatis 默认配置了两个缓存 ： 一级缓存 和 二级缓存</p>
<ul>
<li>默认情况下，只开启一级缓存（ 也就是本地缓存 ）</li>
<li>二级缓存需要手动开启和配置，基于 namespace 级别的缓存</li>
<li>可以通过 Cache 接口来自定义二级缓存</li>
</ul>
<p>默认情况下，只启用了本地的会话缓存，它仅仅对一个会话中的数据进行缓存。 要启用全局的二级缓存，只需要在你的 SQL 映射文件中添加一行：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">cache</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>要注意的是，二级缓存是事务性的。</p>
<p>这意味着，当 SqlSession 完成并提交时，或是完成并回滚，但没有执行 flushCache=true 的 insert/delete/update 语句时，缓存会获得更新。</p>
<h2 id="11-2-一级缓存"><a href="#11-2-一级缓存" class="headerlink" title="11.2 一级缓存"></a>11.2 一级缓存</h2><h3 id="11-2-1-一级缓存的验证"><a href="#11-2-1-一级缓存的验证" class="headerlink" title="11.2.1 一级缓存的验证"></a>11.2.1 一级缓存的验证</h3><p>一级缓存默认开启，作用域和 SqlSession 相同  且 <strong>无法关闭</strong> 。</p>
<p>一级缓存，也可以称之为本地缓存，作用域与 SqlSession 同级别。</p>
<ul>
<li>与数据库的同一次会话中，查询出的数据会被存贮在本地缓存中。</li>
<li>若需要相同的数据，可以直接从缓存中获取。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">ArrayList&lt;User&gt; userList = mapper.getUserList();</span><br><span class="line">System.out.println( userList.size() );</span><br><span class="line"></span><br><span class="line">System.out.println( <span class="string">&quot;**********************************&quot;</span> );</span><br><span class="line"></span><br><span class="line">ArrayList&lt;User&gt; userList2 = mapper.getUserList();</span><br><span class="line">System.out.println( userList2.size() );</span><br><span class="line"></span><br><span class="line">System.out.println( <span class="string">&quot;**********************************&quot;</span> );</span><br><span class="line"></span><br><span class="line">System.out.println( userList == userList2 );</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Opening JDBC Connection</span><br><span class="line">Created connection <span class="number">1899141525.</span></span><br><span class="line">Setting autocommit to <span class="keyword">false</span> on JDBC Connection [com.mysql.cj.jdbc.ConnectionImpl@<span class="number">71329995</span>]</span><br><span class="line">==&gt;  Preparing: select * from mybatis.user</span><br><span class="line">==&gt; Parameters: </span><br><span class="line">&lt;==    Columns: id, name, password</span><br><span class="line">&lt;==        Row: <span class="number">1</span>, 管理员, <span class="number">1234567</span></span><br><span class="line">&lt;==        Row: <span class="number">2</span>, 李四, ycy856249</span><br><span class="line">&lt;==        Row: <span class="number">3</span>, 张三, <span class="number">1234567</span></span><br><span class="line">&lt;==        Row: <span class="number">4</span>, 李六, <span class="number">1234567</span></span><br><span class="line">&lt;==      Total: <span class="number">4</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line">**********************************</span><br><span class="line"><span class="number">4</span></span><br><span class="line">**********************************</span><br><span class="line"><span class="keyword">true</span></span><br></pre></td></tr></table></figure>

<p>通过上方的代码可以看出，我们进行了两次相同的查询。然后观察日志，可以发现查询函数对应的 SQL 语句只被执行了一次，对应的连接也只被打开了一次。</p>
<p>并且，两次查询所获得的列表本质上是同一个列表，将两次查询结果进行比较，返回值为 true。</p>
<p>综上所述，我们可以认为，第二次查询其实只是将第一次查询的结果从缓存中取出从而得到的值。</p>
<h3 id="11-2-2-缓存的失效情况"><a href="#11-2-2-缓存的失效情况" class="headerlink" title="11.2.2 缓存的失效情况"></a>11.2.2 缓存的失效情况</h3><ul>
<li>不同的查询。</li>
<li>在两次查询之间，执行了 UpData，Delete 或 Insert 语句。</li>
<li>查询不同的 Mapper。</li>
<li>手动清除缓存。<ul>
<li>手动清除缓存需要使用 SqlSession 的 cleanCache 函数。</li>
</ul>
</li>
</ul>
<h2 id="11-3-二级缓存"><a href="#11-3-二级缓存" class="headerlink" title="11.3 二级缓存"></a>11.3 二级缓存</h2><p>默认情况下，只启用了本地的会话缓存，它仅仅对一个会话中的数据进行缓存。 要启用全局的二级缓存，只需要在你的 SQL 映射文件中添加一行：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">cache</span>/&gt;</span></span><br></pre></td></tr></table></figure>



<p>cahce 标签是可被定制的，通过修改 cache 属性就可以自定义二级缓存。比如：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">cache</span> <span class="attr">eviction</span>=<span class="string">&quot;FIFO&quot;</span> <span class="attr">flushInterval</span>=<span class="string">&quot;60000&quot;</span> <span class="attr">size</span>=<span class="string">&quot;512&quot;</span> <span class="attr">readOnly</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>这个更高级的配置创建了一个 FIFO 缓存，每隔 60 秒刷新，最多可以存储结果对象或列表的 512 个引用，而且返回的对象被认为是只读的，因此对它们进行修改可能会在不同线程中的调用者产生冲突。</p>
<p>二级缓存也叫全局缓存，因为一级缓存作用域过低，由此有了二级缓存。</p>
<p>二级缓存是基于 namespace 级别的缓存，一个名称控件，对应一个二级缓存。</p>
<h3 id="11-3-1-二级缓存的工作机制"><a href="#11-3-1-二级缓存的工作机制" class="headerlink" title="11.3.1 二级缓存的工作机制"></a>11.3.1 二级缓存的工作机制</h3><ul>
<li>一个会话查询一条数据，这个数据会被存入一级缓存中。</li>
<li>如果当前的会话关闭，其中包含的一级缓存也会被销毁 ； 但 二级缓存的作用是将一级缓存中的值保存到二级缓存中。</li>
<li>新的查询若需要数据，可以从二级缓存中直接获取。</li>
<li>不同的 mapper 查出的数据会放在自己对应的缓存中。</li>
</ul>
<h3 id="11-3-2-二级缓存的使用"><a href="#11-3-2-二级缓存的使用" class="headerlink" title="11.3.2 二级缓存的使用"></a>11.3.2 二级缓存的使用</h3><p>一般而言，cache 标签无法使得 MyBatis 使用二级缓存。需要一些其他的系统设置，来开启二级缓存。</p>
<p>1、开启全局缓存：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;cacheEnabled&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>



<p>2、在需要二级缓存的 Mapper 中开启二级缓存：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">cache</span> <span class="attr">eviction</span>=<span class="string">&quot;FIFO&quot;</span> <span class="attr">flushInterval</span>=<span class="string">&quot;60000&quot;</span> <span class="attr">size</span>=<span class="string">&quot;512&quot;</span> <span class="attr">readOnly</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>



<p>3、通过代码验证二级缓存的实现：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">SqlSession sqlSession = MyBatisUtils.getSqlSession();</span><br><span class="line">SqlSession sqlSession1 = MyBatisUtils.getSqlSession();</span><br><span class="line"></span><br><span class="line">UserMapper mapper = sqlSession.getMapper(UserMapper.class);</span><br><span class="line">ArrayList&lt;User&gt; userList = mapper.getUserList();</span><br><span class="line">System.out.println( userList.size() );</span><br><span class="line">sqlSession.close();</span><br><span class="line"></span><br><span class="line">System.out.println( <span class="string">&quot;**********************************************************&quot;</span> );</span><br><span class="line"></span><br><span class="line">UserMapper mapper1 = sqlSession1.getMapper(UserMapper.class);</span><br><span class="line">ArrayList&lt;User&gt; userList1 = mapper1.getUserList();</span><br><span class="line">System.out.println( userList1.size() );</span><br><span class="line">sqlSession1.close();</span><br><span class="line"></span><br><span class="line">System.out.println( <span class="string">&quot;**********************************************************&quot;</span> );</span><br><span class="line"></span><br><span class="line">System.out.println( userList == userList1 );</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">Opening JDBC Connection</span><br><span class="line">Created connection 1815007437.</span><br><span class="line">Setting autocommit to false on JDBC Connection [com.mysql.cj.jdbc.ConnectionImpl@6c2ed0cd]</span><br><span class="line">==&gt;  Preparing: select * from mybatis.user</span><br><span class="line">==&gt; Parameters: </span><br><span class="line">&lt;==    Columns: id, name, password</span><br><span class="line">&lt;==        Row: 1, 管理员, 1234567</span><br><span class="line">&lt;==        Row: 2, 李四, ycy856249</span><br><span class="line">&lt;==        Row: 3, 张三, 1234567</span><br><span class="line">&lt;==        Row: 4, 李六, 1234567</span><br><span class="line">&lt;==      Total: 4</span><br><span class="line">4</span><br><span class="line">Resetting autocommit to true on JDBC Connection [com.mysql.cj.jdbc.ConnectionImpl@6c2ed0cd]</span><br><span class="line">Closing JDBC Connection [com.mysql.cj.jdbc.ConnectionImpl@6c2ed0cd]</span><br><span class="line">Returned connection 1815007437 to pool.</span><br><span class="line">**********************************************************</span><br><span class="line">Cache Hit Ratio [com.EveArsh.Dao.UserMapper]: 0.5</span><br><span class="line">4</span><br><span class="line">**********************************************************</span><br><span class="line">true</span><br></pre></td></tr></table></figure>

<p>从上方的代码和日志输出看出，两次不同作用域下的数据可以通用。</p>
<p>这就是使用了二级缓存的作用，即使第一次执行查询的 SQL 已经被关闭，即使如此，第二次执行相同查询的 SQL 依旧可以使用第一次的数据。（ 可以看见 SQL 在第一次查询时已经进行了一次关闭和打开连接，而第二次并没有打开连接直接获取数据 ）</p>
<p>并且，两次查询所获得的列表本质上是同一个列表，将两次查询结果进行比较，返回值为 true。</p>
<p>综上所述，我们可以认为，第二次查询其实只是将第一次查询的结果从缓存中取出从而得到的值。</p>
<h3 id="11-3-3-数据序列化"><a href="#11-3-3-数据序列化" class="headerlink" title="11.3.3 数据序列化"></a>11.3.3 数据序列化</h3><p>在对应的原始 Java 类上实现 Serializable 接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">implements</span> <span class="title">Serializable</span></span></span><br></pre></td></tr></table></figure>

<p>序列化可以有效避开 org.apache.ibatis.cache.CacheException: Error serializing object.  的问题</p>
<h2 id="11-4-缓存原理"><a href="#11-4-缓存原理" class="headerlink" title="11.4 缓存原理"></a>11.4 缓存原理</h2><h3 id="11-4-1-缓存的执行顺序"><a href="#11-4-1-缓存的执行顺序" class="headerlink" title="11.4.1 缓存的执行顺序"></a>11.4.1 缓存的执行顺序</h3><ol>
<li>用户发来请求，从二级缓存中查找是否有匹配的值，若有则将其返回 ；若没有则进行下一步。</li>
<li>在一级缓存中查找是否有匹配的值，若有将其返回 ； 若没有则进行下一步。</li>
<li>按照用户提供的条件进行查询，结束后将结果存入 一级缓存。</li>
</ol>
<h3 id="11-4-2-缓存执行的特殊情况"><a href="#11-4-2-缓存执行的特殊情况" class="headerlink" title="11.4.2 缓存执行的特殊情况"></a>11.4.2 缓存执行的特殊情况</h3><p>由上方的执行步骤可知，在查询缓存时，会优先查询第二缓存，也就是全局缓存。</p>
<p>这是由于可能会出现 第一缓存对应的 SqlSesson 还未关闭，而用户的下一条请求已经发来的情况下，为了保证查询的正确，应该优先查询第二缓存。</p>
<h2 id="11-5-自定义缓存-ehcache"><a href="#11-5-自定义缓存-ehcache" class="headerlink" title="11.5 自定义缓存 ehcache"></a>11.5 自定义缓存 ehcache</h2><h3 id="11-5-1-ehchae的介绍"><a href="#11-5-1-ehchae的介绍" class="headerlink" title="11.5.1 ehchae的介绍"></a>11.5.1 ehchae的介绍</h3><p>EhCache 是一个纯 Java 的进程内缓存框架，具有快速、精干等特点，是 Hibernate 中默认的 CacheProvider。</p>
<p>Ehcache 是一种广泛使用的开源 Java 分布式缓存。</p>
<p>主要面向通用缓存,Java EE和轻量级容器。</p>
<h3 id="11-5-2-ehcache的使用"><a href="#11-5-2-ehcache的使用" class="headerlink" title="11.5.2 ehcache的使用"></a>11.5.2 ehcache的使用</h3><ul>
<li><p>导入 ehchae 相关的 Jar 包 。</p>
</li>
<li><p>在 <cacahe> 标签中使用 Type 属性加入 ehcache，如下：</cacahe></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">cache</span> <span class="attr">type</span>=<span class="string">&quot;org.mybatis.caches.ehcache.EhcacheCache &quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/04/24/JDBC%E5%92%8C%E6%96%B9%E6%B3%95%E6%8F%90%E5%8F%96/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="神秘的世界">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/04/24/JDBC%E5%92%8C%E6%96%B9%E6%B3%95%E6%8F%90%E5%8F%96/" class="post-title-link" itemprop="url">JDBC和方法提取</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-04-24 12:28:00" itemprop="dateCreated datePublished" datetime="2022-04-24T12:28:00+08:00">2022-04-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-04-25 15:22:35" itemprop="dateModified" datetime="2022-04-25T15:22:35+08:00">2022-04-25</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="数据库驱动-和-JDBC"><a href="#数据库驱动-和-JDBC" class="headerlink" title="数据库驱动 和 JDBC"></a>数据库驱动 和 <em>JDBC</em></h2><h4 id="数据库驱动"><a href="#数据库驱动" class="headerlink" title="数据库驱动"></a>数据库驱动</h4><p>数据库驱动是不同数据库开发商（比如 oracle MySQL 等）为了某一种开发语言环境（ 比如 Java ）能够实现统一的数据库调用而开发的一个程序，他的作用相当于一个翻译人员，将Java语言中对数据库的调用语言通过这个翻译翻译成各个种类的数据库自己的数据库语言，当然这个翻译（数据库驱动）是由各个开发商针对统一的接口自定义开发的。</p>
<p>对于使用数据库而言，不同的数据库需要使用不同的数据库驱动才可以正常使用。由于这种不利于开发的特性，因此就诞生了 <em>JDBC</em> 。不用过于在意驱动，注重与代码。</p>
<p>对于 <em>JDBC</em> 而言，在遇到了需要切换数据库的情况时（ MySQL 转 Oracle ）可以只切换驱动。如下：</p>
<p><img src="/2022/04/24/JDBC%E5%92%8C%E6%96%B9%E6%B3%95%E6%8F%90%E5%8F%96/%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6One.png" alt="配置文件One"></p>
<p>将上图中的 url 替换后就完成了数据库驱动的替换，避免了重复书写代码的问题。</p>
<h4 id="JDBC"><a href="#JDBC" class="headerlink" title="JDBC"></a><em>JDBC</em></h4><p>JDBC( Java DataBase Connectivity ) 称为Java数据库连接，它是一种用于数据库访问的应用程序API。</p>
<p>由一组用 Java 语言编写的类和接口组成，有了 JDBC 就可以用同一的语法对多种关系数据库进行访问，而不用担心其数据库操作语言的差异。</p>
<p> 有了JDBC，就不必为访问 MySQL 数据库专门写一个程序，为访问Oracle又专门写一个程序等等。</p>
<p><img src="/2022/04/24/JDBC%E5%92%8C%E6%96%B9%E6%B3%95%E6%8F%90%E5%8F%96/JDBC.png" alt="配置文件One"></p>
<h4 id="JDBC-核心接口与类"><a href="#JDBC-核心接口与类" class="headerlink" title="JDBC 核心接口与类"></a><em>JDBC</em> 核心接口与类</h4><p>JDBC核心类库包含在java.sql包中。</p>
<p>接口：</p>
<ul>
<li>Connection：特定数据库的连接（会话）。在连接上下文中执行 SQL 语句并返回结果。</li>
<li>PreparedStatement：表示预编译的 SQL 语句的对象。另外，为了防止 SQL 注入，我们经常使用此类作为预编译 SQL 的对象，而不是 Statement 类。（ PreparedStatement类 继承于 Statement 类 ）</li>
<li>Statement：用于执行静态 SQL 语句并返回它所生成结果的对象。</li>
<li>ResultSet ：表示数据库结果集的数据表，通常通过执行查询数据库的语句生成 。</li>
<li>CallableStatement ：用于执行 SQL 存储过程的接口 。<br>类：</li>
<li>DriverManager：负责管理JDBC驱动程序。使用JDBC驱动程序之前，必须先将驱动程序加载并注册后才可以使用，同时提供方法来建立与数据库的连接。</li>
<li>SQLException：有关数据库操作的异常。</li>
</ul>
<h4 id="JDBC-的连接步骤"><a href="#JDBC-的连接步骤" class="headerlink" title="JDBC 的连接步骤"></a><em>JDBC</em> 的连接步骤</h4><ol>
<li><strong>载入JDBC驱动程序</strong></li>
<li><strong>定义连接URL</strong></li>
<li><strong>建立连接</strong></li>
<li><strong>创建Statement对象 或者 PreparedStatement对象</strong></li>
<li><strong>执行查询或更新</strong></li>
<li><strong>结果处理</strong></li>
<li><strong>关闭连接</strong></li>
</ol>
<p>由于上面 7 步中，前 3 步和最后一步基本上属于静态代码（ 没有什么变化 ），因此我们将这几步提炼为连个方法放入一个工具类中，即 连接数据库 和 释放连接。</p>
<h6 id="连接数据库函数"><a href="#连接数据库函数" class="headerlink" title="连接数据库函数"></a>连接数据库函数</h6><p>首先我们需要定义一个配置文件，在其中写好 <strong>连接的url 、驱动、用户 和 密码</strong> 如下图：</p>
<p><img src="/2022/04/24/JDBC%E5%92%8C%E6%96%B9%E6%B3%95%E6%8F%90%E5%8F%96/%E9%85%8D%E7%BD%AE.png" alt="配置文件One"></p>
<p>在修改了配置文件后，通过 Java 的类读取机制获得配置文件，并读取其中的内容：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> &#123;</span><br><span class="line">    <span class="comment">// 通过 Java 的类读取机制获得配置文件</span></span><br><span class="line">    InputStream in = JDBC_Utils.class.getClassLoader().getResourceAsStream(<span class="string">&quot;db.properties&quot;</span>);</span><br><span class="line">    Properties properties = <span class="keyword">new</span> Properties();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (in != <span class="keyword">null</span>) &#123;</span><br><span class="line">            properties.load( in );</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 读取其中的内容</span></span><br><span class="line">        driver = properties.getProperty( <span class="string">&quot;driver&quot;</span> );</span><br><span class="line">        url = properties.getProperty( <span class="string">&quot;url&quot;</span> );</span><br><span class="line">        userName = properties.getProperty( <span class="string">&quot;userName&quot;</span> );</span><br><span class="line">        passWord = properties.getProperty( <span class="string">&quot;passWord&quot;</span> );</span><br><span class="line"></span><br><span class="line">        Class.forName( driver );</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException | ClassNotFoundException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在完成了上述步骤后，创建连接：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title">getConnection</span><span class="params">()</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> DriverManager.getConnection( url, userName, passWord );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h6 id="释放数据库连接"><a href="#释放数据库连接" class="headerlink" title="释放数据库连接"></a>释放数据库连接</h6><p>同理，释放连接的方法也是相同。因为种种原因，虽然不释放连接并不会爆出语法错误，但是不好。</p>
<p>原则上推荐关闭连接，和 IO 的连接相似，需要按照顺序关闭：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">freeConnection</span><span class="params">( Connection connection, Statement statement, ResultSet resultSet )</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> ( resultSet != <span class="keyword">null</span> )&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            resultSet.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ( statement != <span class="keyword">null</span> )&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            statement.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ( connection != <span class="keyword">null</span> )&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>在完成上述两个方法的提取后，每次在使用时，通过工具类直接运行即可</p>
<h2 id="JDBC-方法提取"><a href="#JDBC-方法提取" class="headerlink" title="JDBC 方法提取"></a><em>JDBC</em> 方法提取</h2><p>JDBC 通过方法的提取可以替代 SQLyog 完成部分功能，如 增，删，改，查。</p>
<p>我们通过 sumbms 数据库中的 smbms_role 表作为示例。下面是该表的结构：</p>
<p><img src="/2022/04/24/JDBC%E5%92%8C%E6%96%B9%E6%B3%95%E6%8F%90%E5%8F%96/%E8%A1%A8%E7%BB%93%E6%9E%84.png" alt="配置文件One"></p>
<h6 id="增"><a href="#增" class="headerlink" title="增"></a>增</h6><p>令用户传入一个 smbms_role 类型的对象，通过 smbms_role 内置的 get / set 函数来完成对 sql 语言的设置，代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">addData</span><span class="params">( smbms_role tempData )</span></span>&#123;</span><br><span class="line">    Connection connection = <span class="keyword">null</span>;</span><br><span class="line">    PreparedStatement preparedStatement = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        connection = JDBC_Utils.getConnection();</span><br><span class="line"></span><br><span class="line">        String sql = <span class="string">&quot;INSERT INTO smbms_role ( `id`, `roleCode` , `roleName`, `createdBy`, `creationDate`, `modifyBy`, `modifyDate` ) values ( ?, ?, ?, ?, ?, ?, ? );&quot;</span>;</span><br><span class="line"></span><br><span class="line">        preparedStatement = connection.prepareStatement(sql);</span><br><span class="line"></span><br><span class="line">        preparedStatement.setLong( <span class="number">1</span>, tempData.getId() );</span><br><span class="line">        preparedStatement.setString( <span class="number">2</span>, tempData.getRoleCode() );</span><br><span class="line">        preparedStatement.setString( <span class="number">3</span>, tempData.getRoleName() );</span><br><span class="line">        preparedStatement.setLong( <span class="number">4</span>, tempData.getCreatedBy() );</span><br><span class="line">        preparedStatement.setDate( <span class="number">5</span>, <span class="keyword">new</span> java.sql.Date( tempData.getCreationDate().getTime() ) );</span><br><span class="line">        preparedStatement.setLong( <span class="number">6</span>, tempData.getModifyBy() );</span><br><span class="line">        preparedStatement.setDate( <span class="number">7</span>, <span class="keyword">new</span> java.sql.Date( tempData.getModifyDate().getTime() ) );</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> update = preparedStatement.executeUpdate();</span><br><span class="line">        <span class="keyword">if</span> ( update &gt;= <span class="number">1</span> )&#123;</span><br><span class="line">            System.out.println( <span class="string">&quot;Update&quot;</span> );</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">        JDBC_Utils.freeConnection( connection, preparedStatement, <span class="keyword">null</span> );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>此处需要说明的是，对于 preparedStatement 的设定而言，问号的位数是从 1 开始的，而不是从 0 开始。</p>
<h6 id="删"><a href="#删" class="headerlink" title="删"></a>删</h6><p>和增加数据不同的是，删除某项数据只需要提供目标数据的特点。如 主键，在提供了目标的主键值后，就可以直接通过主键定位整条数据，然后将其删除。</p>
<p>这就需要用户传入主键的值，然后通过 sql 语言转义来完成对数据的删除。代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">deleteData</span><span class="params">( smbms_role tempData )</span></span>&#123;</span><br><span class="line">    Connection connection = <span class="keyword">null</span>;</span><br><span class="line">    PreparedStatement preparedStatement = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        connection = JDBC_Utils.getConnection();</span><br><span class="line"></span><br><span class="line">        String sql = <span class="string">&quot;DELETE FROM smbms_role WHERE id = ?;&quot;</span>;</span><br><span class="line"></span><br><span class="line">        preparedStatement = connection.prepareStatement(sql);</span><br><span class="line">        preparedStatement.setLong( <span class="number">1</span>, tempData.getId() );</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> update = preparedStatement.executeUpdate();</span><br><span class="line">        <span class="keyword">if</span> ( update &gt;= <span class="number">1</span> )&#123;</span><br><span class="line">            System.out.println( <span class="string">&quot;Delete&quot;</span> );</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">        JDBC_Utils.freeConnection( connection, preparedStatement, <span class="keyword">null</span> );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h6 id="改"><a href="#改" class="headerlink" title="改"></a>改</h6><p>令用户传入两个 smbms_role  对象，一个是原本已经被录入表中的对象，另一个是修改后的全新的数据。那么只要先对原本的对象进行定位，然后再将修改后的全新数据将原本的数据全面覆盖，就完成了数据的修改。代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">modifyData</span><span class="params">( smbms_role oldData, smbms_role newData )</span></span>&#123;</span><br><span class="line">    Connection connection = <span class="keyword">null</span>;</span><br><span class="line">    PreparedStatement preparedStatement = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        connection = JDBC_Utils.getConnection();</span><br><span class="line"></span><br><span class="line">        String sql = <span class="string">&quot;UPDATE smbms_role set `roleCode` = ?, `roleName` = ?, `createdBy` = ?, `creationDate` = ?, `modifyBy` = ?, `modifyDate` = ?, `id` = ? where id = ?&quot;</span>;</span><br><span class="line"></span><br><span class="line">        preparedStatement = connection.prepareStatement( sql );</span><br><span class="line">        preparedStatement.setString( <span class="number">1</span>, newData.getRoleCode() );</span><br><span class="line">        preparedStatement.setString( <span class="number">2</span>, newData.getRoleName() );</span><br><span class="line">        preparedStatement.setLong( <span class="number">3</span>, newData.getCreatedBy() );</span><br><span class="line">        preparedStatement.setDate( <span class="number">4</span>, <span class="keyword">new</span> java.sql.Date( newData.getCreationDate().getTime() ) );</span><br><span class="line">        preparedStatement.setLong( <span class="number">5</span>, newData.getModifyBy() );</span><br><span class="line">        preparedStatement.setDate( <span class="number">6</span>, <span class="keyword">new</span> java.sql.Date( newData.getModifyDate().getTime() ) );</span><br><span class="line">        preparedStatement.setLong( <span class="number">7</span>, newData.getId() );</span><br><span class="line"></span><br><span class="line">        preparedStatement.setLong( <span class="number">8</span>, oldData.getId() );</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> modify = preparedStatement.executeUpdate();</span><br><span class="line">        <span class="keyword">if</span> ( modify &gt;= <span class="number">1</span> )&#123;</span><br><span class="line">            System.out.println( <span class="string">&quot;Modify Data&quot;</span> );</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">        JDBC_Utils.freeConnection( connection, preparedStatement, <span class="keyword">null</span> );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h6 id="查"><a href="#查" class="headerlink" title="查"></a>查</h6><p>对于查找 smbms_role 对象而言，和删除数据相同，只需要提供一个独特的索引即可。（ 比如主键 ）</p>
<p>但是，和删除不同的是，执行查找动作会使得 preparedStatement 返回一个 ResultSet 类型的对象。因此我们需要一个 smbms_role 对象来接收 ResultSet 的结果。代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> smbms_role <span class="title">selectData</span><span class="params">( <span class="keyword">int</span> id )</span></span>&#123;</span><br><span class="line">    Connection connection = <span class="keyword">null</span>;</span><br><span class="line">    PreparedStatement preparedStatement = <span class="keyword">null</span>;</span><br><span class="line">    ResultSet resultSet = <span class="keyword">null</span>;</span><br><span class="line">    smbms_role smbms_role = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        connection = JDBC_Utils.getConnection();</span><br><span class="line"></span><br><span class="line">        String sql = <span class="string">&quot;SELECT * FROM smbms_role WHERE id = ?&quot;</span>;</span><br><span class="line"></span><br><span class="line">        preparedStatement = connection.prepareStatement(sql);</span><br><span class="line">        preparedStatement.setLong( <span class="number">1</span>, id );</span><br><span class="line"></span><br><span class="line">        resultSet = preparedStatement.executeQuery();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> ( resultSet.next() )&#123;</span><br><span class="line">            <span class="keyword">long</span> Id = resultSet.getLong(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">            String roleCode = resultSet.getString(<span class="string">&quot;roleCode&quot;</span>);</span><br><span class="line">            String roleName = resultSet.getString(<span class="string">&quot;roleName&quot;</span> );</span><br><span class="line">            <span class="keyword">long</span> createdBy = resultSet.getLong(<span class="string">&quot;createdBy&quot;</span>);</span><br><span class="line">            Date creationDate = resultSet.getDate(<span class="string">&quot;creationDate&quot;</span>);</span><br><span class="line">            <span class="keyword">long</span> modifyBy = resultSet.getLong(<span class="string">&quot;modifyBy&quot;</span>);</span><br><span class="line">            Date modifyDate = resultSet.getDate(<span class="string">&quot;modifyDate&quot;</span>);</span><br><span class="line"></span><br><span class="line">            System.out.println( <span class="string">&quot;Id : &quot;</span> + Id + <span class="string">&quot; ||&quot;</span> +</span><br><span class="line">                               <span class="string">&quot;  roleCode : &quot;</span> + roleCode + <span class="string">&quot; ||&quot;</span> +</span><br><span class="line">                               <span class="string">&quot;  roleName : &quot;</span> + roleName + <span class="string">&quot; ||&quot;</span> +</span><br><span class="line">                               <span class="string">&quot;  createdBy : &quot;</span> + createdBy + <span class="string">&quot; ||&quot;</span> +</span><br><span class="line">                               <span class="string">&quot;  creationDate : &quot;</span> + creationDate + <span class="string">&quot; ||&quot;</span> +</span><br><span class="line">                               <span class="string">&quot;  modifyBy : &quot;</span> + modifyBy + <span class="string">&quot; ||&quot;</span> +</span><br><span class="line">                               <span class="string">&quot;  modifyDate : &quot;</span> + modifyDate  );</span><br><span class="line"></span><br><span class="line">            smbms_role = </span><br><span class="line">                <span class="keyword">new</span> smbms_role( Id, roleCode, roleName, createdBy, creationDate, modifyBy, modifyDate );</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">        JDBC_Utils.freeConnection( connection, preparedStatement, resultSet );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> smbms_role;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/04/18/JSP/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="神秘的世界">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/04/18/JSP/" class="post-title-link" itemprop="url">JSP</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-04-18 21:11:16" itemprop="dateCreated datePublished" datetime="2022-04-18T21:11:16+08:00">2022-04-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-05-17 00:43:19" itemprop="dateModified" datetime="2022-05-17T00:43:19+08:00">2022-05-17</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="JSP-的有关概念"><a href="#JSP-的有关概念" class="headerlink" title="JSP 的有关概念"></a><em>JSP</em> 的有关概念</h2><p><strong>JSP</strong>（ 全称 <strong>J</strong>ava <strong>S</strong>erver <strong>P</strong>ages）是由    [Sun Microsystems ](<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/Sun">https://baike.baidu.com/item/Sun</a> Microsystems)    公司主导创建的一种    <a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%8A%A8%E6%80%81%E7%BD%91%E9%A1%B5%E6%8A%80%E6%9C%AF/9415956">动态网页技术</a>    标准。</p>
<p>JSP 从本质上而言，就是一种 Serlvet 。通过在 HTML 代码种嵌套 Java 代码，优化和提高 Web 程序的编辑和工作效率。</p>
<p>JSP 将 Java 代码和特定变动内容嵌入到静态的页面中，实现以静态页面为模板，动态生成其中的部分内容。JSP 引入了被称为 “ JSP动作 ” 的 XML 标签，用来调用内建功能。</p>
<p>另外，可以创建 JSP 标签库，然后像使用标准 HTML 或 XML 标签一样使用它们。</p>
<p>对于一个 JSP 程序而言，她预先包含了许多的静态变量以及实现书写好的 Java 程序，这些程序可以通过在 Tomcat 下的生成目录种来寻找这些 JSP 文件。</p>
<p>在 JSP 文件中，向 JSP 中写入的代码里，如果是 HTML 代码那么就会被常量 out 的 write 函数进行转换，然后输出 ； 如果是 Java 代码就会被正常输出 。</p>
<p><img src="/2022/04/18/JSP/%E5%90%8E%E5%8F%B0%E6%BA%90%E7%A0%81One.png" alt="后台源码One"></p>
<p>一般而言，对于一个网站而言，大部分的 JSP 文件都是只有在被调用，或者说被请求时才会被下载或者进行生成。大部分时间都不会存在于服务端或者客户端中。</p>
<p>在 JSP 文件生成后，视情况会被存储于 客户端 或者 服务器 中。</p>
<p>JSP 会预先配置一些便于编写的 变量 ，如下：</p>
<p><img src="/2022/04/18/JSP/JSP%E7%9A%84%E6%96%87%E4%BB%B6%E9%85%8D%E7%BD%AE.png" alt="JSP的配置"></p>
<p>这些变量利于对 JSP 文件的编写，从中也可也看出，JSP 本质上也是一种 Java 文件（ 这从文件类型也可也看出来，毕竟最终生成了 .java 和 .class 文件 ）</p>
<p><img src="/2022/04/18/JSP/%E6%96%87%E4%BB%B6%E7%94%9F%E6%88%90%E7%9B%AE%E5%BD%95.png" alt="文件生成目录"></p>
<h4 id="JSP-的一些特性"><a href="#JSP-的一些特性" class="headerlink" title="JSP 的一些特性"></a><em>JSP</em> 的一些特性</h4><ul>
<li><p>能以模板化的方式简单、高效地添加动态网页内容。</p>
</li>
<li><p>可利用    <a target="_blank" rel="noopener" href="https://baike.baidu.com/item/JavaBean">JavaBean </a>    和标签库技术复用常用的功能代码（设计好的组件容易实现重复利用，减少重复劳动）。标签库不仅带有通用的内置标签（ <a target="_blank" rel="noopener" href="https://baike.baidu.com/item/JSTL">JSTL </a>)，而且支持可扩展功能的自定义标签。</p>
</li>
<li><p>有良好的工具支持。</p>
</li>
<li><p>继承了Java语言的相对易用性。</p>
</li>
<li><p>继承了Java的    <a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E8%B7%A8%E5%B9%B3%E5%8F%B0">跨平台</a>    优势，实现 “  一次编写，处处运行  ” 。</p>
<p>因为支持Java及其相关技术的开发平台多，网站开发人员可以选择在最适合自己的系统平台上进行JSP开发；不同环境下开发的JSP项目，在所有客户端上都能顺利访问。</p>
</li>
<li><p>页面中的动（控制变动内容的部分）/静（内容不需变动的部分）区域以分散但又有序的形式组合在一起，能使人更直观地看出页面代码的整体结构，也使得设计页面效果和程序逻辑这2部分工作容易分离（外观视图与逻辑分离）。</p>
<p>从而方便分配人员并发挥各自长处，实现高效地分工合作。</p>
</li>
<li><p>可与其它企业级Java技术相互配合。JSP可以只专门负责页面中的数据呈现，实现分层开发。</p>
</li>
</ul>
<h2 id="JSP-的语法和标签"><a href="#JSP-的语法和标签" class="headerlink" title="JSP 的语法和标签"></a><em>JSP</em> 的语法和标签</h2><h4 id="JSP-语法"><a href="#JSP-语法" class="headerlink" title="JSP 语法"></a><em>JSP</em> 语法</h4><p>JSP 的语法可大致被分为三类 ： JSP 声明 、 JSP 脚本片段 和 JSP 表达式，以及 JSP 注释。</p>
<p>另外，由于 JSP 的本质是一种 Servlet ，并且会生成 java 文件，所以 JSP 支持所有 Java 的语法（ 同样也就是说 JSP 区分大小写 ）。并且，由于 JSP 兼容 HTML5 语法，所以其也可以使用 H5 的代码和标签。</p>
<h5 id="JSP-表达式"><a href="#JSP-表达式" class="headerlink" title="JSP 表达式"></a><em>JSP</em> 表达式</h5><p>表达式的语法格式：</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%= 表达式 或者 变量 %&gt;</span><br></pre></td></tr></table></figure>

<p>示例代码如图：</p>
<p><img src="/2022/04/18/JSP/JSP%E8%A1%A8%E8%BE%BE%E5%BC%8F.png" alt="JSP表达式"></p>
<p>一个 JSP 表达式中包含的脚本语言表达式，先被转化成String，然后插入到表达式出现的地方。</p>
<p>由于表达式的值会被转化成 String，所以你可以在一个文本行中使用表达式而不用去管它是否是 HTML 标签。表达式元素中可以包含任何符合 Java 语言规范的表达式，但是不能使用分号来结束表达式。</p>
<h5 id="JSP-声明"><a href="#JSP-声明" class="headerlink" title="JSP 声明"></a><em>JSP</em> 声明</h5><p>声明的语法格式：</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%! 代码块 %&gt;</span><br></pre></td></tr></table></figure>

<p>示例代码如图：</p>
<p><img src="/2022/04/18/JSP/JSP%E5%A3%B0%E6%98%8EOne.png" alt="JSP声明One"></p>
<p>从示例代码中的效果可以看出来，在 JSP 声明中定义的 函数 或者 变量 会被定义成 JSP 文件中的全局静态变量。那么我们打开源码来看一下，源码如图：</p>
<p><img src="/2022/04/18/JSP/JSP%E5%A3%B0%E6%98%8ETwo.png"></p>
<p>从这里可以看出，JSP 的声明和其他的 JSP 语言部分的不同。一个声明语句可以声明一个或多个变量、方法，供后面的Java代码使用，在JSP文件中，您必须先声明这些变量和方法然后才能使用它们。</p>
<h5 id="JSP-脚本片段"><a href="#JSP-脚本片段" class="headerlink" title="JSP 脚本片段"></a><em>JSP</em> 脚本片段</h5><p>脚本片段的语法格式：</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;% 代码块 %&gt;</span><br></pre></td></tr></table></figure>

<p>示例代码如图：</p>
<p><img src="/2022/04/18/JSP/JSP%E8%84%9A%E6%9C%AC%E7%89%87%E6%AE%B5One.png" alt="JSP脚本片段One"></p>
<p>在 JSP 脚本片段中，可以随意书写 Java 代码，需要注意的一点，在 &lt;% 代码块 %&gt; 中，即使两个 &lt;% 代码块 %&gt; 中的代码被分开了（ 如上文中的示例代码 ）依旧会被链接到一起，如图：</p>
<p><img src="/2022/04/18/JSP/JSP%E8%84%9A%E6%9C%AC%E7%89%87%E6%AE%B5Two.png" alt="JSP脚本片段Two"></p>
<p>由此可以看出来，在使用 JSP 脚本片段时，可以使用 H5 代码进行穿插，可以将代码中断去补齐其他的代码。不过不推荐这么做，这么做无疑会导致代码的可读性大大下降。</p>
<h5 id="JSP-注释"><a href="#JSP-注释" class="headerlink" title="JSP 注释"></a><em>JSP</em> 注释</h5><p>注释的语法格式：</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%-- 该部分注释在网页中不会被显示 --%&gt; </span><br></pre></td></tr></table></figure>

<p>JSP注释主要有两个作用：为代码作注释以及将某段代码注释掉。</p>
<p>另外，在 JSP 文件中，是可以使用 H5 代码的注释的。但是由于 JSP 代码的特性，由此如果在浏览器中进行查看，是无法看见 JSP 文档的注释的，但是可以看见 H5 的代码。</p>
<p><img src="/2022/04/18/JSP/JSP%E6%B3%A8%E9%87%8A02.png"></p>
<p><img src="/2022/04/18/JSP/JSP%E6%B3%A8%E9%87%8A01.png"></p>
<h4 id="JSP指令"><a href="#JSP指令" class="headerlink" title="JSP指令"></a>JSP指令</h4><p><em>JSP</em> 的指令的格式大致为：</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;% @ directive attribute=<span class="string">&quot;value&quot;</span> %&gt;</span><br></pre></td></tr></table></figure>

<p>指令可以有很多个属性，它们以键值对的形式存在，并用逗号隔开。</p>
<p>JSP中的三种指令标签：</p>
<table>
<thead>
<tr>
<th align="center"><strong>指令</strong></th>
<th align="center"><strong>描述</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="center">&lt;% @ page … %&gt;</td>
<td align="center">定义网页依赖属性，比如脚本语言、error页面、缓存需求等等</td>
</tr>
<tr>
<td align="center">&lt;% @ include … %&gt;</td>
<td align="center">包含其他文件</td>
</tr>
<tr>
<td align="center">&lt;% @ taglib … %&gt;</td>
<td align="center">引入标签库的定义</td>
</tr>
</tbody></table>
<p>一般而言，较常用的是 page 和 include 标签。</p>
<p>由于 page 标签的特性，因此在一个 JSP 页面中可以由多个 page 标签。</p>
<p>下表列出与Page指令相关的属性：</p>
<table>
<thead>
<tr>
<th align="center"><strong>属性</strong></th>
<th align="center"><strong>描述</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="center">buffer</td>
<td align="center">指定out对象使用缓冲区的大小</td>
</tr>
<tr>
<td align="center">autoFlush</td>
<td align="center">控制out对象的 缓存区</td>
</tr>
<tr>
<td align="center">contentType</td>
<td align="center">指定当前JSP页面的MIME类型和字符编码</td>
</tr>
<tr>
<td align="center">errorPage</td>
<td align="center">指定当JSP页面发生异常时需要转向的错误处理页面</td>
</tr>
<tr>
<td align="center">isErrorPage</td>
<td align="center">指定当前页面是否可以作为另一个JSP页面的错误处理页面</td>
</tr>
<tr>
<td align="center">extends</td>
<td align="center">指定servlet从哪一个类继承</td>
</tr>
<tr>
<td align="center">import</td>
<td align="center">导入要使用的Java类</td>
</tr>
<tr>
<td align="center">info</td>
<td align="center">定义JSP页面的描述信息</td>
</tr>
<tr>
<td align="center">isThreadSafe</td>
<td align="center">指定对JSP页面的访问是否为线程安全</td>
</tr>
<tr>
<td align="center">language</td>
<td align="center">定义JSP页面所用的脚本语言，默认是Java</td>
</tr>
<tr>
<td align="center">session</td>
<td align="center">指定JSP页面是否使用session</td>
</tr>
<tr>
<td align="center">isELIgnored</td>
<td align="center">指定是否执行EL表达式</td>
</tr>
<tr>
<td align="center">isScriptingEnabled</td>
<td align="center">确定脚本元素能否被使用</td>
</tr>
</tbody></table>
<p>另外值得一提的是，在 <em>JSP</em> 中使用 page errorPage 指令时，是可以通过修改 web.xml 文件配置来达到相同的效果的，如下：</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;error-page&gt;</span><br><span class="line">    &lt;error-code&gt;<span class="number">500</span>&lt;/error-code&gt;</span><br><span class="line">    &lt;location&gt;/error/<span class="number">500.</span>jsp&lt;/location&gt;</span><br><span class="line">&lt;/error-page&gt;</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/04/15/%E5%85%B3%E4%BA%8ESession%E5%92%8CCookie/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="神秘的世界">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/04/15/%E5%85%B3%E4%BA%8ESession%E5%92%8CCookie/" class="post-title-link" itemprop="url">关于Session和Cookie</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-04-15 19:02:24" itemprop="dateCreated datePublished" datetime="2022-04-15T19:02:24+08:00">2022-04-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-04-26 00:31:58" itemprop="dateModified" datetime="2022-04-26T00:31:58+08:00">2022-04-26</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h2><h4 id="Cookie-的概念"><a href="#Cookie-的概念" class="headerlink" title="Cookie 的概念"></a>Cookie 的概念</h4><p>用于会话和网站识别的一种技术，由客户端向服务器提供。在访问服务器时，由客户端携带并交由客户端检查。</p>
<p>Cookie，有时也用其复数形式 Cookies。类型为“<strong>小型文本文件</strong>”，是某些网站为了辨别用户身份，进行 <a target="_blank" rel="noopener" href="https://baike.baidu.com/item/Session/479100">Session </a>跟踪而储存在用户本地终端上的数据（通常经过加密），由用户 <a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%AE%A2%E6%88%B7%E7%AB%AF/101081">客户端 </a>计算机暂时或永久保存的信息。</p>
<p>Cookie 并不是其原本的 “甜饼” 的意思，或者说，Cookie 是 服务器 交给 客户端 的 “甜饼” ，用来证明访问服务器的人并不是第一次访问这个服务器。</p>
<h4 id="Cookie-的设置和组成"><a href="#Cookie-的设置和组成" class="headerlink" title="Cookie 的设置和组成"></a>Cookie 的设置和组成</h4><p>在 Java Web 中，Cookie 类拥有大量的静态属性，如图</p>
<p><img src="/2022/04/15/%E5%85%B3%E4%BA%8ESession%E5%92%8CCookie/%E5%B1%9E%E6%80%A7.png" alt="属性"></p>
<p>在上图属性中，需要特殊注意的是 name、 value、 maxAge。 </p>
<p>name 和 value 是对于一个 Cookie 必要的属性，类似与键值对，从上图可以看出来，name 和 value 的值都必须为 String 类型。因此也存在一些限制。</p>
<p>maxAge是和 Cookie 生存期有关的属性，一般设置为 -1 ，即代表着 “只有不关闭浏览器，Cookie就可以一直生存”，可以通过函数来设置Cookie 的生存时间，使其在关闭浏览器后依旧可以生存。</p>
<p>另外，Cookie 的 value 值有一个需要注意的地方，对于存入 value 中的值：首先必须是字符串，其次其中不能有 特殊字符（ 如 空格、反斜线、斜线、星号等等 ）否则，虽然可以通过语法检查，但是在运行后网页会报告 500 错误，会提示 Cookie 不支持字符。</p>
<p>此时，我们可以使用 URLEncoder 类的 encode 函数进行转码，在读取时，使用 URLDecoder 类的 decode 函数解码。</p>
<h5 id="Cookie-的创建与读取"><a href="#Cookie-的创建与读取" class="headerlink" title="Cookie 的创建与读取"></a>Cookie 的创建与读取</h5><p>Cookie的读取是从 req ，也从就是 HTTP 请求的相关函数中读取，如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cookie[] cookies = req.getCookies();</span><br></pre></td></tr></table></figure>

<p>一般而言，一个网页的 Cookie 不止一个，因此通过 getCookies 函数获取的是一个 Cookie 类型的数组。</p>
<p>通过 getName 或者 getValue 函数来获取 Cookie 中存放的 name 或者 value 的值。不过，在获取 value 时，如果这个 value 的值已经经过 URLEncoder 类的 encode 函数转义，那么就需要使用 URLDecoder 类的 decode 函数解码，才可以获取正常的值。</p>
<p>Cookie 在 Java Web 中拥有独立的类，因此可以直接通过 new 关键字创建 Cookie ，需要提供必须的的 name值 和 value值。在 Cookie 创建完成后，使用 响应resp 的相关函数就可以将 Cookie 发送给 Web 服务器网页。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Cookie cookie = <span class="keyword">new</span> Cookie( <span class="string">&quot;LastLoginTime&quot;</span>, URLEncoder.encode( time, <span class="string">&quot;utf-8&quot;</span> ) );</span><br><span class="line"></span><br><span class="line">resp.addCookie( cookie );</span><br></pre></td></tr></table></figure>



<h4 id="Cookie-在网页中的体现"><a href="#Cookie-在网页中的体现" class="headerlink" title="Cookie 在网页中的体现"></a>Cookie 在网页中的体现</h4><p>我们在写好后台的相关程序后，打开网页的控制台可以看见其审查元素，如图：</p>
<p><img src="/2022/04/15/%E5%85%B3%E4%BA%8ESession%E5%92%8CCookie/%E9%A1%B5%E9%9D%A2One.png" alt="页面One"></p>
<p>可以从上图看到，在 Cookie 的一栏中，除了我们自己书写的 LastLoginTime 这一项 Cookie 以外，还有两项。同时可以看见我们申请的调度口 Host = localhost：8080</p>
<p>另外，我们可以看见我们自己设定的 LastLoginTime 的值以及其相关属性。</p>
<p>由于上图中的 Cookie 的值含有空格，因此我进行了转义，所以无法直接通过控制台看见其值，并且由于我并没有修改 Cookie 的其他属性，所以并无法看见其余的特性。</p>
<h4 id="Cookie-的一些小细节"><a href="#Cookie-的一些小细节" class="headerlink" title="Cookie 的一些小细节"></a>Cookie 的一些小细节</h4><p>首先，网页的 Cookie 的存在上限的。</p>
<ul>
<li>通过对 Cookie 结构的分析可以看出，由于她类似与键值对的设计，所以一个 Cookie 只能存放一组数据。</li>
<li>一个 Web 站点可以向浏览器发送多个 Cookie， 最多存放 20 个 Cookie。</li>
<li>Cookie 的大小是有上限的，大致为 4 KB</li>
<li>一个浏览器所拥有的 Cookie 大致为 300 个</li>
</ul>
<p>其次，关于 Cookie 的删除：</p>
<ul>
<li>不设置有效期，即 maxAge = -1 ，关闭页面时自动销毁 Cookie</li>
<li>设置有效期，将 Cookie 的有效期设定为 0，即 maxAge = 0，在设定后，Cookie 到期失效被销毁</li>
</ul>
<h2 id="Session"><a href="#Session" class="headerlink" title="Session"></a>Session</h2><h4 id="Session的概念"><a href="#Session的概念" class="headerlink" title="Session的概念"></a>Session的概念</h4><p>在计算机中，尤其是在网络应用中，称为 “会话控制”  是一种 客户端 和 服务器 识别和认证的方式。</p>
<p>Session对象会存储特定用户会话所需的属性及配置信息。</p>
<p>这样，当用户在应用程序的Web页之间跳转时，存储在Session对象中的变量将不会丢失，而是在整个用户会话中一直存在下去。当用户请求来自应用程序的 Web页时，如果该用户还没有会话，则Web服务器将自动创建一个 Session对象。</p>
<p>简而言之，不同与 Cookie 每次更新的特性，Session 会在用户打开客户端时打开一个 Session，在用户关闭客户端或者 Session 的有效期过期之前，Session 都会被存储在服务器那里。</p>
<p>当用户访问时，由于 Session 的特性，用户会向服务器发送一个 SessionID 的 Cookie 。若该 Cookie 可以匹配，那么服务器就会调用 Session 完成相应的操作。</p>
<p>也就是说，在打开某个 客户端 后，只要在相同 客户端 下跳转，虽然 Cookie 会不断刷新和修改，但是 Session 并不会被关闭（ 除非 Session 的生命周期到期 ），具体表现为 SessionID 不改变。</p>
<h4 id="Session的设置和组成"><a href="#Session的设置和组成" class="headerlink" title="Session的设置和组成"></a>Session的设置和组成</h4><p>和 Cookie 不同，Session 并不是一个单独的类，因此 Session 并没有像 Cookie 那么多可以调整的静态变量。相对的，由于其在 Java Web 中对应的源码为 HttpSession ，是一个接口，因此提供了许多了可使用的方法来完成对 Session 的设置。如图：</p>
<p><img src="/2022/04/15/%E5%85%B3%E4%BA%8ESession%E5%92%8CCookie/Session%E6%96%B9%E6%B3%95%E8%A1%A8.png" alt="Session设置"></p>
<p>对上图的方法分析可以看出，对于 Session，有许多的方法已经被废弃。其实我们主要使用的为 get / set Attribute 函数，我们可以通过这两个函数利用 Session 存储 / 读取数据 。</p>
<p>若打算使用 get / set Attribute 函数 来存储数据，可以发现，其需要的参数是 String， Object 这说明 Session 是可以存放对象的。也就是说， Session 可以存放的数据可以是自定义类，存放数据的范围远远大于 Cookie 。</p>
<p>另外，我们可以看见在 HttpSession 中有一个名为 getID 的函数，这个函数可以获取一个唯一的 SessionID 。并且，由于 Session 的特性， SessionID 的传递其实是使用 Cookie 的技术来实现的，如下图：</p>
<p><img src="/2022/04/15/%E5%85%B3%E4%BA%8ESession%E5%92%8CCookie/SessionID%E7%9A%84%E4%BC%A0%E9%80%92.png" alt="SessionID的传递"></p>
<p>由上图可知，我们打开网站，提交请求，服务器启动了一个 Session ，其中 SessionID 是通过 Cookie 上传的。如果我们调用 getID 函数，那么就可以获取这个名为 JSESSIONID 的 Cookie 的值。</p>
<h5 id="Session的创建与读取"><a href="#Session的创建与读取" class="headerlink" title="Session的创建与读取"></a>Session的创建与读取</h5><p>Session 的读取是从 req ，也从就是 HTTP 请求的相关函数中读取，如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HttpSession httpSession = req.getSession();</span><br></pre></td></tr></table></figure>

<p>对于某一个用户而言，其在一个客户端只会拥有一个唯一的 Session ，在浏览器关闭或者 Session 的生命周期的到期前都不会变化。</p>
<p>通过 get / set Attribute 函数可以某个键值对存入 Session 中，用于保存数据。另外，若要提取 Session 中的数据，利用 SessionID 的匹配即可提取所需要的数据。</p>
<p>Session 的存储不需要想 Cookie 那样向客户端发送，只要客户端没有关闭，服务器就可以直接操作客户端 Session 中的内容。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++ )&#123;</span><br><span class="line">    httpSession.setAttribute( String.valueOf( i ), <span class="keyword">new</span> Temp( String.valueOf( i ), <span class="string">&quot;测试&quot;</span>, <span class="string">&quot;测试&quot;</span> ) );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="Session的一些小细节"><a href="#Session的一些小细节" class="headerlink" title="Session的一些小细节"></a>Session的一些小细节</h4><p>这里对于 Session 销毁方面上的一些小细节进行讨论</p>
<ul>
<li><p>不进行任何设置，当浏览器关闭时，Session 并不会自动销毁</p>
</li>
<li><p>设置 Session 的生命周期，如下：</p>
<p>以分钟为单位，在设置生命周期后，既视关闭浏览器，Session 依旧不会销毁，直到生命周期结束为止会一直被存放在服务器端。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--  15 分钟后自动过期  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">session-config</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">session-timeout</span>&gt;</span>15<span class="tag">&lt;/<span class="name">session-timeout</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">session-config</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>手动注销，在 HttpSession 中，存在手动注销 Session 的方法 ： invalidate 函数 ； 在调用该函数后，当前的 Session 会被立刻注销。如果此时请求并未被关闭，那么客户端会马上请求一个新的 Session。（ 但其中不会包含任何数据 ）</p>
</li>
</ul>
<h2 id="相关代码"><a href="#相关代码" class="headerlink" title="相关代码"></a>相关代码</h2><h4 id="Cookie-1"><a href="#Cookie-1" class="headerlink" title="Cookie"></a>Cookie</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.EveArsh.Cookie;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.Cookie;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"><span class="keyword">import</span> java.net.URLDecoder;</span><br><span class="line"><span class="keyword">import</span> java.net.URLEncoder;</span><br><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CookieDemoOne</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        <span class="comment">// 简单处理汉字</span></span><br><span class="line">        req.setCharacterEncoding( <span class="string">&quot;utf-8&quot;</span> );</span><br><span class="line">        resp.setCharacterEncoding( <span class="string">&quot;utf-8&quot;</span> );</span><br><span class="line">        resp.setContentType( <span class="string">&quot;text/html;charset=utf8&quot;</span> );</span><br><span class="line"></span><br><span class="line">        PrintWriter out = resp.getWriter();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取 Cookie</span></span><br><span class="line">        Cookie[] cookies = req.getCookies();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ( cookies != <span class="keyword">null</span> )&#123;</span><br><span class="line">            out.write( <span class="string">&quot;上一次访问本站的时间为 ： &quot;</span> );</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> ( Cookie cookie : cookies )&#123;</span><br><span class="line">                String value = cookie.getName();</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> ( value.equals( <span class="string">&quot;LastLoginTime&quot;</span> ) )&#123;</span><br><span class="line">                    out.write( URLDecoder.decode( cookie.getValue(), <span class="string">&quot;utf-8&quot;</span> ) );</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            out.write( <span class="string">&quot;这是你第一次访问此站&quot;</span> );</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 将时间转化为字符串</span></span><br><span class="line">        String time = TimeChange( System.currentTimeMillis() );</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 此处需要注意的是，由于 TimeChange 函数将时间转换为了 YYYY-MM-dd HH:mm:ss 的格式输出</span></span><br><span class="line">        <span class="comment">// 导致Cookie的值中出现了 空格 这样的特殊符号</span></span><br><span class="line">        <span class="comment">// 因此需要使用 URLEncoder 类的 encode 函数进行转码，在读取时，使用 URLDecoder 类的 decode 解码</span></span><br><span class="line">        Cookie cookie = <span class="keyword">new</span> Cookie( <span class="string">&quot;LastLoginTime&quot;</span>, URLEncoder.encode( time, <span class="string">&quot;utf-8&quot;</span> ) );</span><br><span class="line">        resp.addCookie( cookie );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        doGet(req, resp);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">TimeChange</span><span class="params">( <span class="keyword">long</span> time )</span></span>&#123;</span><br><span class="line">        SimpleDateFormat simpleDateFormat = <span class="keyword">new</span> SimpleDateFormat( <span class="string">&quot;YYYY-MM-dd HH:mm:ss&quot;</span> );</span><br><span class="line">        <span class="keyword">return</span> simpleDateFormat.format( time );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="Session-1"><a href="#Session-1" class="headerlink" title="Session"></a>Session</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.EveArsh.Session;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpSession;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SessionDemoOne</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        req.setCharacterEncoding( <span class="string">&quot;utf-8&quot;</span> );</span><br><span class="line">        resp.setCharacterEncoding( <span class="string">&quot;utf-8&quot;</span> );</span><br><span class="line">        resp.setContentType( <span class="string">&quot;text/html;charset=utf-8&quot;</span> );</span><br><span class="line"></span><br><span class="line">        HttpSession httpSession = req.getSession();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 在创建会话时，向 Session 中存入几组 Temp 类型的值</span></span><br><span class="line">        <span class="keyword">for</span> ( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++ )&#123;</span><br><span class="line">            httpSession.setAttribute( String.valueOf( i ), <span class="keyword">new</span> Temp( String.valueOf( i ), <span class="string">&quot;测试&quot;</span>, <span class="string">&quot;测试&quot;</span> ) );</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        String sessionId = httpSession.getId();</span><br><span class="line">        <span class="keyword">if</span> ( sessionId != <span class="keyword">null</span> )&#123;</span><br><span class="line">            resp.getWriter().write( <span class="string">&quot;本次访问的 SessionID 为 : &quot;</span> + sessionId );</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        doGet(req, resp);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Temp</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line">    <span class="keyword">private</span> String name;;</span><br><span class="line">    <span class="keyword">private</span> String value;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Temp</span><span class="params">( String id, String name, String value )</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.value = value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Temp - id : &quot;</span> + <span class="keyword">this</span>.id + <span class="string">&quot; name : &quot;</span> + <span class="keyword">this</span>.name + <span class="string">&quot; value : &quot;</span> + <span class="keyword">this</span>.value ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*********************************************************************************************************/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.EveArsh.Session;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpSession;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SessionDemoTwo</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        req.setCharacterEncoding( <span class="string">&quot;utf-8&quot;</span> );</span><br><span class="line">        resp.setCharacterEncoding( <span class="string">&quot;utf-8&quot;</span> );</span><br><span class="line">        resp.setContentType( <span class="string">&quot;text/html;charset=utf-8&quot;</span> );</span><br><span class="line"></span><br><span class="line">        HttpSession httpSession = req.getSession();</span><br><span class="line"></span><br><span class="line">        String sessionId = httpSession.getId();</span><br><span class="line">        <span class="keyword">if</span> ( sessionId != <span class="keyword">null</span> )&#123;</span><br><span class="line">            <span class="keyword">for</span> ( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++ )&#123;</span><br><span class="line">                PrintWriter out = resp.getWriter();</span><br><span class="line"></span><br><span class="line">                Temp attribute = ( Temp ) httpSession.getAttribute( String.valueOf( i ) );</span><br><span class="line">                out.write( attribute.toString() );</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        doGet(req, resp);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="XML"><a href="#XML" class="headerlink" title="XML"></a>XML</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee</span></span></span><br><span class="line"><span class="string"><span class="tag">                         http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">version</span>=<span class="string">&quot;4.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">metadata-complete</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>CookieOne<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.EveArsh.Cookie.CookieDemoOne<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>CookieOne<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/c1<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>SessionOne<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.EveArsh.Session.SessionDemoOne<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>SessionOne<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/s1<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>SessionTwo<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.EveArsh.Session.SessionDemoTwo<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>SessionTwo<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/s2<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--  15 分钟后自动过期  --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">session-config</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">session-timeout</span>&gt;</span>15<span class="tag">&lt;/<span class="name">session-timeout</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">session-config</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">John Doe</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">31</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"live2d-widget-model-haruto"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":false},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>

<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/love.js"></script>

<!--动态线条背景-->
<script type="text/javascript"
color="220,220,220" opacity='0.7' zIndex="-2" count="200" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js">
</script>

<!--浏览器搞笑标题-->
<script type="text/javascript" src="\js\FunnyTitle.js"></script>
